"use strict";!function(){var e="undefined"!=typeof exports&&null!==exports?new Object:window,t=Math.pow(2,53)-1;Object.keys||(Object.keys=function(){var e=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),i=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],n=i.length;return function(a){if("object"!=typeof a&&"function"!=typeof a||null===a)throw new TypeError("Object.keys called on non-object");var r=[];for(var o in a)e.call(a,o)&&r.push(o);if(t)for(var s=0;n>s;s++)e.call(a,i[s])&&r.push(i[s]);return r}}());var i,n,a,r,o,s,c,l,u,p,d,m,f,g,h,v,y,A,w;w=!{toString:null}.propertyIsEnumerable("toString"),A=Object.prototype.hasOwnProperty,v=function(e,t){return null!=e&&A.call(e,t)},f=Object.keys,p=function(e){var i=e.length;return"number"==typeof i&&i>=0&&t>=i},c=function(e,t,i){if(void 0===t)return e;switch(null==i?3:i){case 1:return function(i){return e.call(t,i)};case 2:return function(i,n){return e.call(t,i,n)};case 3:return function(i,n,a){return e.call(t,i,n,a)};case 4:return function(i,n,a,r){return e.call(t,i,n,a,r)}}return function(){return e.apply(t,arguments)}},l=function(e){if(null==e||"object"!=typeof e)return e;var t=new e.constructor;for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},i=function(e,t){return function(){return e.apply(t,arguments)}},g=function(e){if(!h(e))return[];if(f)return f(e);var t=[];for(var i in e)_.has(e,i)&&t.push(i);return hasEnumBug&&collectNonEnumProps(e,t),t},h=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},n=function(e,t){function i(){this.constructor=e}for(var n in t)A.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},o=function(e,t,i){t=c(t,i);var n,a;if(p(e))for(n=0,a=e.length;a>n;n++)t(e[n],n,e);else{var r=g(e);for(n=0,a=r.length;a>n;n++)t(e[r[n]],r[n],e)}return e},r=function(e){return"function"==typeof e},"undefined"==typeof Promise&&!function(e,t){function i(e,t){return(typeof t)[0]==e}function n(r,o){return o=function s(c,l,u,p,d,m){function f(e){return function(t){d&&(d=0,s(i,e,t))}}if(p=s.q,c!=i)return n(function(e,t){p.push({p:this,r:e,j:t,1:c,0:l})});if(u&&i(e,u)|i(t,u))try{d=u.then}catch(g){l=0,u=g}if(i(e,d))try{d.call(u,f(1),l=f(0))}catch(g){l(g)}else for(o=function(t,o){return i(e,t=l?t:o)?n(function(e,i){a(this,e,i,u,t)}):r},m=0;m<p.length;)d=p[m++],i(e,c=d[l])?a(d.p,d.r,d.j,u,c):(l?d.r:d.j)(u)},o.q=[],r.call(r={then:function(e,t){return o(e,t)},"catch":function(e){return o(0,e)}},function(e){o(i,1,e)},function(e){o(i,0,e)}),r}function a(n,a,r,o,s){setTimeout(function(){try{o=s(o),s=o&&i(t,o)|i(e,o)&&o.then,i(e,s)?o==n?r(TypeError()):s.call(o,a,r):a(o)}catch(c){r(c)}})}function r(e){return n(function(t){t(e)})}Promise=n,n.resolve=r,n.reject=function(e){return n(function(t,i){i(e)})},n.all=function(e){return n(function(t,i,n,a){a=[],n=e.length||t(a),e.map(function(e,o){r(e).then(function(e){a[o]=e,--n||t(a)},i)})})}}("f","o"),u=function(e){return"[object Array]"===toString.call(e)},s=function(e,t){o(e,function(i,n){i==t&&e.splice(n,1)})},a=function(e,t){o(t,function(t,i){r(t)||(e[i]=t)})},d=function(e,t){var n=Object.keys(t.prototype);o(n,function(i){e.prototype[i]=t.prototype[i]}),n=Object.keys(t),o(n,function(n){e[n]=t[n],r(e[n])&&(e[n]=i(e[n],e))})},y=function(){function e(e){o(e.constructor.prototype,function(n,a){-1==t.indexOf(a)&&r(n)&&(e[a]=i(n,e))})}var t=["valueOf","isPrototypeOf","toString","constructor","propertyIsEnumerable","hasOwnProperty","toLocaleString"];return e}(),m=function(e){return new Promise(function(t,i){var n,a,r,s,c,l,u;if(n=e.method.toUpperCase(),a=e.url,l=e.params,r=JSON.stringify(e.data),u=e.headers,s=e.success,c=e.failure,"POST"==n&&l){r=new FormData;for(var p in l)r.append(p,l[p])}var d=new XMLHttpRequest;d.open(n,a),u&&u["Content-Type"]||d.setRequestHeader("Content-type","application/json"),u&&o(u,function(e,t){d.setRequestHeader(t,e)}),d.onreadystatechange=function(){if(d.readyState==XMLHttpRequest.DONE)if(d.status>=200&&d.status<400){var e,n,a;if(n=d.statusText,204!==d.status)try{a=JSON.parse(d.responseText)}catch(r){return console.log(r),void i(r)}e={status:n,data:a,code:d.status},s&&s(e),t(e)}else{var e,n,a;n=d.statusText;try{a=JSON.parse(d.responseText)}catch(r){a={},console.log(r)}e={status:n,data:a,code:d.status},c&&c(e),i(e)}},d.send(r)})},e.KiiExtensionBuckets={FIRMWARE:"FIRMWARE_BUCKET",MODEL:"MODEL_BUCKET",TAG:"TAG_BUCKET",FIRMWARE_NAMESPACE:"FIRMWARE_NAMESPACE"},e.ReservedBucketPrefix={FIRMWARE:"__FIRMWARE_",MODEL:"__MODEL_",MODEL_UPDATE_INFO:"__MODEL_UPDATE_INFO_",TAG:"__TAG_"},e.KiiPortalExceptions={UNSAVED_OBJECT:"The object has to be saved before using."},e._extensionUrl="http://localhost:1337",e._extApis={MODEL:"/models"},e._baseUrl="https://kii-yubari.herokuapp.com",e._apis={AUTHENTIC:e._extensionUrl+"/login",APP:e._extensionUrl+"/apps",MODEL:e._extensionUrl+"/models"},e.KiiPortalDevSettings={log:!0,debug:!0},n(KiiSite,{DEV:"https://api-development-jp.internal.kii.com/api",QA:"https://qa21.internal.kii.com/api"}),e.KiiLogger=function(){function e(){}return e.log=function(e){KiiPortalDevSettings.log&&console.log(e)},e.debug=function(e){KiiPortalDevSettings.debug&&console.log(e)},e}(),e.KiiObjectRequest=function(){function e(e,t){this._appID=e.getAppID(),this._appKey=e.getAppKey(),this._token=e.getAdminContext()._token,this._url=t.url,this._data=t.data,this._method=t.method,this._headers={},this._extHeaders=t.headers}return e.prototype.getAppID=function(){return this._appID},e.prototype.getAppKey=function(){return this._appKey},e.prototype.getToken=function(){return"Bearer "+this._token},e.prototype.execute=function(e){this.setKiiHeaders(),this._disableCacheURL();var t={headers:this._headers,method:this._method,data:this._data,url:this._url};return e=e||{},t.success=e.success,t.failure=e.failure,m(t)},e.prototype._disableCacheURL=function(){this._url+=-1!==this._url.indexOf("?")?"&disable_cache=":"?disable_cache=",this._url+=(new Date).getTime()},e.prototype.setKiiHeaders=function(){this._headers={"x-kii-appid":this.getAppID(),"x-kii-appkey":this.getAppKey(),"x-kii-sdk":KiiSDKClientInfo.getSDKClientInfo(),Authorization:this.getToken()},n(this._headers,this._extHeaders)},e}(),e.KiiPortalException=function(){function e(e){n(this,e)}return e}(),e.KiiPortalObject=function(e,t){function i(){this._kiiApp=null}var n;return n=t,i.prototype=new n,d(i,e),d(i,t),i.prototype.constructor=i,i.prototype.getKiiApp=function(){return this._kiiApp},i.prototype.setKiiApp=function(e){this._kiiApp=e},i.prototype._getBucketName=function(){return this.constructor._getBucketName()},i.prototype._getUriByID=function(e){return"kiicloud://buckets/"+this.constructor._getBucketName()+"/objects/"+e},i.prototype.init=function(){},i.prototype.renew=function(e){return this._renew(e)},i.prototype._renew=function(e){a(this,e),this.init()},i.prototype._cast=function(e){var t=this.constructor.factory(this.getKiiApp());a(t,e),a(this,t),this.init()},i.prototype.enableRead=function(e){var t=this;return new Promise(function(i,n){var a=t._generateACL(new KiiAnyAuthenticatedUser,KiiACLAction.KiiACLObjectActionRead);a.save({success:function(){e&&e.success&&e.success(),i(),console.log("Object ACL updated!")},failure:function(t,i){e&&e.failure()&&e.failure(),n(),console.log("Error updating object ACL: "+i)}})})},i.prototype.disableRead=function(e){var t=this;return new Promise(function(i,n){var a=t._generateACL(new KiiAnyAuthenticatedUser,KiiACLAction.KiiACLObjectActionRead,!0);a.save({success:function(){e&&e.success&&e.success(),i(),console.log("Object ACL updated!")},failure:function(t,i){e&&e.failure()&&e.failure(),n(),console.log("Error updating object ACL: "+i)}})})},i.prototype.enableWrite=function(e){var t=this;return new Promise(function(i,n){var a=t._generateACL(new KiiAnyAuthenticatedUser,KiiACLAction.KiiACLObjectActionWrite);a.save({success:function(){e&&e.success&&e.success(),i(),console.log("Object ACL updated!")},failure:function(t,i){e&&e.failure()&&e.failure(),n(),console.log("Error updating object ACL: "+i)}})})},i.prototype.disableWrite=function(e){var t=this;return new Promise(function(i,n){var a=t._generateACL(new KiiAnyAuthenticatedUser,KiiACLAction.KiiACLObjectActionWrite,!0);a.save({success:function(){e&&e.success&&e.success(),i(),console.log("Object ACL updated!")},failure:function(t,i){e&&e.failure()&&e.failure(),n(),console.log("Error updating object ACL: "+i)}})})},i.prototype._generateACL=function(e,t,i){var n=KiiACLEntry.entryWithSubject(e,t);i&&n.setGrant(!1);var a=this.objectACL();return a.putACLEntry(n),a},i.prototype.refresh=function(e){return this._refresh(e)},i.prototype._refresh=function(e){var t=this;return new Promise(function(i,a){var r;r={success:function(n){t._cast(n),e&&e.success&&e.success(t),i(t)},failure:function(t){e&&e.failure&&e.failure(t),a(t)}},n.prototype.refresh.call(t,r)})},i.refreshByID=function(e,t,i){return this.constructor._refreshByID(e,t,i)},i._refreshByID=function(e,t,i){var n=this;return new Promise(function(a,r){var o={success:function(e){var t=n.factory(app);t._cast(e),i&&i.success&&i.success(t),a(t)},failure:function(e){i&&i.failure&&i.failure(e),r(e)}};n.objectWithID(e,t).then(o.success,o.failure)})},i.prototype.save=function(e){return this._save(e)},i.prototype._save=function(e){var t=this;return new Promise(function(i,a){var r={success:function(n){t._cast(n),e&&e.success&&e.success(t),i(t)},failure:function(t){e&&e.failure&&e.failure(t),a(t)}};n.prototype.save.call(t,r)})},i.prototype.delete=function(e){return this._delete(e)},i.prototype._delete=function(e){var t=this;return new Promise(function(i,a){var r={success:function(){e&&e.success&&e.success(t),i(t)},failure:function(e){a(e)}};n.prototype.delete.call(t,r)})},i._bucketName=null,i._getBucketName=function(){return this._bucketName},i.prototype.clone=function(){var e=this,t=this.constructor.factory(this.getKiiApp());return o(this,function(i,n){r(i)||(t[n]=e[n])}),t},i.factory=function(e){return this._factory(e)},i._factory=function(e){var t,i,n,a,r;return r=this._getBucketName(),t=e.getAdminContext(),i=t.bucketWithName(r),a=new this,n=i.createObject(),a._renew(n),a._setObjectType(null),a.setKiiApp(e),a},i.objectWithID=function(e,t){var i=this;return new Promise(function(a,r){var o,s,c;o={success:function(e){s._renew(e),a(s)},failure:function(e){r(e)}},s=i.factory(e),c=n.objectWithURI(s._getUriByID(t)),c.refresh(o)})},i.executeQuery=function(e,t,i){var n=this;return new Promise(function(a,r){var s,c;c=e.getAdminContext().bucketWithName(n._getBucketName()),s={success:function(t,r,s){o(r,function(t,i){var a=n.factory(e);a._cast(t),r[i]=a}),i&&i.success.call(i,t,r,s),a(t,r,s)},failure:function(e){return null!=i&&i.failure?i.failure(t,e):void r(t,e)}},c.executeQuery(t,s)})},i}(KiiObject,KiiObjectAdmin),e.KiiPortalQuery=function(e){function t(){}var i=e;return d(t,i),t.prototype.constructor=t,t.prototype._dictValue=function(){var e,t;return t={},t.bestEffortLimit=this._limit,null!=this._paginationKey&&(t.paginationKey=this._paginationKey),e={descending:this._sortDescending},e.clause=null!=this._clause?this._clause._getDictValue():this.constructor._emptyDictValue(),null!=this._sortField&&(e.orderBy=this._sortField),t[this.constructor.queryName]=e,t},t.queryWithClause=function(e){var t;return t=new this,t._setClause(e),t},t.prototype.setDict=function(e){e&&(e.limit&&this.setLimit(e.limit),e.paginationKey&&this.setPaginationKey(e.paginationKey),e.orderBy&&(e.desc?this.sortByDesc(e.orderBy):this.sortByAsc(e.orderBy)))},t._getRequest=function(e,t){return t.headers=t.headers||{},new KiiObjectRequest(e,t)},t._generatePath=function(e){return e.getSiteURL()+"/apps/"+e.getAppID()},t._instantiate=function(){},t.executeQuery=function(t,i,n){var a=this;return new Promise(function(r,o){var s,c,l,u,p;l=a._generatePath(t)+"/query",s={},null!=i?s=i._dictValue():s[a.queryName]={clause:e._emptyDictValue()},u={data:s,url:l,method:"POST"},p=a._getRequest(t,u),c={success:function(e){var t,o,s,c,l;for(i.setPaginationKey(e.data.nextPaginationKey),o=[],l=e.data.results,s=0,c=l.length;c>s;s++)t=l[s],o.push(a._instantiate(t));null!=n&&n.success&&n.success(i,o),r({nextQuery:i,resultSet:o})},failure:function(e){null!=n&&n.failure&&n.failure(e),o({query:i,error:e})}},p.execute(c)})},t}(KiiQuery),e.KiiPortalRequest=function(){function e(e,t){return t&&(e.headers=e.headers||{},e.headers["x-app-id"]=t.getAppID(),e.headers["x-app-key"]=t.getAppKey(),e.headers.Authorization=t.getAdmin().getTokenType()+" "+t.getAdminContext()._token,e.headers["x-app-site"]=t.getSite()),m(e)}return e}(),e.KiiPortalUtilities=function(){function t(){}return t.MAX_DATE_IN_MILLIS=864e13,t.MIN_DATE_IN_MILLIS=-864e13,t._validateEmail=function(i){var n;return i=t._trim(i),n=/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,6}$/i,"string"!==(typeof i).toLowerCase()?(e.Kii.logger("Not string"),!1):i.match(n)?!0:!1},t._validatePhoneNumber=function(i){var n;return i=t._trim(i),n=/^[\\+]?[0-9]{10,}$/i,"string"!==(typeof i).toLowerCase()?(e.Kii.logger("Not string"),!1):i.match(n)?!0:!1},t._isGlobalPhoneNumber=function(i){var n;return i=t._trim(i),n=/^[\\+]{1}[0-9]{2}/,"string"!==(typeof i).toLowerCase()?(e.Kii.logger("Not string"),!1):i.match(n)?!0:!1},t._validateLocalPhone=function(i){var n;return i=t._trim(i),n=/^\d+$/,"string"!==(typeof i).toLowerCase()?(e.Kii.logger("Not string"),!1):i.match(n)?!0:(e.Kii.logger("Invalid format"),!1)},t._assertLocalPhoneIsValid=function(i){if(!t._validateLocalPhone(i))throw new e.InvalidLocalPhoneNumberException},t._validateCountryCode=function(i){var n;return i=t._trim(i),n=/^[a-z]{2}$/i,"string"!==(typeof i).toLowerCase()?(e.Kii.logger("Not string"),!1):i.match(n)?(e.Kii.logger("Is true"),!0):!1},t._assertCountryCodeIsValid=function(i){if(!t._validateCountryCode(i))throw new e.InvalidCountryException},t._validatePassword=function(t){var i;return e.Kii.logger("Validating password: "+t),i=/^[\x20-\x7E]{4,50}$/,"string"!==(typeof t).toLowerCase()?(e.Kii.logger("not string"),!1):t.match(i)?(e.Kii.logger("matched"),!0):(e.Kii.logger("other exception"),!1)},t._assertPasswordIsValid=function(i){if(!t._validatePassword(i))throw new e.InvalidPasswordException},t._validateUsername=function(e){var t;return t=/^[a-zA-Z0-9-_\\.]{3,64}$/i,"string"!==(typeof e).toLowerCase()?!1:e.match(t)?!0:!1},t._validateGroupID=function(e){var t;return t=/^[a-z0-9-_.]{1,30}$/,"string"!==(typeof e).toLowerCase()?!1:e.match(t)?!0:!1},t._validateDisplayName=function(e){var i;return"string"===t._type(e)&&1<=(i=e.length)&&50>=i},t._trim=function(e){var t;return t=/^(\s|\u00A0)+|(\s|\u00A0)+$/g,(e||"").replace(t,"")},t._safeAddTicks=function(i,n){if(isNaN(parseInt(i,10))||isNaN(parseInt(n,10)))throw new e.InvalidArgumentException("Parameters should be a number");if(Math.abs(i+n)>t.MAX_DATE_IN_MILLIS)throw new e.ArithmeticException("Addition of "+i+" and "+n+" result in long overflow");return i+n},t._safeMultiplyTicks=function(i,n){if(isNaN(parseInt(i,10))||isNaN(parseInt(n,10)))throw new e.InvalidArgumentException("Parameters should be a number");if(Math.abs(i*n)>t.MAX_DATE_IN_MILLIS)throw new e.ArithmeticException("Multiplication of "+i+" and "+n+" result in long overflow");return i*n},t._safeCalculateExpiresAtAsNumber=function(i,n){var a,r,o;o=0;try{r=t._safeMultiplyTicks(i,1e3),o=t._safeAddTicks(n,r)}catch(s){if(a=s,!(a instanceof e.ArithmeticException))throw a;o=t.MAX_DATE_IN_MILLIS}return o},t._safeCalculateExpiresAtAsDate=function(i,n){var a,r,o;o=0;try{r=t._safeMultiplyTicks(i,1e3),o=t._safeAddTicks(n,r)}catch(s){if(a=s,!(a instanceof e.ArithmeticException))throw a;o=t.MAX_DATE_IN_MILLIS}return new Date(o)},t._isJSONType=function(e){var t;return t=/\+?json(;.*)?$/i,e.match(t)},t._type=function(e){var t;return void 0===e||null===e?String(e):(t={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"},t[Object.prototype.toString.call(e)])},t._disableCacheURL=function(e){return e+=-1!==e.indexOf("?")?"&disable_cache=":"?disable_cache=",e+=(new Date).getTime()},t._validateServerCodeEntryName=function(e){var i;return i=/^[a-zA-Z][_a-zA-Z0-9]*$/i,"string"===t._type(e)&&e.match(i)},t._validateServerCodeEntryArgument=function(e){return"null"===t._type(e)||"object"===t._type(e)&&Object.keys(e).length>0},t._validateServerCodeEnryVersion=function(e){return"string"===t._type(e)&&""!==e},t._isNonEmptyString=function(e){return"string"!=typeof e?!1:e.length>0},t._Error=function(e,t){var i;return i=Error(e),i.target=t,i},t.logger={},t.logger.debug=function(e){KiiPortalDevSettings.debug&&console.log(e)},t}(),e.KiiPortalAdmin=function(){function t(){var e=this;this._apps=[],this._adminContenxt=null,this._accessToken=null,this._tokenType=null,this.setApps=function(t){e._apps=t},this.getApps=function(){return e._apps},this.setAdminContext=function(t){e._adminContenxt=t,KiiportalAdmin.setCurrentAdminContext(t)},this.getAdminContext=function(){return e._adminContenxt},this.setAccessToken=function(t){e._accessToken=t},this.getAccessToken=function(){return e._accessToken},this.getTokenType=function(){return e._tokenType},this.setTokenType=function(t){e._tokenType=t}}return t.getCurrentApp=function(){return this._currentApp},t.setCurrentAdminContext=function(e){t._currentAdminContext=e},t.getCurrentAdminContext=function(){return t._currentAdminContext},t.prototype.getAppByID=function(e){var t=this.getApps(),i=null;return o(t,function(t){i=t.getAppID()==e?t:i}),i},t.prototype.refreshApps=function(){return this._refreshApps()},t.prototype._refreshApps=function(e){var t=this;return new Promise(function(i,n){var a={success:function(n){t.setApps(n),e&&e.success.call(e,n),i(n)},failure:function(t){e&&e.failure&&e.failure.call(e,t),n(t)}};KiiPortalApp._withAdmin(t,a).catch(function(e){console.log(e)})})},t.login=function(i,n,a){return new Promise(function(r,o){var s={success:function(e){var i=new t;i.setAccessToken(e.data.access_token),i.setTokenType(e.data.token_type),a&&a.success.call(a,i),r(i)},failure:function(){a&&a.failure.apply(a,arguments),o.apply(o,arguments)}},c={url:e._apis.AUTHENTIC,method:"POST",data:{username:i,password:n,grant_type:"password"}};KiiPortalRequest(c).then(s.success,s.failure)})},t.prototype._addApp=function(e){this._apps.push(e)},t.prototype.useApp=function(e,t){return this._useApp(e,t)},t.prototype._useApp=function(e,i){return new Promise(function(n,a){var r={success:function(e){var r={success:function(a){e.setAdminContext(a),t._currentApp=e,i&&i.success.call(i,e),n(e)},failure:function(){i&&i.failure.apply(i,arguments),a(arguments)}};return Kii.initializeWithSite(e.getAppID(),e.getAppKey(),e.getSiteURL()),Kii.authenticateAsAppAdmin(e.getClientID(),e.getClientSecret(),r)},failure:function(e){a(e)}};e._refresh(r)})},t.prototype.createApp=function(){return KiiPortalApp.factory(this)},t}(),e.KiiPortalApp=function(){function t(){var e=this;this._appName=null,this._adminContext=null,this._appID=null,this._appKey=null,this._clientID=null,this._clientSecret=null,this._site=null,this._platforms=null,this._country=null,this._created=null,this._id=null,this._inactive=!1,this._owner=!1,this._plan=null,this._appSites=null,this._admin=null,this._firmwares=[],this._models=[],this._tags=[],this._server=null,this.getModels=function(){return e._models},this.setModels=function(t){e._models=t},this.getFirmwareNamespaces=function(){return e._firmwareNamespaces},this.setFirmwareNamespaces=function(t){e._firmwareNamespaces=t},this.getSiteURL=function(){switch(e._site){case"cn":return KiiSite.CN;case"cn3":return KiiSite.CN3;case"us":return KiiSite.US;case"jp":return KiiSite.JP;case"devjp":return KiiSite.DEV;case"qa":return KiiSite.QA;default:return KiiSite.CN3}},this.setAdmin=function(t){e._admin=t},this.getAdmin=function(){return e._admin},this.setAppName=function(t){e._appName=t},this.getAppName=function(){return e._appName},this.setPlan=function(t){e._plan=t},this.getPlan=function(){return e._plan},this.setAppSites=function(t){e._appSites=t},this.getAppSites=function(){return e._appSites},this.setPlatforms=function(i){var n=[];o(i,function(e){t.Platform_Enum.indexOf(e)>-1&&n.push(e)}),e._platforms=n},this.setServer=function(t){e._server=t},this.getServer=function(){return e._server},this.getPlatforms=function(){return e._platforms},this.setCountry=function(t){e._country=t},this.getCountry=function(){return e._country},this.setCreated=function(t){e._created=t},this.getCreated=function(){return e._created},this.setID=function(t){e._id=t},this.getID=function(){return e._id},this.setInactive=function(t){e._inactive=t},this.getInactive=function(){return e._inactive},this.setOwner=function(t){e._owner=t},this.getOwner=function(){return e.owner},this.setAppID=function(t){e._appID=t},this.getAppID=function(){return e._appID},this.setAppKey=function(t){e._appKey=t},this.getAppKey=function(){return e._appKey},this.setClientID=function(t){e._clientID=t},this.getClientID=function(){return e._clientID},this.setClientSecret=function(t){e._clientSecret=t},this.getClientSecret=function(){return e._clientSecret},this.setSite=function(e){this._site=e},this.getSite=function(){return this._site},this.setAdminContext=function(t){e._adminContext=t},this.getAdminContext=function(){return e._adminContext}}return t.factory=function(e){var t=new this;return t.setAdmin(e),t},t.prototype.extRequest=function(t){var i=this,a={"x-kii-appid":i.getAppID(),"x-kii-appkey":i.getAppKey(),"x-app-site":i.getSite(),Authorization:i.getTokenType()+" "+i.getAccessToken()};n(a,t.headers);var r={headers:a,method:t.method,data:t.data,url:e._extensionUrl+t.path};return callbacks=callbacks||{},r.success=callbacks.success,r.failure=callbacks.failure,KiiPortalRequest(r)},t.prototype.save=function(i){var n=this;return new Promise(function(a,r){var o,s,c,l;s=n.getAdmin().getAccessToken(),c=n.getAdmin().getTokenType(),o={method:"POST",url:e._apis.APP,headers:{Authorization:c+" "+s},data:{name:n.getAppName(),server:n.getServer(),platforms:n.getPlatforms()}},l={success:function(e){var r=e.data;t.fromJson(n,r),i&&i.success&&i.success(n),a(n)},failure:function(e){i&&i.failure&&i.failure(e),r(e)}},KiiPortalRequest(o).then(l.success,l.failure)})},t.Platform_Enum=["ios","android","unity","html5"],t.prototype._refresh=function(i){var n=this;return new Promise(function(a,r){var o,s,c,l,u;o=n.getAppID(),s=n.getAdmin().getAccessToken(),c=n.getAdmin().getTokenType(),l={method:"GET",url:e._apis.APP+"/"+o,headers:{Authorization:c+" "+s}},u={success:function(e){var r=e.data.app;t.fromJson(n,r),n._putSecret(r),i&&i.success.call(i,n),a(n)},failure:function(e){i&&i.failure.apply(i,arguments),r(e)}},KiiPortalRequest(l).then(u.success,u.failure)})},t._withAdmin=function(i,n){return new Promise(function(a,r){var s,c,l,u;c=i.getTokenType(),s=i.getAccessToken(),l={url:e._apis.APP,method:"GET",headers:{Authorization:c+" "+s}},u={success:function(e){var r,s,c;c=[],r=e.data,s=r.apps,o(s,function(e){var n=new t;n=t.fromJson(n,e),n.setAdmin(i),c.push(n)}),n&&n.success.call(n,c),a(c)},failure:function(e){n.failure&&n.failure.call(n,e),r(e)}},KiiPortalRequest(l).then(u.success,u.failure)})},t.prototype._putSecret=function(e){this.setClientID(e.client_id),this.setClientSecret(e.client_secret)},t.fromJson=function(e,t){var i;return i=t,e.setAppID(i.app_id),e.setAppKey(i.app_key),e.setCountry(i.country),e.setCreated(i.created),e.setID(i.id),e.setInactive(i.inactive),e.setAppName(i.name),e.setOwner(i.owner),e.setPlatforms(i.platforms),e.setSite(i.site_name),e.setClientID(i.client_id),e.setClientSecret(i.client_secret),e.setPlan(i.plan),e.setAppSites(i.app_sites),e},t.prototype._addModel=function(e){this._models.push(e)},t.prototype._removeModel=function(e){s(this._models,e)},t.prototype.createModel=function(){return KiiPortalModel.factory(this)},t.prototype.refreshModels=function(e){return KiiPortalModel._getAll(this,e)},t.prototype.getModelByID=function(e,t){var i=KiiPortalModel.refreshByID(this,e,t);return i},t.prototype.getFirmwareNamespaceByID=function(e,t){return KiiPortalFirmwareNamespace.refreshByID(this,e,t)},t.prototype._addFirmwareNamespace=function(e){return this._firmwareNamespaces.push(e),this._firmwareNamespaces},t.prototype._removeFirmwareNamespace=function(e){return s(this._firmwareNamespaces,e),this._firmwareNamespaces},t.prototype.createFirmwareNamespace=function(){return KiiPortalFirmwareNamespace.factory(this)},t.prototype.refreshFirmwareNamespaces=function(e){return KiiPortalFirmwareNamespace._getAll(this,e)},t.prototype.refreshTags=function(e){return KiiPortalTag._getAll(this,e)},t.prototype._setTags=function(e){return this._tags=e},t.prototype._addTag=function(e){this._tags.push(e)},t.prototype.getTags=function(){return this._tags},t.prototype.getTagByID=function(e,t){return KiiPortalTag.refreshByID(this,e,t)},t.prototype.createTag=function(){return KiiPortalTag.factory(this)},t.prototype._removeTag=function(e){return s(this._tags,e),this._tags},t.prototype.getUserList=function(e,t,i){return KiiPortalUser.getUserList(e,t,i)},t.prototype.findUserByUserID=function(e,t,i){return KiiPortalUser.findUserByUserID(e,t,i)},t.prototype.queryThings=function(e,t,i){return KiiThingAdmin.query(this,e,t,i)},t.prototype.nextThings=function(e,t){return KiiThingAdmin.nextThings=KiiThingAdmin._nextWithApp(this,e,t)},t.prototype._setThings=function(e){this._things=e},t.prototype.getThings=function(){return this._things},t.prototype.addThing=function(e){return this._things.splice(0,0,e)},t.prototype.addThings=function(e){var t=this;this._things=this._things||[],o(e,function(e){var i=!0;o(t._things,function(t){t.getThingID()==e.getThingID()&&(i=!1)}),i&&t._things.push(e)})},t}(),e.KiiPortalFirmware=function(t){function i(){var e=this;y(e),this._name=null,this._models=[],this._state=null,this._downloadURL=null,this._description=null,this._namespace=null,this.namespace=null,this._initialSchema=null,this.setNamespace=function(t){this._namespace=t,e.set("namespace",t)},this.getNamespace=function(){return e.get("namespace")},this.setDownloadURL=function(t){e._downloadURL=t,e.set("downloadURL",t)},this.getDownloadURL=function(){return e.get("downloadURL")},this.getName=function(){return e.get("name")},this.setName=function(t){e._name=t,e.set("name",t)},this.setState=function(t){e._state=t,e.set("state",t)},this.getState=function(){return e.get("state")},this.setDescription=function(t){e.description=t,e.set("description",t)},this.getDescription=function(){return e.get("description")},this.setInitialSchema=function(){},this.getInitialSchema=function(){return e.get("initialSchema")}}var n;return n=t,i.prototype=new n,d(i,n),i.prototype.constructor=i,i._bucketName=e.KiiExtensionBuckets.FIRMWARE,i.prototype.addModel=function(e,t){var i=this;if(this._models.indexOf(e.getName())>-1)return null;this._models.push(e.getName());e.addFirmware(this);return new Promise(function(e,n){var a={success:function(i){t&&t.success&&t.success.apply(t.success,arguments),e(i)},failure:function(){t&&t.failure&&t.failure.apply(t.failure,arguments),n(n)}};i.set("models",i._models),i.save(a)})},i.prototype.getModels=function(){return this._models},i.prototype.setModels=function(e){this._models=e||[],this.set("models",this._models)},i.prototype.deleteModel=function(e,t){var i=this,n=e.getName(),a=this._models.indexOf(n);if(0>a)return null;this._models.splice(a,1);e.deleteFirmware(this);return new Promise(function(e,n){var a={success:function(i){t&&t.success&&t.success.apply(t.success,arguments),e(i)},failure:function(e){t&&t.failure&&t.failure.apply(t.failure,arguments),n(e)}};i.set("models",i._models),i.save(a)})},i.prototype._setUpdateInfoBucketName=function(t){this.set("updateInfoBucketName",e.ReservedBucketPrefix.MODEL_UPDATE_INFO+t)},i.StateEnum={CREATED:"CREATED",PUBLISHED:"PUBLISHED",PUSHED:"PUSHED",DISABLED:"DISABLED"},i.prototype.deleteFirmwareFile=function(e){var t=this;return new Promise(function(i,n){var a={success:function(){var a={success:function(){e&&e.success&&e.success(t),i(t)},failure:function(t){e&&e.failure&&e.failure(t),n(t)}};t.setDownloadURL(""),t.save(a)},failure:function(t){e&&e.failure&&e.failure.apply(e,t),n(t)}};t.deleteBody(a)})},i.prototype.uploadFirmwareFile=function(e,t){var i=this;return new Promise(function(a,r){var o=function(e){t&&t.failure&&t.failure.apply(t,e),r(e)},s=function(){i.publishBody({success:function(e,t){c(t)},failure:function(e){o(e)}})},c=function(e){var n={success:function(){t&&t.success&&t.success(i),a(i)},failure:function(e){t&&t.failure&&t.failure(e),r(e)}};i.setDownloadURL(e),i.save(n)};n.prototype.uploadBody.call(i,e).then(s,o)})},i.prototype.push=function(){var e,t,n;return t=this,e=this._models,arguments.length>0&&(arguments[0]instanceof KiiPortalModel?(e=[arguments[0]],n=arguments[1]):n=arguments[0]),new Promise(function(a,r){var s=0;0==e.length&&r("No model uses this firmware, push command is rejected!"),o(e,function(i){var o,c,l;l=t.clone(),o=ReservedBucketPrefix.MODEL+i,c=t.getKiiApp().getAdminContext().bucketWithName(o),l._setBucket(c),l._setUUID(null),l._setUpdateInfoBucketName(i),l.save({success:function(){s++,s==e.length&&t.save().then(function(){n&&n.success&&n.success(!0),a(!0)},function(e){r(e)})},failure:function(e){n&&n.failure&&n.failure(e),r(e)}})}),t.setState(i.StateEnum.PUSHED)})},i.prototype.disable=function(e){var t=this;return new Promise(function(n,a){t.setState(i.StateEnum.DISABLED),t.save({success:function(){e&&e.success&&e.success(),n()},failure:function(t){e&&e.failure&&e.failure(t),a(t)}})})},i.prototype.publish=function(e){var t=this;return new Promise(function(n,a){t.setState(i.StateEnum.PUBLISHED),t.save({success:function(){e&&e.success&&e.success(),n()},failure:function(t){e&&e.failure&&e.failure(t),a(t)}})})},i.prototype.delete=function(e){var t=this;return new Promise(function(i,a){var r={success:function(){t.namespace._removeFirmware(t),e&&e.success&&e.success(t),i(t)},failure:function(e){a(e)}};n.prototype.delete.call(t,r)})},i.prototype.save=function(e){var t=this,i=t.getUUID()?!1:!0;return new Promise(function(a,r){var o={success:function(){i&&t.namespace._addFirmware(t),e&&e.success&&e.success(t),a(t)},failure:function(t){e&&e.failure&&e.failure(t),r(t)}};n.prototype.save.call(t,o)})},i.factory=function(e,t){var a;return a=n.factory.call(this,e),a.setState(i.StateEnum.CREATED),t&&(a.setNamespace(t.getName()),a.namespace=t),a},i.prototype.init=function(){this.setName(this.get("name")),this.setNamespace(this.get("namespace")),this.setState(this.get("state")),this.setModels(this.get("models"))},i._withFirmwareNamespace=function(e,t){var i=this;return new Promise(function(n,a){var r,s,c,l;return l=e.getKiiApp(),c=KiiClause.equals("namespace",e.getName()),r=KiiQuery.queryWithClause(c),s={success:function(i,a,r){e.setFirmwares(a),o(a,function(t){t.namespace=e}),t&&t.success&&t.success(i,a,r),n(i,a,r)},failure:function(e,t){a(e,t)}},i.executeQuery(l,r,s)})},i._getAll=function(e,t){var i=this;return new Promise(function(n,a){var r,o;return r=KiiQuery.queryWithClause(),o={success:function(i,a,r){e.setFirmwares(a),t&&t.success&&t.success(i,a,r),n(i,a,r)},failure:function(e,t){a(e,t)}},i.executeQuery(e,r,o)})},i}(KiiPortalObject),e.KiiPortalFirmwareNamespace=function(t){function i(){var e=this;y(e),this._name="",this._versionName=null,this._firmwares=[],this.setName=function(t){e._name=t,e.set("name",t)},this.getName=function(){return e.get("name")},this.getFirmwares=function(){return e._firmwares},this.setFirmwares=function(t){e._firmwares=t},this._addFirmware=function(t){e._firmwares.push(t)},this._removeFirmware=function(t){e._firmwares.splice(e._firmwares.indexOf(t),1)},this.getVersionName=function(){return e.get("versionName")},this.setVersionName=function(t){e._versionName=t,e.set("versionName",t)}}var n;return n=t,i.prototype=new n,d(i,n),i.prototype.constructor=i,i._bucketName=e.KiiExtensionBuckets.FIRMWARE_NAMESPACE,i.prototype.refreshFirmwares=function(e,t,i){return KiiPortalFirmware._withFirmwareNamespace(this,e,t,i)
},i.prototype.createFirmware=function(){return KiiPortalFirmware.factory(this.getKiiApp(),this)},i.prototype.delete=function(e){var t=this;return new Promise(function(i,a){var r={success:function(){t._kiiApp._removeFirmwareNamespace(t),e&&e.success&&e.success(t),i(t)},failure:function(e){a(e)}};n.prototype.delete.call(t,r)})},i.prototype.save=function(e){var t=this,i=t.getUUID()?!1:!0;return new Promise(function(a,r){var o={success:function(){i&&t._kiiApp._addFirmwareNamespace(t),e&&e.success&&e.success(t),a(t)},failure:function(t){e&&e.failure&&e.failure(t),r(t)}};n.prototype.save.call(t,o)})},i.factory=function(e){var t=n.factory.call(this,e);return t},i.prototype.init=function(){this.setName(this.get("name")),this.setVersionName(this.get("versionName"))},i._getAll=function(e,t){var i=this;return new Promise(function(n,a){var r,o;return r=KiiQuery.queryWithClause(),o={success:function(i,a,r){e.setFirmwareNamespaces(a),t&&t.success&&t.success(i,firmwares,r),n(i,a,r)},failure:function(e,t){a(e,t)}},i.executeQuery(e,r,o)})},i}(KiiPortalObject),e.KiiPortalModel=function(t){function i(){var e=this;y(e),this._name=null,this._things=null,this._imageUrl=null,this._firmwares=[],this._firmwareNamespace=null,this._portalSchemas=null,this.getImageUrl=function(){return e._imageUrl},this.setImageUrl=function(t){e._imageUrl=t,n.prototype.set.call(e,"imageUrl",t)},this.setName=function(t){e._name=t,e.set("name",t)},this.getName=function(){return e.get("name")},this.getFirmwares=function(){return e._firmwares},this.setFirmwares=function(t){e._firmwares=t||[],e.set("firmwares",e._firmwares)},this.setFirmwareNamespace=function(t){e._firmwareNamespace=t,e.set("firmwareNamespace",t)},this.getFirmwareNamespace=function(){return e.get("firmwareNamespace")},this.getPortalSchemas=function(){return e._portalSchemas},this.setPortalSchemas=function(t){e._portalSchemas=t}}var n;return n=t,i.prototype=new n,d(i,n),i.prototype.constructor=i,i._bucketName=e.KiiExtensionBuckets.MODEL,i.prototype.init=function(){this.setName(n.prototype.get.call(this,"name")),this.setImageUrl(n.prototype.get.call(this,"imageUrl")),this.setFirmwareNamespace(n.prototype.get.call(this,"firmwareNamespace")),this.setFirmwares(n.prototype.get.call(this,"firmwares"))},i.factory=function(e){var t=n.factory.call(this,e);return t},i.prototype.deleteFirmware=function(e,t){var i=this,n=e.getUUID(),a=this._firmwares.indexOf(n);if(0>a)return null;this._firmwares.splice(a,1);var r=e.deleteModel(this);return new Promise(function(e,n){var a={success:function(i){t&&t.success&&t.success.apply(t.success,arguments),e(i)},failure:function(e){t&&t.failure&&t.failure.apply(t.failure,arguments),n(e)}};r?r.then(function(){i.set("firmwares",i._firmwares),i.save(a)},function(e){a.failure(e),n(e)}):(i.set("firmwares",i._firmwares),i.save(a))})},i.prototype.addFirmware=function(e,t){var i=this;if(this._firmwares.indexOf(e.getUUID())>-1)return null;this._firmwares.push(e.getUUID());var n=e.addModel(this);return new Promise(function(e,a){var r={success:function(i){t&&t.success&&t.success.apply(t.success,arguments),e(i)},failure:function(e){t&&t.failure&&t.failure.apply(t.failure,arguments),a(e)}};n?n.then(function(){i.set("firmwares",i._firmwares),i.save(r)},function(e){r.failure(e),a(e)}):(i.set("firmwares",i._firmwares),i.save(r))})},i._getAll=function(e,t){return new Promise(function(n,a){var r,o;return r=KiiQuery.queryWithClause(),o={success:function(i,a,r){e.setModels(a),t&&t.success&&t.success(i,a,r),n(i,a,r)},failure:function(e,t){a(e,t)}},i.executeQuery(e,r,o)})},i.prototype.delete=function(e){var t=this;return new Promise(function(i,a){var r,o;r={success:function(){o=t.getKiiApp(),o._removeModel(t),e&&e.success&&e.success(t),i(t)},failure:function(t){e&&e.failure&&e.failure(t),a(t)}},n.prototype.delete.call(t,r)})},i.refreshByID=function(e,t,n){return new Promise(function(a,r){var o;o={success:function(e){n&&n.success&&n.success(e),a(e)},failure:function(e){n&&n.failure&&n.failure(e),r(e)}},i.objectWithID(e,t).then(o.success,o.failure)})},i.prototype.createSchema=function(){return KiiPortalSchema.create(this)},i.prototype.uploadImage=function(e,t){var i=this;return new Promise(function(a,r){var o=function(e){t&&t.failure&&t.failure.apply(t,e),r(e)},s=function(){i.publishBody({success:function(e,t){c(t)},failure:function(e){o(e)}})},c=function(e){var n={success:function(){t&&t.success&&t.success(i),a(i)},failure:function(e){t&&t.failure&&t.failure(e),r(e)}};i.setImageUrl(e),i.save(n)};n.prototype.uploadBody.call(i,e).then(s,o)})},i.prototype.save=function(e){var t=this,i=t.getUUID()?!1:!0;return new Promise(function(a,r){var o,s;o={success:function(){s=t.getKiiApp(),i&&s._addModel(t),e&&e.success&&e.success(t),a(t)},failure:function(t){e&&e.failure&&e.failure(t),r(t)}},n.prototype.save.call(t,o)})},i.prototype.refreshPortalSchemas=function(e){return KiiPortalSchema._withModel(this,e)},i.prototype.getModelBucket=function(){return this.getKiiApp().getAdminContext().bucketWithName(i._getBucketName()+this.getUUID())},i.prototype.saveSchema=function(e,t){var i=this;return new Promise(function(n,a){var r={success:function(e){var a=i.getPortalSchemas();a.indexOf(e)&&a.push(e),n(e),t&&t.success&&t.success(e)},failure:function(e){t&&t.failure&&t.failure(e),a(e)}};e.save(r)})},i}(e.KiiPortalObject),e.KiiPortalSchema=function(){function t(e,t){var i=this;this.id=null,this._modelId=t.getUUID(),this._version=null,this.properties=[],this._kiiApp=t.getKiiApp(),this._model=t,this.createdAt=null,this.updatedAt=null,this.getProperties=function(){return i.properties},this.getKiiApp=function(){return i._kiiApp},this.getModelId=function(){return i._modelId},this.setModelId=function(e){i._modelId=e},this.getVersion=function(){return i._version},this.setVersion=function(e){i._version=e},this.init(e)}return t.prototype.init=function(e,t){var i=this;e&&(i.id=e.id,i.setVersion(e.version),i.setModelId(e.modelId),i.createdAt=e.createdAt,i.updatedAt=e.updatedAt,o(e.properties,function(e){i.properties.push(new KiiPortalSchemaProperty(e))})),i._model=t||i._model},t.prototype.createProperty=function(){var e=new KiiPortalSchemaProperty;return this.addProperty(e),e},t.prototype.addProperty=function(e){this.properties.push(e)},t.prototype.removeProperty=function(e){this.properties.splice(this.properties.indexOf(e),1)},t._withModel=function(i,n){var a,r;return r=i.getKiiApp(),new Promise(function(s,c){a={method:"GET",url:e._apis.MODEL+"/"+i.getUUID()+"/schemas",success:function(e){var a=e.data.schemas,r=[];o(a,function(e){r.push(t.factory(e,i))}),i.setPortalSchemas(r),n&&n.success&&n.success(r),s(r)},failure:function(e){n&&n.failure&&n.failure(e),c(e)}},KiiPortalRequest(a,r)})},t.prototype.refresh=function(){var t={method:"GET",url:e._apis.MODEL+"/"+this.getModelId()+"/schemas/"+this.getVersion(),headers:{Authorization:tokenType+" "+accessToken},success:function(){},failure:function(){}};KiiPortalRequest(t,this.getKiiApp())},t.prototype.save=function(t){var i,n,a,r,s,c,l;return s=this.getKiiApp().getAdmin().getTokenType(),c=this.getKiiApp().getAdmin().getAccessToken(),l=[],o(this.getProperties(),function(e){l.push(e.purify())}),r=this,i=this.id,i||(n=!0),new Promise(function(i,o){a=n?{method:"POST",url:e._apis.MODEL+"/"+r.getModelId()+"/schemas",data:{modelId:r.getModelId(),properties:l,version:r.getVersion()},headers:{Authorization:s+" "+c},success:function(e){r.init(e.data,r._model),t&&t.success&&t.success(r),i(r)},failure:function(e){t&&t.failure&&(t.failure(e),o(e))}}:{method:"POST",data:{id:r.id,modelId:r.getModelId(),properties:l,version:r.getVersion()},url:e._apis.MODEL+"/"+r._model.getUUID()+"/schemas/"+r.getVersion(),headers:{Authorization:s+" "+c},success:function(e){r.init(e.data,this._model),t&&t.success&&t.success(r),i(r)},failure:function(e){t&&t.failure&&t.failure(e),o(e)}},KiiPortalRequest(a,r.getKiiApp()).catch(function(e){KiiLogger.debug(new KiiPortalException(e))})})},t.create=function(e){var i=t.factory(null,e);return i.setModelId(e.getUUID()),i},t.factory=function(e,i){return new t(e,i)},t}(),e.KiiPortalSchemaProperty=function(){function e(e){this.key=null,this.displayName=null,this.type=null,this.controllable=null,this.unit=null,this.min=null,this.max=null,e&&n(this,e)}return e.KeyEnum=["key","displayName","type","controllable","unit","min","max"],e.Schema_Type_Enum={BOOLEAN:"boolean",INT:"integer",FLOAT:"float",STRING:"string"},e.prototype.purify=function(){var t={},i=this;return o(e.KeyEnum,function(e){i[e]&&(t[e]=i[e])}),t},e}(),e.KiiPortalTag=function(t){function i(){var e=this;y(e),this._name=null,this._description=null,this._thingIDs=[],this.set("thingIDs",this._thingIDs),this._things=[],this._nextThingQuery=null,this._customData={},this.setCustomData=function(t){e._customData=t,e.set("customData",t)},this.getCustomData=function(){return e._customData},this.setNextThingQuery=function(t){return e._nextThingQuery=t},this.getNextThingQuery=function(){return e._nextThingQuery},this.getThings=function(){return e._things},this.setThings=function(t){e._things=t},this.setThingIDs=function(t){e._thingIDs=t,e.set("thingIDs",t)},this.getThingIDs=function(){return e.get("thingIDs")},this.setName=function(t){e._name=t,e.set("name",t)},this.getName=function(){return e._name},this.getDescription=function(){return e._discription},this.setDescript=function(t){e._description=t,e.set("description",t)}}var n;return n=t,i.prototype=new n,d(i,n),i.prototype.constructor=i,i._bucketName=e.KiiExtensionBuckets.TAG,i.prototype.save=function(e){var t=this,i=t.getUUID()?!1:!0;return new Promise(function(a,r){var o={success:function(){i&&t._kiiApp._addTag(t),e&&e.success&&e.success(t),a(t)},failure:function(t){e&&e.failure&&e.failure(t),r(t)}};n.prototype.save.call(t,o)})},i._getAll=function(e,t){return new Promise(function(n,a){var r,o;return r=KiiQuery.queryWithClause(),o={success:function(i,a,r){e._setTags(a),t&&t.success&&t.success(i,a,r),n(i,a,r)},failure:function(e,t){a(e,t)}},i.executeQuery(e,r,o)})},i.prototype.refresh=function(e){return this._refresh(e)},i.prototype.delete=function(e){var t=this;return new Promise(function(i,a){var r,o;r={success:function(){o=t.getKiiApp(),o._removeTag(t),e&&e.success&&e.success(t),i(t)},failure:function(t){e&&e.failure&&e.failure(t),a(t)}},n.prototype.delete.call(t,r)})},i.prototype.init=function(){this.setName(this.get("name")),this.setDescript(this.get("description")),this.setThingIDs(this.get("thingIDs")),this.setCustomData(this.get("customData"))},i.prototype.addThing=function(e){this._things||(this._things=[]),this._things.push(e),this.addThingID(e.getThingID())},i.prototype.addThingID=function(e){this._thingIDs||(this._thingIDs=[],this.setThingIDs(this._thingIDs)),this._thingIDs.push(e)},i.prototype.removeThing=function(e){this.removeThingID(e.getThingID()),s(this._things,e)},i.prototype.removeThingID=function(e){s(this._thingIDs,e)},i.prototype.refreshThings=function(e){var t,i,n;return n=this,t=this.getKiiApp(),i=KiiClause["in"]("_thingID",this.getThingIDs()),new Promise(function(a,r){var o={success:function(t){var i,r;i=t.things,r=t.query,n.setNextThingQuery(r),n.setThings(i),e&&e.failure&&e.success(i),a(i)},failure:function(t){e&&e.failure&&e.failure(t),r(t)}};KiiThingAdmin.query(t,null,i).then(o.success,o.failure)})},i.prototype.nextThings=function(e){var t=this;return new Promise(function(){var i,n;i=t.getKiiApp(),n={success:function(i){var n;n=i.things,nextQuery=i.query,t.setNextThingQuery(nextQuery),t.setThings(n),e&&e.failure&&e.success(n),resolve(n)},failure:function(t){e&&e.failure&&e.failure(t),reject(t)}},KiiThingAdmin.query(i,e,t.getNextThingQuery()).then(n.success,n.failure)})},i}(KiiPortalObject),e.KiiPortalUserQuery=function(e){function t(){}return d(t,e),t.prototype.constructor=t,t.queryName="userQuery",t._getRequest=function(e,t){return t.headers=t.headers||{},t.headers["Content-Type"]="application/vnd.kii.userqueryrequest+json",new KiiObjectRequest(e,t)},t._generatePath=function(t){return e._generatePath.call(this,t)+"/users"},t._instantiate=function(e){return null===e?null:new KiiPortalUser(e)},t}(KiiPortalQuery),e.KiiPortalUserRequest=function(e){function t(i){var a=KiiPortalAdmin.getCurrentApp();t.prototype=new e(a,i);var r={method:"GET",headers:{"Content-Type":"application/json"}};n(r,i),this._appID=a.getAppID(),this._appKey=a.getAppKey(),this._token=a.getAdminContext()._token,this._url=Kii.getBaseURL()+"/apps/"+a.getAppID()+i.extraUrl,this._data=r.data,this._method=r.method,this._headers={},this._extHeaders=r.headers}return d(t,e),t.prototype.constructor=t,t}(KiiObjectRequest),e.KiiPortalUser=function(e){function t(e){y(this),this._info=e}return d(t,e),t.prototype.constructor=t,t}(KiiUserAdmin),KiiPortalUser.getUserList=function(e,t,i){return new Promise(function(n,a){var r;r=KiiPortalUserQuery.queryWithClause(t),r.setDict(i);var o={success:function(t,i){e&&e.success&&e.success.apply(e.success,arguments),n({query:t,users:i})},failure:function(t,i){e&&e.failure&&e.failure.apply(e.failure,arguments),a({query:t,error:i})}},s=KiiPortalAdmin.getCurrentApp();return KiiPortalUserQuery.executeQuery(s,r,o)})},KiiPortalUser.findUserByUserID=function(e){return new Promise(function(t,i){var n={extraUrl:"/users/"+e},a=new KiiPortalUserRequest(n);a.execute().then(function(e){t(new KiiPortalUser(e.data))},function(e){i(e)})})},KiiPortalUser.prototype.register=function(){var e=this;return new Promise(function(t,i){var n={loginName:e._info.loginName,password:e._info.password,displayName:e._info.displayName,emailAddress:e._info.emailAddress,phoneNumber:e._info.phoneNumber,country:e._info.country,phoneNumberVerified:null,emailAddressVerified:null,createdAt:null,modifiedAt:null};n.country||delete n.country;var a={data:n,method:"POST",headers:{"Content-Type":"application/vnd.kii.RegistrationRequest+json"},extraUrl:"/users"},r=new KiiPortalUserRequest(a);r.execute().then(function(e){t(e)},function(e){i(e)})})},KiiPortalUser.prototype.delete=function(){var e=this;return new Promise(function(t,i){var n={method:"DELETE",extraUrl:"/users/"+e.getID()},a=new KiiPortalUserRequest(n);a.execute().then(function(e){t(e)},function(e){i(e)})})},KiiPortalUser.prototype.getID=function(){return this._info.userID},KiiPortalUser.prototype.memberOfGroups=function(){var e=this;return new Promise(function(t,i){var n={headers:{"Content-Type":"application/vnd.kii.GroupsRetrievalResponse+json"},extraUrl:"/groups?is_member="+e.getID()},a=new KiiPortalUserRequest(n);a.execute().then(function(e){t(e)},function(e){i(e)})})},KiiPortalUser.prototype.ownerOfGroups=function(){var e=this;return new Promise(function(t,i){var n={headers:{"Content-Type":"application/vnd.kii.GroupsRetrievalResponse+json"},extraUrl:"/groups?owner="+e.getID()},a=new KiiPortalUserRequest(n);a.execute().then(function(e){t(e)},function(e){i(e)})})},KiiPortalUser.prototype.resetPassword=function(e){var t=this;return new Promise(function(i,n){var a={notificationMethod:e},r={data:a,method:"POST",headers:{"Content-Type":"application/vnd.kii.ResetPasswordRequest+json"},extraUrl:"/users/"+t.getID()+"/password/request-reset"},o=new KiiPortalUserRequest(r);o.execute().then(function(e){i(e)},function(e){n(e)})})},KiiPortalUser.prototype.toggleUserStatus=function(e){var t=this;return new Promise(function(i,n){var a={data:e,method:"PUT",headers:{"Content-Type":"application/vnd.kii.UserStatusUpdateRequest+json"},extraUrl:"/users/"+t.getID()+"/status"},r=new KiiPortalUserRequest(a);r.execute().then(function(e){i(e)},function(e){n(e)})})},KiiPortalUser.prototype.update=function(e){var t=this;return new Promise(function(i,n){var a={data:e,method:"POST",headers:{"Content-Type":"application/vnd.kii.UserUpdateRequest+json"},extraUrl:"/users/"+t.getID()},r=new KiiPortalUserRequest(a);r.execute().then(function(e){i(e)},function(e){n(e)})})},e.KiiThingAdminQuery=function(e){function t(){}return d(t,e),t.prototype.constructor=t,t.queryName="thingQuery",t._getRequest=function(e,t){return t.headers=t.headers||{},t.headers["Content-Type"]="application/vnd.kii.thingqueryrequest+json",new KiiObjectRequest(e,t)},t._generatePath=function(t){return e._generatePath.call(this,t)+"/things"},t._instantiate=function(e){return new KiiThingAdmin(e)},t}(KiiPortalQuery),KiiThingAdmin.query=function(e,t,i,n){return new Promise(function(a,r){var o;o=KiiThingAdminQuery.queryWithClause(i),o.setDict(n);var s={success:function(i,n){e._setThings(n),t&&t.success&&t.success.apply(t.success,arguments),a({query:i,things:n})},failure:function(e,i){t&&t.failure&&t.failure.apply(t.failure,arguments),r({query:e,error:i})}};return KiiThingAdminQuery.executeQuery(e,o,s)})},KiiThingAdmin._nextWithApp=function(e,t,i){return new Promise(function(t,n){var a={success:function(i,n){e.addThings(n),t({query:i,things:e.getThings()})},failure:function(e,t){n({query:e,error:t})}};KiiThingAdminQuery.executeQuery(e,i,a)})},KiiThingAdmin.prototype.save=function(){var e=this,t=!1;return new Promise(function(i,n){var a,r,s,c;if(c=KiiPortalAdmin.getCurrentApp(),s={_created:e.getCreated(),_disabled:e.getDisabled(),_layoutPosition:"STANDALONE",_thingID:e.getThingID(),_thingType:e.fields._thingType,_vendorThingID:e.getVendorThingID()},o(e.fields,function(e,t){s[t]=e}),e.getThingID()||(t=!0),t){a={data:s,method:"POST",headers:{"Content-Type":"application/vnd.kii.ThingRegistrationAndAuthorizationRequest+json"},url:Kii.getBaseURL()+"/apps/"+c.getAppID()+"/things"};var r=new KiiObjectRequest(c,a);r.execute().then(function(t){c.addThing(e),e._renewThingFields(t.data),i(e)},function(e){n(e)})}else{a={data:s,method:"PUT",headers:{"Content-Type":"application/vnd.kii.ThingUpdateRequest+json"},url:Kii.getBaseURL()+"/apps/"+c.getAppID()+"/things/"+e.getThingID()};var r=new KiiObjectRequest(c,a);r.execute().then(function(e){i(e)},function(e){n(e)})}})}}(),angular.module("StarterPack.Portal.AppManager.Observation",[]),angular.module("StarterPack.Portal.AppManager.Observation").directive("deviceBoard",[function(){return{restrict:"E",templateUrl:"app/components/Portal/AppManager/ApplicationEditor/Observation/directives/device-board/device-board.directive.js",scope:{tag:"=?"},replace:!0,link:function(e,t){$(t).draggable()},controller:["$scope","AppUtils",function(e,t){e.init=function(){e.loadThings();var t=e.tag.getCustomData();t&&t.fields&&(e.fields=t.fields)},e.loadThings=function(){var i=e.tag.getThingIDs();i&&0!=i.length||(t.doLoading(),e.tag.refreshThings(function(){t.whenLoaded()},function(){t.whenLoaded()}))},e.loadMore=function(){e.tag.nextThings()},e.editTag=function(){e.editingFields=_.clone(e.fields)}}]}}]),angular.module("StarterPack.Portal.AppManager.ModelManager",[]),angular.module("StarterPack.Portal.AppManager.ModelManager").controller("ModelListController",["$scope","$rootScope","$state","AppUtils","ModelService","$uibModal","AppConfig",function(e,t,i,n,a,r){e.viewModel=function(e){i.go("app.Portal.AppManager.ApplicationEditor.ModelManager.ModelInfo",{modelId:e.getUUID()})},e.openCreateModal=function(){var t=r.open({animation:!0,templateUrl:"app.Portal.AppManager.ApplicationEditor.ModelManager.CreateModal",resolve:{app:e.myApp},controller:"ModelListController.CreateModel",size:"md"});t.result.then(function(){e.myModels=e.myApp.getModels()},function(){})}}]).controller("ModelListController.CreateModel",["ApplicationService","AppUtils","$scope","$uibModalInstance","app","ModelService",function(e,t,i,n,a,r){i.modelBO={},i.ok=function(){t.showLoading(),r.createModel(a,i.modelBO).then(function(e){n.close(e),i.$apply(),t.hideLoading()},function(){t.hideLoading()})},i.cancel=function(){n.dismiss("cancel")}}]),angular.module("StarterPack.Portal.AppManager.ModelManager").controller("ModelInfoController",["$scope","$rootScope","$state","AppUtils","AppConfig","FirmwareService","$uibModal",function(e,t,i,n,a,r,o){e.modelInfo={selectedNamespace:{}},e.init=function(){e.schemaOnEdit={},e.$watch("modelsReady",function(t){t&&(e.initModel(),e.loadSchema(),e.loadFirmwares())})},e.loadSchema=function(){n.doLoading(),e.myModel.refreshPortalSchemas().then(function(){e.mySchemas=e.myModel.getPortalSchemas(),e.$apply(),n.whenLoaded()},function(){n.whenLoaded()})},e.loadFirmwares=function(){n.doLoading(),e.myApp.refreshFirmwareNamespaces().then(function(){n.whenLoaded(),e.firmwareNamespaces=e.myApp.getFirmwareNamespaces(),e.modelInfo.selectedNamespace=_.find(e.firmwareNamespaces,function(t){return t.getName()==e.myModel.getFirmwareNamespace()}),e.modelInfo.selectedNamespace&&e.initModelFirmwarenamespace(e.myModel,e.modelInfo.selectedNamespace),e.$apply()},function(){n.whenLoaded()})},e.initModelFirmwarenamespace=function(t,i){n.doLoading(),i.refreshFirmwares().then(function(){e.firmwares=i.getFirmwares(),e.initFirmwares(t.getFirmwares(),e.firmwares),e.$apply(),n.whenLoaded()},function(){n.whenLoaded()})},e.initFirmwares=function(e,t){_.each(t,function(t){var i=_.find(e,function(e){return t.getUUID()==e});t._selected=i?!0:!1})},e.initModel=function(){e.myModel=_.find(e.myModels,function(e){return e.getUUID()==i.params.modelId}),e.modelInfo.modelName=e.myModel.getName(),e.modelInfo.imageUrl=e.myModel.getImageUrl(),n.setLocalStorageItem(a.NavNames.MODEL_NAME,e.myModel.getName()),$("#modelImage").unbind("change"),$("#modelImage").change(e.uploadImage)},e.updateModel=function(t){e.myModel.setName(t.modelName),e.myModel.setFirmwareNamespace(t.selectedNamespace.getName()||""),e.myModel.getFirmwareNamespace!=t.selectedNamespace.getName()&&e.myModel.setFirmwares([]);var i=t.selectedNamespace;n.doLoading(),e.myModel.save().then(function(){e.initModelFirmwarenamespace(e.myModel,i),n.whenLoaded(),e.initModel(),e.$apply()},function(){n.whenLoaded()})},e.uploadImage=function(){n.doLoading(),e.myModel.uploadImage($("#modelImage")[0].files[0]).then(function(){e.initModel(),e.$apply(),n.whenLoaded()},function(){n.whenLoaded()})},e.addFirmware=function(t){n.doLoading(),e.myModel.addFirmware(t).then(function(){n.whenLoaded(),e.initFirmwares(e.myModel.getFirmwares(),e.firmwares),e.$apply()},function(e){console.log(e),n.whenLoaded()})},e.removeFirmware=function(t){n.doLoading(),e.myModel.deleteFirmware(t).then(function(){n.whenLoaded(),e.initFirmwares(e.myModel.getFirmwares(),e.firmwares),e.$apply()},function(){n.whenLoaded()})},e.openCreatePropertyModal=function(e){var t=o.open({animation:!0,templateUrl:"app.Portal.AppManager.ApplicationEditor.ModelManager.CreatSchemaProperty",resolve:{schema:function(){return e}},controller:"ModelInfoController.createSchemaProperty",size:"md"});t.result.then(function(){},function(){})},e.saveSchema=function(t){n.doLoading(),t.save().then(function(t){e.$apply(),n.whenLoaded(),console.log(t)},function(){n.whenLoaded()})},e.createSchema=function(){var t=e.myModel.createSchema();e.mySchemas.push(t)}}]).controller("ModelInfoController.createSchemaProperty",["$scope","schema","$uibModalInstance","AppConfig",function(e,t,i,n){e.propertyBO={key:null,displayName:null,type:n.Schema_Type_Enum.BOOLEAN,controllable:null,unit:null,min:null,max:null},e.schemaTypes=[],e.schemaTypeEnum=n.Schema_Type_Enum,_.each(n.Schema_Type_Enum,function(t,i){e.schemaTypes.push({text:i,value:t})}),e.ok=function(){var n=t.createProperty();_.extend(n,e.propertyBO),i.close(n)},e.cancel=function(){i.dismiss("cancel")}}]),angular.module("StarterPack.Portal.AppManager.FirmwareManager",[]),angular.module("StarterPack.Portal.AppManager.FirmwareManager").controller("FirmwareNamespaceInfoController",["$scope","$rootScope","$state","AppUtils","AppConfig","$uibModal",function(e,t,i,n,a,r){function o(t){e.unpublishedFirmwares=_.where(t,{_state:KiiPortalFirmware.StateEnum.CREATED}),e.publishedFirmwares=_.filter(t,function(e){return e.getState()==KiiPortalFirmware.StateEnum.PUBLISHED||e.getState()==KiiPortalFirmware.StateEnum.DISABLED}),e.pushedFirmwares=_.where(t,{_state:KiiPortalFirmware.StateEnum.PUSHED})}e.myFirmwareNamespace={},e.unpublishedFirmwares=[],e.publishedFirmwares=[],e.pushedFirmwares=[],e.init=function(){e.$watch("firmwareNamespacesReady",function(t){t&&(e.myFirmwareNamespace=_.find(e.myFirmwareNamespaces,function(e){return e.getUUID()==i.params.firmwareNamespaceId}),n.doLoading(),e.myFirmwareNamespace.refreshFirmwares().then(function(){var t=e.myFirmwareNamespace.getFirmwares();o(t),e.$apply(),n.whenLoaded()},function(){n.whenLoaded()}),n.setLocalStorageItem(a.NavNames.FIRMWARE_NAMESPACE_NAME,e.myFirmwareNamespace.getName()))})},e.publishFirmware=function(t){n.confirm("Publish Firmware","Are you sure to PUBLISH this firmware ["+t.getName()+"]?",function(){n.doLoading(),t.publish().then(function(){o(e.myFirmwareNamespace.getFirmwares()),e.$apply(),n.whenLoaded()},function(){n.whenLoaded()})})},e.disableFirmware=function(t){n.confirm("Publish Firmware","Are you sure to DISABLE this firmware ["+t.getName()+"]?",function(){n.doLoading(),t.disable().then(function(){o(e.myFirmwareNamespace.getFirmwares()),e.$apply(),n.whenLoaded()},function(){n.whenLoaded()})})},e.enableFirmware=function(t){n.confirm("Publish Firmware","Are you sure to ENABLE this firmware ["+t.getName()+"]?",function(){n.doLoading(),t.publish().then(function(){o(e.myFirmwareNamespace.getFirmwares()),e.$apply(),n.whenLoaded()},function(){n.whenLoaded()})})},e.pushFirmware=function(t){n.confirm("Publish Firmware","Are you sure to push this firmware ["+t.getName()+"]? This process cannot be stopped or reverted. This firmware version will be visible FOREVER!",function(){n.doLoading(),t.push().then(function(){o(e.myFirmwareNamespace.getFirmwares()),e.$apply(),n.whenLoaded()},function(){n.whenLoaded()})})},e.removeFirmware=function(t){n.confirm("Delete Firmware","Are you sure to delete this firmware ["+t.getName()+"]?",function(){n.doLoading(),t.delete().then(function(){o(e.myFirmwareNamespace.getFirmwares()),e.$apply(),n.whenLoaded()},function(){n.whenLoaded()})})},e.openFirmwareCreationModal=function(){var t=r.open({animation:!0,templateUrl:"app.Portal.AppManager.ApplicationEditor.FirmwareManager.FirmwareCreateModal",resolve:{firmwareNamespace:e.myFirmwareNamespace},controller:"FirmwareNamespaceInfoController.CreateModal",size:"md"});t.result.then(function(){e.myFirmwares=e.myFirmwareNamespace.getFirmwares(),o(e.myFirmwares)},function(){})},e.openFirmwareEditorModal=function(t){var i=r.open({animation:!0,templateUrl:"app.Portal.AppManager.ApplicationEditor.FirmwareManager.FirmwareEditorModal",resolve:{firmware:t},controller:"FirmwareNamespaceInfoController.EditorModal",size:"md"});i.result.then(function(){e.myFirmwares=e.myFirmwareNamespace.getFirmwares()},function(){})}}]).controller("FirmwareNamespaceInfoController.CreateModal",["ApplicationService","AppUtils","$scope","$uibModalInstance","firmwareNamespace","FirmwareService",function(e,t,i,n,a,r){i.firmwareBO={},i.ok=function(){t.showLoading(),r.createFirmware(a,i.firmwareBO).then(function(e){n.close(e),i.$apply(),t.hideLoading()},function(){t.hideLoading()})},i.cancel=function(){n.dismiss("cancel")}}]).controller("FirmwareNamespaceInfoController.EditorModal",["ApplicationService","AppUtils","$scope","$uibModalInstance","firmware","FirmwareService",function(e,t,i,n,a,r){i.firmwareBO={},i.firmware=a,i.firmwareBO.firmwareName=a.getName(),i.firmwareBO.description=a.getDescription(),i.uploadFirmwareFile=function(){t.showLoading(),r.uploadFirmwareFile(a,$("#firmwareFile")[0].files[0]).then(function(){i.$apply(),t.hideLoading()},function(){t.hideLoading()})},i.ok=function(){t.showLoading(),r.saveFirmware(a,i.firmwareBO).then(function(e){n.close(e),i.$apply(),t.hideLoading()},function(){t.hideLoading()})},i.cancel=function(){n.dismiss("cancel")}}]),angular.module("StarterPack.Portal.AppManager.FirmwareManager").controller("FirmwareNamespaceListController",["$scope","$rootScope","$state","AppUtils","$uibModal",function(e,t,i,n,a){e.viewFirmwareNamespace=function(e){i.go("app.Portal.AppManager.ApplicationEditor.FirmwareManager.FirmwareNamespaceInfo",{firmwareNamespaceId:e.getUUID()})},e.openCreateModal=function(){var t=a.open({animation:!0,templateUrl:"app.Portal.AppManager.ApplicationEditor.FirmwareManager.CreateModal",resolve:{app:e.myApp},controller:"FirmwareNamespaceListController.CreateModel",size:"md"});t.result.then(function(){e.myFirmwareNamespaces=e.myApp.getFirmwareNamespaces()},function(){})}}]).controller("FirmwareNamespaceListController.CreateModel",["ApplicationService","AppUtils","$scope","$uibModalInstance","app","FirmwareService",function(e,t,i,n,a,r){i.firmwareNamespaceBO={},i.ok=function(){t.showLoading(),r.createFirmwareNamespace(a,i.firmwareNamespaceBO).then(function(e){n.close(e),i.$apply(),t.hideLoading()},function(){t.hideLoading()})},i.cancel=function(){n.dismiss("cancel")}}]),angular.module("StarterPack.Portal.AppManager.VirtualDevice",[]),angular.module("StarterPack.Portal.AppManager.VirtualDevice").controller("VirtualDeviceController",["$scope","$rootScope","$state","AppUtils",function(){}]),angular.module("StarterPack.Portal.AppManager.UserManager",[]).constant("country",[{code:"AF",name:"Afghanistan"},{code:"AX",name:"Aland Islands"},{code:"AL",name:"Albania"},{code:"DZ",name:"Algeria"},{code:"AS",name:"American Samoa"},{code:"AD",name:"Andorra"},{code:"AO",name:"Angola"},{code:"AI",name:"Anguilla"},{code:"AQ",name:"Antarctica"},{code:"AG",name:"Antigua And Barbuda"},{code:"AR",name:"Argentina"},{code:"AM",name:"Armenia"},{code:"AW",name:"Aruba"},{code:"AU",name:"Australia"},{code:"AT",name:"Austria"},{code:"AZ",name:"Azerbaijan"},{code:"BS",name:"Bahamas"},{code:"BH",name:"Bahrain"},{code:"BD",name:"Bangladesh"},{code:"BB",name:"Barbados"},{code:"BY",name:"Belarus"},{code:"BE",name:"Belgium"},{code:"BZ",name:"Belize"},{code:"BJ",name:"Benin"},{code:"BM",name:"Bermuda"},{code:"BT",name:"Bhutan"},{code:"BO",name:"Bolivia, Plurinational State of"},{code:"BA",name:"Bosnia And Herzegovina"},{code:"BW",name:"Botswana"},{code:"BV",name:"Bouvet Island"},{code:"BR",name:"Brazil"},{code:"IO",name:"British Indian Ocean Territory"},{code:"BN",name:"Brunei Darussalam"},{code:"BG",name:"Bulgaria"},{code:"BF",name:"Burkina Faso"},{code:"BI",name:"Burundi"},{code:"KH",name:"Cambodia"},{code:"CM",name:"Cameroon"},{code:"CA",name:"Canada"},{code:"CV",name:"Cape Verde"},{code:"KY",name:"Cayman Islands"},{code:"CF",name:"Central African Republic"},{code:"TD",name:"Chad"},{code:"CL",name:"Chile"},{code:"CN",name:"China"},{code:"CX",name:"Christmas Island"},{code:"CC",name:"Cocos (Keeling) Islands"},{code:"CO",name:"Colombia"},{code:"KM",name:"Comoros"},{code:"CG",name:"Congo"},{code:"CD",name:"Congo, Democratic Republic"},{code:"CK",name:"Cook Islands"},{code:"CR",name:"Costa Rica"},{code:"CI",name:"Cote D'Ivoire"},{code:"HR",name:"Croatia"},{code:"CU",name:"Cuba"},{code:"CY",name:"Cyprus"},{code:"CZ",name:"Czech Republic"},{code:"DK",name:"Denmark"},{code:"DJ",name:"Djibouti"},{code:"DM",name:"Dominica"},{code:"DO",name:"Dominican Republic"},{code:"EC",name:"Ecuador"},{code:"EG",name:"Egypt"},{code:"SV",name:"El Salvador"},{code:"GQ",name:"Equatorial Guinea"},{code:"ER",name:"Eritrea"},{code:"EE",name:"Estonia"},{code:"ET",name:"Ethiopia"},{code:"FK",name:"Falkland Islands (Malvinas)"},{code:"FO",name:"Faroe Islands"},{code:"FJ",name:"Fiji"},{code:"FI",name:"Finland"},{code:"FR",name:"France"},{code:"GF",name:"French Guiana"},{code:"PF",name:"French Polynesia"},{code:"TF",name:"French Southern Territories"},{code:"GA",name:"Gabon"},{code:"GM",name:"Gambia"},{code:"GE",name:"Georgia"},{code:"DE",name:"Germany"},{code:"GH",name:"Ghana"},{code:"GI",name:"Gibraltar"},{code:"GR",name:"Greece"},{code:"GL",name:"Greenland"},{code:"GD",name:"Grenada"},{code:"GP",name:"Guadeloupe"},{code:"GU",name:"Guam"},{code:"GT",name:"Guatemala"},{code:"GG",name:"Guernsey"},{code:"GN",name:"Guinea"},{code:"GW",name:"Guinea-Bissau"},{code:"GY",name:"Guyana"},{code:"HT",name:"Haiti"},{code:"HM",name:"Heard Island &amp; Mcdonald Islands"},{code:"VA",name:"Holy See"},{code:"HN",name:"Honduras"},{code:"HK",name:"Hong Kong"},{code:"HU",name:"Hungary"},{code:"IS",name:"Iceland"},{code:"IN",name:"India"},{code:"ID",name:"Indonesia"},{code:"IR",name:"Iran, Islamic Republic Of"},{code:"IQ",name:"Iraq"},{code:"IE",name:"Ireland"},{code:"IM",name:"Isle Of Man"},{code:"IL",name:"Israel"},{code:"IT",name:"Italy"},{code:"JM",name:"Jamaica"},{code:"JP",name:"Japan"},{code:"JE",name:"Jersey"},{code:"JO",name:"Jordan"},{code:"KZ",name:"Kazakhstan"},{code:"KE",name:"Kenya"},{code:"KI",name:"Kiribati"},{code:"KR",name:"Korea"},{code:"KW",name:"Kuwait"},{code:"KG",name:"Kyrgyzstan"},{code:"LA",name:"Lao People's Democratic Republic"},{code:"LV",name:"Latvia"},{code:"LB",name:"Lebanon"},{code:"LS",name:"Lesotho"},{code:"LR",name:"Liberia"},{code:"LY",name:"Libya"},{code:"LI",name:"Liechtenstein"},{code:"LT",name:"Lithuania"},{code:"LU",name:"Luxembourg"},{code:"MO",name:"Macao"},{code:"MK",name:"Macedonia"},{code:"MG",name:"Madagascar"},{code:"MW",name:"Malawi"},{code:"MY",name:"Malaysia"},{code:"MV",name:"Maldives"},{code:"ML",name:"Mali"},{code:"MT",name:"Malta"},{code:"MH",name:"Marshall Islands"},{code:"MQ",name:"Martinique"},{code:"MR",name:"Mauritania"},{code:"MU",name:"Mauritius"},{code:"YT",name:"Mayotte"},{code:"MX",name:"Mexico"},{code:"FM",name:"Micronesia, Federated States Of"},{code:"MD",name:"Moldova, Republic of"},{code:"MC",name:"Monaco"},{code:"MN",name:"Mongolia"},{code:"ME",name:"Montenegro"},{code:"MS",name:"Montserrat"},{code:"MA",name:"Morocco"},{code:"MZ",name:"Mozambique"},{code:"MM",name:"Myanmar"},{code:"NA",name:"Namibia"},{code:"NR",name:"Nauru"},{code:"NP",name:"Nepal"},{code:"NL",name:"Netherlands"},{code:"AN",name:"Netherlands Antilles"},{code:"NC",name:"New Caledonia"},{code:"NZ",name:"New Zealand"},{code:"NI",name:"Nicaragua"},{code:"NE",name:"Niger"},{code:"NG",name:"Nigeria"},{code:"NU",name:"Niue"},{code:"NF",name:"Norfolk Island"},{code:"MP",name:"Northern Mariana Islands"},{code:"NO",name:"Norway"},{code:"OM",name:"Oman"},{code:"PK",name:"Pakistan"},{code:"PW",name:"Palau"},{code:"PS",name:"Palestine, State of"},{code:"PA",name:"Panama"},{code:"PG",name:"Papua New Guinea"},{code:"PY",name:"Paraguay"},{code:"PE",name:"Peru"},{code:"PH",name:"Philippines"},{code:"PN",name:"Pitcairn"},{code:"PL",name:"Poland"},{code:"PT",name:"Portugal"},{code:"PR",name:"Puerto Rico"},{code:"QA",name:"Qatar"},{code:"RE",name:"Reunion"},{code:"RO",name:"Romania"},{code:"RU",name:"Russian Federation"},{code:"RW",name:"Rwanda"},{code:"BL",name:"Saint Barthelemy"},{code:"SH",name:"Saint Helena, Ascension and Tristan da Cunha"},{code:"KN",name:"Saint Kitts And Nevis"},{code:"LC",name:"Saint Lucia"},{code:"MF",name:"Saint Martin"},{code:"PM",name:"Saint Pierre And Miquelon"},{code:"VC",name:"Saint Vincent And Grenadines"},{code:"WS",name:"Samoa"},{code:"SM",name:"San Marino"},{code:"ST",name:"Sao Tome And Principe"},{code:"SA",name:"Saudi Arabia"},{code:"SN",name:"Senegal"},{code:"RS",name:"Serbia"},{code:"SC",name:"Seychelles"},{code:"SL",name:"Sierra Leone"},{code:"SG",name:"Singapore"},{code:"SK",name:"Slovakia"},{code:"SI",name:"Slovenia"},{code:"SB",name:"Solomon Islands"},{code:"SO",name:"Somalia"},{code:"ZA",name:"South Africa"},{code:"GS",name:"South Georgia And Sandwich Isl."},{code:"ES",name:"Spain"},{code:"LK",name:"Sri Lanka"},{code:"SD",name:"Sudan"},{code:"SR",name:"Suriname"},{code:"SJ",name:"Svalbard And Jan Mayen"},{code:"SZ",name:"Swaziland"},{code:"SE",name:"Sweden"},{code:"CH",name:"Switzerland"},{code:"SY",name:"Syrian Arab Republic"},{code:"TW",name:"Taiwan"},{code:"TJ",name:"Tajikistan"},{code:"TZ",name:"Tanzania"},{code:"TH",name:"Thailand"},{code:"TL",name:"Timor-Leste"},{code:"TG",name:"Togo"},{code:"TK",name:"Tokelau"},{code:"TO",name:"Tonga"},{code:"TT",name:"Trinidad And Tobago"},{code:"TN",name:"Tunisia"},{code:"TR",name:"Turkey"},{code:"TM",name:"Turkmenistan"},{code:"TC",name:"Turks And Caicos Islands"},{code:"TV",name:"Tuvalu"},{code:"UG",name:"Uganda"},{code:"UA",name:"Ukraine"},{code:"AE",name:"United Arab Emirates"},{code:"GB",name:"United Kingdom"},{code:"US",name:"United States"},{code:"UM",name:"United States Outlying Islands"},{code:"UY",name:"Uruguay"},{code:"UZ",name:"Uzbekistan"},{code:"VU",name:"Vanuatu"},{code:"VE",name:"Venezuela, Bolivarian Republic of"},{code:"VN",name:"Viet Nam"},{code:"VG",name:"Virgin Islands, British"},{code:"VI",name:"Virgin Islands, U.S."},{code:"WF",name:"Wallis And Futuna"},{code:"EH",name:"Western Sahara"},{code:"YE",name:"Yemen"},{code:"ZM",name:"Zambia"},{code:"ZW",name:"Zimbabwe"}]),angular.module("StarterPack.Portal.AppManager.UserManager").factory("userValidateService",[function(){var e=function(){this.isEmpty=!1,this.loginError=!1,this.passwordError=!1,this.emailError=!1,this.phoneError=!1
};return e.prototype.isPass=function(){return!(this.isEmpty||this.loginError||this.passwordError||this.emailError||this.phoneError)},{validateEmpty:function(e){return KiiPortalUtilities._trim(e.loginName)&&KiiPortalUtilities._trim(e.emailAddress)&&KiiPortalUtilities._trim(e.phoneNumber)?!0:!1},validateLogin:function(e){return KiiPortalUtilities._validateUsername(e)},validatePassword:function(e){return KiiPortalUtilities._validatePassword(e)},validateEmail:function(e){return KiiPortalUtilities._validateEmail(e)},validatePhone:function(e){return KiiPortalUtilities._validatePhoneNumber(e)},validate:function(e){var t=this.validateUpdate(e);return t.passwordError=!this.validatePassword(e.password),t},validateUpdate:function(t){var i=new e;return i.isEmpty=!this.validateEmpty(t),i.loginError=!this.validateLogin(t.loginName),i.emailError=!this.validateEmail(t.emailAddress),i.phoneError=!this.validatePhone(t.phoneNumber),console.log(i),i}}}]),angular.module("StarterPack.Portal.AppManager.UserManager").filter("dateOnly",["$filter",function(e){return function(){var t=e("date");return function(e){return t(e,"yyyy-MM-dd")}}}]).filter("country",["country",function(e){return function(t){var i=_.findWhere(e,{code:t});return i?i.name:""}}]),angular.module("StarterPack.Portal.AppManager.UserManager").directive("validateMessage",["$timeout",function(){return{restrict:"EA",replace:!0,templateUrl:"app/components/Portal/AppManager/ApplicationEditor/UserManager/UserManager.template.html",scope:{status:"="},link:function(){}}}]),angular.module("StarterPack.Portal.AppManager.UserManager").controller("UserManagerController",["$scope","$rootScope","$state","$filter","$document","AppUtils","country","userValidateService",function(e,t,i,n,a,r,o,s){function c(e,t){console.log(e),r.whenLoaded(),t&&"function"==typeof t&&t()}function l(){e.message={}}function u(t,i){var n={limit:200};angular.extend(n,t),r.doLoading(),e.myApp.getUserList({},null,n).then(function(t){e.query=t.query,e.users=i?e.users.concat(t.users):t.users,e.$apply(),r.whenLoaded()},c)}function p(){this.loginName="",this.password="",this.displayName="",this.emailAddress="",this.phoneNumber="",this.country=""}var d={Created:1,Updated:2,Suspend:3,Activated:4,SendEmail:5,SendSms:6,Deleted:7,ConfirmDelete:8,isSuspended:9};e.newUser=new p,e.message={},e.init=function(){l(),e.$watch("appReady",function(t){t&&(e.countryList=o,u())})},e.addUser=function(t){if(l(),t._status=s.validate(t),t._status.isPass()){r.doLoading(),delete t._status;var i=new KiiPortalUser(t);i.register().then(function(){e.cancelAddUser(),e.message={loginName:t.loginName,status:d.Created},e.$apply(),r.whenLoaded()},c)}},e.cancelAddUser=function(){l(),e.isExpanded=!1},e.cancelDelete=function(){l()},e.confirmDeleteUser=function(t,i){l(),a[0].body.scrollTop=0,e.message={loginName:t._info.loginName,user:t,index:i,status:d.ConfirmDelete}},e.deleteUser=function(){var t=angular.copy(e.message.user),i=e.message.index;l(),r.doLoading(),t.delete().then(function(){e.message={loginName:t._info.loginName,status:d.Deleted},e.users[i].getID()===t.getID()&&e.users.splice(i,1),e.$apply(),r.whenLoaded()},c)},e.getCustomAttributes=function(e){var t=["userID","internalUserID","loginName","displayName","country","emailAddress","emailAddressVerified","phoneNumber","phoneNumberVerified","disabled","createdAt","modifiedAt","passwordChangedAt","_disabled","_hasPassword"];e._field.customAttributes=_.omit(e._info,t)},e.getGroupData=function(t){r.doLoading(),t._field.group={},t.ownerOfGroups().then(function(i){t._field.group.owner=i.data.groups,e.$apply(),r.whenLoaded()},c),t.memberOfGroups().then(function(i){t._field.group.member=i.data.groups,e.$apply(),r.whenLoaded()},c)},e.loadMore=function(e){l();var t={limit:5,paginationKey:e._paginationKey};u(t,!0)},e.expandAddUser=function(){e.isExpanded!==!0&&(e.isExpanded=!0,e.newUser=new p,l())},e.resetUserPassword=function(t,i){l(),r.doLoading(),t.resetPassword(i).then(function(){e.message="SMS"===i?{loginName:t._info.loginName,status:d.SendSms}:{loginName:t._info.loginName,status:d.SendEmail},e.$apply(),r.whenLoaded()},function(i){c(i,function(){i=angular.fromJson(i),"USER_DISABLED"===i.errorCode&&(e.message={loginName:t._info.loginName,status:d.isSuspended},e.$apply())})})},e.toggleEdit=function(t,i){i!==!1&&l(),t._onEdit?(delete t._field,delete t._status):(t._field=angular.copy(t._info),e.getCustomAttributes(t)),t._onEdit=!t._onEdit},e.toggleUserStatus=function(t){l();var i={disabled:!t._info._disabled};r.doLoading(),t.toggleUserStatus(i).then(function(){t._info._disabled=!t._info._disabled,e.message={loginName:t._info.loginName,status:t._info._disabled?d.Suspend:d.Activated},e.toggleEdit(t,!1),e.$apply(),r.whenLoaded()},c)},e.updateUser=function(t){if(l(),t._status=s.validateUpdate(t._field),t._status.isPass()){var i={};for(var n in e.newUser)t._info[n]!==t._field[n]&&(i[n]=t._field[n]);_.extend(i,t._field.customAttributes),r.doLoading(),t.update(i).then(function(){e.myApp.findUserByUserID(t.getID()).then(function(i){t._info=i._info,e.message={loginName:t._info.loginName,status:d.Updated},e.toggleEdit(t,!1),e.$apply(),r.whenLoaded()},c)},c)}}}]),angular.module("StarterPack.Portal.AppManager.UserGroupManager",[]),angular.module("StarterPack.Portal.AppManager.UserGroupManager").controller("UserGroupManagerController",["$scope","$rootScope","$state","AppUtils",function(){}]),angular.module("StarterPack.Portal.AppManager.Settings",[]),angular.module("StarterPack.Portal.AppManager.Settings").controller("SettingsController",["$scope","$rootScope","$state","AppUtils",function(){}]),angular.module("StarterPack.Portal.AppManager.Observation").controller("ObservationController",["$scope","$rootScope","$state","AppUtils",function(e,t,i,n){e.init=function(){e.$watch("appReady",function(t){t&&(n.doLoading(),e.myApp.refreshTags(function(){n.whenloaded(),e.tags=e.myApp.getTags(),e.displayedTags=_.filter(e.tags,function(e){var t=e.getCustomData();return t&&t.displayed})},function(){}))}),activateJsonEditor()}}]),angular.module("StarterPack.Portal.AppManager.ModelManager").factory("ModelService",[function(){var e={};return e.createModel=function(e,t){var i=e.createModel();return i.setName(t.modelName),i.save()},e}]),angular.module("StarterPack.Portal.AppManager.ModelManager").controller("ModelManagerController",["$scope","$rootScope","$state","AppUtils","AppConfig",function(e,t,i,n,a){e.modelsReady=!1,e.init=function(){n.doLoading(),e.myApp.refreshModels().then(function(){if(n.whenLoaded(),e.myModels=e.myApp.getModels(),i.params.modelId){var t=_.find(e.myModels,function(e){return e.getUUID()==i.params.modelId});n.setLocalStorageItem(a.NavNames.MODEL_NAME,t.getName())}e.modelsReady=!0,e.$apply()},function(){n.whenLoaded()})},e.$watch("appReady",function(t){t&&e.init()})}]),angular.module("StarterPack.Portal.AppManager.FirmwareManager").factory("FirmwareService",[function(){var e={};return e.createFirmwareNamespace=function(e,t){var i=e.createFirmwareNamespace();return i.setName(t.firmwareNamespaceName),i.save()},e.createFirmware=function(e,t){var i=e.createFirmware();return i.setName(t.firmwareName),i.setDescription(t.description),i.save()},e.saveFirmware=function(e,t){return e.setName(t.firmwareName),e.setDescription(t.description),e.save()},e.uploadFirmwareFile=function(e,t){return e.uploadFirmwareFile(t)},e}]),angular.module("StarterPack.Portal.AppManager.FirmwareManager").controller("FirmwareManagerController",["$scope","$rootScope","$state","AppUtils","AppConfig",function(e,t,i,n,a){e.firmwareNamespacesReady=!1,e.init=function(){e.$watch("appReady",function(t){t&&(n.doLoading(),e.myApp.refreshFirmwareNamespaces().then(function(){if(n.whenLoaded(),e.myFirmwareNamespaces=e.myApp.getFirmwareNamespaces(),i.params.firmwareNamespaceId){var t=_.find(e.myFirmwareNamespaces,function(e){return e.getUUID()==i.params.firmwareNamespaceId});n.setLocalStorageItem(a.NavNames.FIRMWARE_NAMESPACE_NAME,t.getName())}e.firmwareNamespacesReady=!0,e.$apply()},function(){n.whenLoaded()}))})}}]),angular.module("StarterPack.Portal.AppManager.DeviceManager",[]),angular.module("StarterPack.Portal.AppManager.DeviceManager").factory("DeviceService",[function(){var e={};return e.getCustomFields=function(e){var t=["_globalThingID","_vendorThingID","_vendor","_disabled","_created","_lot","_productName","_thingID","_firmwareVersion","_thingType","_stringField1","_numberField1","_stringField2","_numberField2","_stringField3","_numberField3","_stringField4","_numberField4","_stringField5","_numberField5","_accessToken","fields","_onEdit","customFieldEditor","$$hashKey"],i={};return _.each(e.fields,function(e,n){-1!=t.indexOf(n)||_.isFunction(e)||(i[n]=e)}),i},e}]),angular.module("StarterPack.Portal.AppManager.DeviceManager").controller("DeviceManagerController",["$scope","$rootScope","$state","AppUtils","$timeout","DeviceService","AppConfig",function(e,t,i,n,a,r,o){function s(){a(function(){var e={mode:"code"};c=$("#new-device").find(".json-editor")[0],c=new JSONEditor(c,e)})}e.myDevices=[],e.deviceEdit={},e.collapseIndex=-1,e.hideNewDevice=!0,e.newDevice={},e.searchParam={};var c=null;e.searchOptions=[{type:"string",text:"_vendorThingID",value:"_vendorThingID"},{type:"string",text:"_thingID",value:"_thingID"},{type:"boolean",text:"_disabled",value:"_disabled"},{type:"string",text:"_vendor",value:"_vendor"},{type:"boolean",text:"_created",value:"_created"},{type:"string",text:"_lot",value:"_lot"},{type:"string",text:"_productName",value:"_lot"},{type:"string",text:"_firmwareVersion",value:"_firmwareVersion"},{type:"string",text:"_stringField1",value:"_stringField1"},{type:"float",text:"_numberField1",value:"_numberField1"},{type:"string",text:"_stringField2",value:"_stringField2"},{type:"float",text:"_numberField2",value:"_numberField2"},{type:"string",text:"_stringField3",value:"_stringField3"},{type:"float",text:"_numberField3",value:"_numberField3"},{type:"string",text:"_stringField4",value:"_stringField4"},{type:"float",text:"_numberField4",value:"_numberField4"},{type:"string",text:"_stringField5",value:"_stringField5"},{type:"float",text:"_numberField5",value:"_numberField5"}],e.searchDevices=function(t){var i=[],a=KiiClause.and();if(t){var r=t.field,s=t.value;if(r&&s){var c=KiiClause.equals(r,s);i=[c]}}i.push(KiiClause.notEquals("_stringField5",o.VIRTUAL_DEVICE)),a._setWhereClauses(i),n.doLoading(),e.myApp.queryThings({},a,{limit:5}).then(function(t){e.myDevices=t.things,e.nextQuery=t.query,e.$apply(),n.whenLoaded()},function(){n.whenLoaded()})},e.init=function(){e.$watch("appReady",function(t){t&&e.searchDevices()}),s()},e.addDevice=function(){e.newDevice=new KiiThingAdmin({}),e.hideNewDevice=!1},e.saveDevice=function(t){var i=_.clone(t);e.customFields=c.get(),_.extend(t.fields,e.customFields),n.doLoading(),KiiThingAdmin.prototype.save.apply(i).then(function(){n.whenLoaded(),e.myDevices=e.myApp.getThings(),e.hideNewDevice=!0,e.$apply()},function(t){n.whenLoaded(),console.log(t),e.hideNewDevice=!0,e.$apply()})},e.cancelNewDevice=function(){e.newDevice={},e.hideNewDevice=!0},e.loadMore=function(){n.doLoading(),e.myApp.nextThings(null,e.nextQuery).then(function(t){e.nextQuery=t.query;t.things;e.myDevices=e.myApp.getThings(),e.$apply(),n.whenLoaded()},function(){n.whenLoaded()})}}]).directive("deviceDetail",["AppUtils","$timeout","DeviceService",function(e,t,i){return{scope:{device:"=?",isCollapse:"=?"},replace:!0,restrict:"E",templateUrl:"app/components/Portal/AppManager/ApplicationEditor/DeviceManager/DeviceDetailContent.template.html",link:function(n,a){function r(){t(function(){var e={mode:"code"};o=$(a).find(".json-editor")[0],o=new JSONEditor(o,e),o.set(n.customFields)})}var o=null;n.init=function(){void 0===n.isCollapse&&(n.isCollapse=!0),n.customFields=i.getCustomFields(n.device),r(n.device)},n.saveDevice=function(t){var i=_.clone(t);n.customFields=o.get(),_.extend(t.fields,n.customFields),e.doLoading(),KiiThingAdmin.prototype.save.apply(i).then(function(t){console.log(t),e.whenLoaded()},function(t){e.whenLoaded(),console.log(t)})},n.init()}}}]),angular.module("StarterPack.Portal.AppManager.DataAnalysis",[]),angular.module("StarterPack.Portal.AppManager.DataAnalysis").controller("DataAnalysisController",["$scope","$rootScope","$state","AppUtils",function(){}]),angular.module("StarterPack.Portal.AppManager.Dashboard",[]),angular.module("StarterPack.Portal.AppManager.Dashboard").controller("DashboardController",["$scope","$rootScope","$state","AppUtils","$http",function(){}]),angular.module("StarterPack.Portal.AppManager",["StarterPack.AppShared","StarterPack.Portal.AppManager.Dashboard","StarterPack.Portal.AppManager.DataAnalysis","StarterPack.Portal.AppManager.DeviceManager","StarterPack.Portal.AppManager.FirmwareManager","StarterPack.Portal.AppManager.ModelManager","StarterPack.Portal.AppManager.Settings","StarterPack.Portal.AppManager.UserGroupManager","StarterPack.Portal.AppManager.UserManager","StarterPack.Portal.AppManager.VirtualDevice","StarterPack.Portal.AppManager.Observation"]),angular.module("StarterPack.Portal.AppManager").controller("ApplicationInfoController",["$scope","$rootScope","$state","AppUtils","AppManagerService",function(e,t,i,n,a){t.portalNavs=a.portalNavs}]),angular.module("StarterPack.Portal.AppManager").factory("ApplicationService",["$rootScope",function(e){var t={};return t.getApps=function(){return e.portalAdmin.refreshApps()},t.createApp=function(t){var i=e.portalAdmin.createApp();return i.setAppName(t.appName),i.setServer(t.server),i.setPlatforms(t.platforms),i.save()},t}]),angular.module("StarterPack.Portal.AppManager").controller("ApplicationListController",["$scope","$rootScope","$state","AppUtils","ApplicationService","$uibModal",function(e,t,i,n,a,r){t.portalNavs=[],e.viewApp=function(e){i.go("app.Portal.AppManager.ApplicationEditor.ApplicationInfo",{appId:e.getAppID()})},e.openCreateModal=function(){var t=r.open({animation:!0,templateUrl:"app.Portal.AppManager.ApplcationList.CreateModal",controller:"ApplicationListController.CreateApplication",size:"md"});t.result.then(function(){e.myApps=e.portalAdmin.getApps()},function(){})}}]).controller("ApplicationListController.CreateApplication",["ApplicationService","AppUtils","$scope","$uibModalInstance",function(e,t,i,n){i.appBO={},i.serverOptions=[{text:"Japan",value:"jp"},{text:"China",value:"cn3"},{text:"America",value:"us"},{text:"QA",value:"qa"},{text:"Dev",value:"devjp"}],i.platforms=[{text:"Android",value:"android"},{text:"iOS",value:"ios"},{text:"HTML 5",value:"html5"}],i.ok=function(){t.showLoading(),i.appBO.platforms=_.pluck(_.where(i.platforms,{_checked:!0}),"value"),e.createApp(i.appBO).then(function(e){n.close(e),i.$apply(),t.hideLoading()},function(){t.hideLoading()})},i.cancel=function(){n.dismiss("cancel")}}]),angular.module("StarterPack.Portal.AppManager").controller("ApplicationEditorController",["$scope","$rootScope","$state","AppUtils","AppManagerService","localStorageService","AppConfig",function(e,t,i,n,a,r,o){t.portalNavs=a.portalNavs,e.appReady=!1,e.init=function(){e.$watch("appsReady",function(a){a&&(e.myApp=_.find(e.myApps,function(e){return e.getAppID()==i.params.appId}),console.log(e.myApp),n.doLoading(),t.portalAdmin.useApp(e.myApp).then(function(){window.myApp=e.myApp,e.appReady=!0,r.set(o.NavNames.APP_NAME,e.myApp.getAppName()),e.turnOffMenu(),e.$apply(),n.whenLoaded()},function(){console("timeout!"),n.whenLoaded()}))})}}]),angular.module("StarterPack.AppShared",["ngAnimate","ngCookies","ngSanitize","ui.bootstrap","LocalStorageModule","awesome-context-menu","smart-table"]).constant("AppConfig",{StoragePrefix:"SSP",Tags:{APP:"APP",FIRMWARE:"FIRMWARE",MODEL:"MODEL"},USER_SESSION:"USER_SESSION",NavNames:{APP_NAME:"APP_NAME",FIRMWARE_NAME:"FIRMWARE_NAME",MODEL_NAME:"MODEL_NAME",FIRMWARE_NAMESPACE_NAME:"FIRMWARE_NAMESPACE_NAME"},VIRTUAL_DEVICE:"VIRTUAL_DEVICE",Schema_Type_Enum:KiiPortalSchemaProperty.Schema_Type_Enum}).config(["localStorageServiceProvider","AppConfig",function(e,t){e.setPrefix(t.StoragePrefix).setStorageType("localStorage").setStorageCookie(30,"/").setNotify(!0,!0)}]),angular.module("StarterPack.AppShared").directive("textLimit",["$timeout",function(){return{restrict:"E",templateUrl:"app/components/AppShared/directives/text-limit/text-limit.template.html",replace:!0,scope:{max:"=?",ngModel:"=?"},link:function(e,t,i){e.type=i.type}}}]),angular.module("StarterPack.AppShared").directive("switchery",["$timeout",function(){return{restrict:"E",scope:{ngModel:"=?",reverse:"=?"},templateUrl:"app/components/AppShared/directives/switchery/switchery.template.html",replace:!0,link:function(e,t,i){e.on=e.on,e.yesText=i.yesText||"",e.noText=i.noText||"",e.switch=function(){e.on=!e.on}}}}]),angular.module("StarterPack.AppShared").directive("inputOptions",["$compile","$timeout",function(e,t){return{restrict:"A",replace:!1,scope:{ngModel:"=?",inputOptions:"=?"},link:function(i,n){function a(){var e=$(n).parent().offset(),t=$(n).offset(),i=t.top-e.top+$(n).height(),a=t.left-e.left;u.css({left:a,top:i})}function r(){var e=$(n).outerWidth();u.find("ul").css({width:e})}function o(){i.open=!0,u.find("ul").show(),r()}function s(){i.open=!1}function c(){i.options=_.filter(i.inputOptions,l)}function l(e){return e&&e.indexOf(i.ngModel||"")>-1}var u="";u+='<div class="input-options" ng-show="open">',u+='  <ul class="dropdown-menu" role="menu">',u+='    <li ng-repeat="option in options" role="menuitem" ng-click="selectOption(option)"><a>{{option}}</a></li>',u+="  </ul>",u+="</div>",u=e(u)(i),u=$(u).insertAfter(n),i.open=!1,i.focused=!0,i.options=[],$(n).parent().css("position","relative"),i.$watch("ngModel",function(){c(),i.focused&&(0==i.options.length?s():o())}),$(n).on("focus",function(){c(),a(),i.focused=!0;var e=i.options.length>0?!0:!1;e?o():s(),i.$apply()}),$(n).on("blur",function(){i.focused=!1,t(s,100),i.$apply()}),i.selectOption=function(e){i.ngModel=e}}}}]),angular.module("StarterPack.AppShared").directive("appSelect",["$timeout",function(e){return{restrict:"E",templateUrl:"app/components/AppShared/directives/app-select/app-select.template.html",replace:!0,scope:{options:"=",selectedModel:"=",extraSetting:"=?",change:"=?",disabled:"=?"},link:function(t,i,n){function a(){var e=!1;e=n.valueOnly?_.find(t.options,function(e){return e[t.setting.value]==t.selectedModel}):_.find(t.options,function(e){return angular.equals(e,t.selectedModel)}),t.selectOption(e?e:t.options[0])}t.setting={text:"text",value:"value"},t.myClass=n.class,t.setting=_.extend(t.setting,t.extraSetting),t.selectedOption={},t.$watch("selectedModel",function(e,t){angular.equals(e,t)||a()}),t.setting.text=n.text||t.setting.text,t.setting.value=n.value||t.setting.value,t.selectOption=function(i){t.selectedModel=n.valueOnly?i[t.setting.value]:_.clone(i),t.selectedOption=i,_.isFunction(t.change)&&e(function(){t.change(t.selectedModel)})},t.options&&t.options[0]&&a()}}}]),function(){var e="undefined"!=typeof exports&&null!==exports?new Object:window,t=Math.pow(2,53)-1;Object.keys||(Object.keys=function(){var e=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),i=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],n=i.length;return function(a){if("object"!=typeof a&&"function"!=typeof a||null===a)throw new TypeError("Object.keys called on non-object");var r=[];for(var o in a)e.call(a,o)&&r.push(o);if(t)for(var s=0;n>s;s++)e.call(a,i[s])&&r.push(i[s]);return r}}());var i,n,a,r,o,s,c,l,u,p,d,m,f,g,h,v,y,A,w;w=!{toString:null}.propertyIsEnumerable("toString"),A=Object.prototype.hasOwnProperty,v=function(e,t){return null!=e&&A.call(e,t)},f=Object.keys,p=function(e){var i=e.length;return"number"==typeof i&&i>=0&&t>=i},c=function(e,t,i){if(void 0===t)return e;switch(null==i?3:i){case 1:return function(i){return e.call(t,i)};case 2:return function(i,n){return e.call(t,i,n)};case 3:return function(i,n,a){return e.call(t,i,n,a)};case 4:return function(i,n,a,r){return e.call(t,i,n,a,r)}}return function(){return e.apply(t,arguments)}},l=function(e){if(null==e||"object"!=typeof e)return e;var t=new e.constructor;for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},i=function(e,t){return function(){return e.apply(t,arguments)}},g=function(e){if(!h(e))return[];if(f)return f(e);var t=[];for(var i in e)_.has(e,i)&&t.push(i);return hasEnumBug&&collectNonEnumProps(e,t),t},h=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},n=function(e,t){function i(){this.constructor=e}for(var n in t)A.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},o=function(e,t,i){t=c(t,i);var n,a;if(p(e))for(n=0,a=e.length;a>n;n++)t(e[n],n,e);else{var r=g(e);for(n=0,a=r.length;a>n;n++)t(e[r[n]],r[n],e)}return e},r=function(e){return"function"==typeof e},"undefined"==typeof Promise&&!function(e,t){function i(e,t){return(typeof t)[0]==e}function n(r,o){return o=function s(c,l,u,p,d,m){function f(e){return function(t){d&&(d=0,s(i,e,t))}}if(p=s.q,c!=i)return n(function(e,t){p.push({p:this,r:e,j:t,1:c,0:l})});if(u&&i(e,u)|i(t,u))try{d=u.then}catch(g){l=0,u=g}if(i(e,d))try{d.call(u,f(1),l=f(0))}catch(g){l(g)}else for(o=function(t,o){return i(e,t=l?t:o)?n(function(e,i){a(this,e,i,u,t)}):r},m=0;m<p.length;)d=p[m++],i(e,c=d[l])?a(d.p,d.r,d.j,u,c):(l?d.r:d.j)(u)},o.q=[],r.call(r={then:function(e,t){return o(e,t)},"catch":function(e){return o(0,e)}},function(e){o(i,1,e)},function(e){o(i,0,e)}),r}function a(n,a,r,o,s){setTimeout(function(){try{o=s(o),s=o&&i(t,o)|i(e,o)&&o.then,i(e,s)?o==n?r(TypeError()):s.call(o,a,r):a(o)}catch(c){r(c)}})}function r(e){return n(function(t){t(e)})}Promise=n,n.resolve=r,n.reject=function(e){return n(function(t,i){i(e)})},n.all=function(e){return n(function(t,i,n,a){a=[],n=e.length||t(a),e.map(function(e,o){r(e).then(function(e){a[o]=e,--n||t(a)},i)})})}}("f","o"),u=function(e){return"[object Array]"===toString.call(e)},s=function(e,t){o(e,function(i,n){i==t&&e.splice(n,1)})},a=function(e,t){o(t,function(t,i){r(t)||(e[i]=t)})},d=function(e,t){var n=Object.keys(t.prototype);o(n,function(i){e.prototype[i]=t.prototype[i]}),n=Object.keys(t),o(n,function(n){e[n]=t[n],r(e[n])&&(e[n]=i(e[n],e))})},y=function(){function e(e){o(e.constructor.prototype,function(n,a){-1==t.indexOf(a)&&r(n)&&(e[a]=i(n,e))})}var t=["valueOf","isPrototypeOf","toString","constructor","propertyIsEnumerable","hasOwnProperty","toLocaleString"];return e}(),m=function(e){return new Promise(function(t,i){var n,a,r,s,c,l,u;if(n=e.method.toUpperCase(),a=e.url,l=e.params,r=JSON.stringify(e.data),u=e.headers,s=e.success,c=e.failure,"POST"==n&&l){r=new FormData;for(var p in l)r.append(p,l[p])}var d=new XMLHttpRequest;d.open(n,a),u&&u["Content-Type"]||d.setRequestHeader("Content-type","application/json"),u&&o(u,function(e,t){d.setRequestHeader(t,e)}),d.onreadystatechange=function(){if(d.readyState==XMLHttpRequest.DONE)if(d.status>=200&&d.status<400){var e,n,a;if(n=d.statusText,204!==d.status)try{a=JSON.parse(d.responseText)}catch(r){return console.log(r),void i(r)}e={status:n,data:a,code:d.status},s&&s(e),t(e)}else{var e,n,a;n=d.statusText;try{a=JSON.parse(d.responseText)}catch(r){a={},console.log(r)}e={status:n,data:a,code:d.status},c&&c(e),i(e)}},d.send(r)})},e.KiiExtensionBuckets={FIRMWARE:"FIRMWARE_BUCKET",MODEL:"MODEL_BUCKET",TAG:"TAG_BUCKET",FIRMWARE_NAMESPACE:"FIRMWARE_NAMESPACE"},e.ReservedBucketPrefix={FIRMWARE:"__FIRMWARE_",MODEL:"__MODEL_",MODEL_UPDATE_INFO:"__MODEL_UPDATE_INFO_",TAG:"__TAG_"},e.KiiPortalExceptions={UNSAVED_OBJECT:"The object has to be saved before using."},e._extensionUrl="http://localhost:1337",e._extApis={MODEL:"/models"},e._baseUrl="https://kii-yubari.herokuapp.com",e._apis={AUTHENTIC:e._extensionUrl+"/login",APP:e._extensionUrl+"/apps",MODEL:e._extensionUrl+"/models"},e.KiiPortalDevSettings={log:!0,debug:!0},n(KiiSite,{DEV:"https://api-development-jp.internal.kii.com/api",QA:"https://qa21.internal.kii.com/api"}),e.KiiLogger=function(){function e(){}return e.log=function(e){KiiPortalDevSettings.log&&console.log(e)},e.debug=function(e){KiiPortalDevSettings.debug&&console.log(e)},e}(),e.KiiObjectRequest=function(){function e(e,t){this._appID=e.getAppID(),this._appKey=e.getAppKey(),this._token=e.getAdminContext()._token,this._url=t.url,this._data=t.data,this._method=t.method,this._headers={},this._extHeaders=t.headers}return e.prototype.getAppID=function(){return this._appID},e.prototype.getAppKey=function(){return this._appKey},e.prototype.getToken=function(){return"Bearer "+this._token},e.prototype.execute=function(e){this.setKiiHeaders(),this._disableCacheURL();var t={headers:this._headers,method:this._method,data:this._data,url:this._url};return e=e||{},t.success=e.success,t.failure=e.failure,m(t)},e.prototype._disableCacheURL=function(){this._url+=-1!==this._url.indexOf("?")?"&disable_cache=":"?disable_cache=",this._url+=(new Date).getTime()},e.prototype.setKiiHeaders=function(){this._headers={"x-kii-appid":this.getAppID(),"x-kii-appkey":this.getAppKey(),"x-kii-sdk":KiiSDKClientInfo.getSDKClientInfo(),Authorization:this.getToken()},n(this._headers,this._extHeaders)},e}(),e.KiiPortalException=function(){function e(e){n(this,e)}return e}(),e.KiiPortalObject=function(e,t){function i(){this._kiiApp=null}var n;return n=t,i.prototype=new n,d(i,e),d(i,t),i.prototype.constructor=i,i.prototype.getKiiApp=function(){return this._kiiApp},i.prototype.setKiiApp=function(e){this._kiiApp=e},i.prototype._getBucketName=function(){return this.constructor._getBucketName()},i.prototype._getUriByID=function(e){return"kiicloud://buckets/"+this.constructor._getBucketName()+"/objects/"+e},i.prototype.init=function(){},i.prototype.renew=function(e){return this._renew(e)},i.prototype._renew=function(e){a(this,e),this.init()},i.prototype._cast=function(e){var t=this.constructor.factory(this.getKiiApp());a(t,e),a(this,t),this.init()},i.prototype.enableRead=function(e){var t=this;return new Promise(function(i,n){var a=t._generateACL(new KiiAnyAuthenticatedUser,KiiACLAction.KiiACLObjectActionRead);a.save({success:function(){e&&e.success&&e.success(),i(),console.log("Object ACL updated!")},failure:function(t,i){e&&e.failure()&&e.failure(),n(),console.log("Error updating object ACL: "+i)}})})},i.prototype.disableRead=function(e){var t=this;return new Promise(function(i,n){var a=t._generateACL(new KiiAnyAuthenticatedUser,KiiACLAction.KiiACLObjectActionRead,!0);a.save({success:function(){e&&e.success&&e.success(),i(),console.log("Object ACL updated!")},failure:function(t,i){e&&e.failure()&&e.failure(),n(),console.log("Error updating object ACL: "+i)}})})},i.prototype.enableWrite=function(e){var t=this;return new Promise(function(i,n){var a=t._generateACL(new KiiAnyAuthenticatedUser,KiiACLAction.KiiACLObjectActionWrite);a.save({success:function(){e&&e.success&&e.success(),i(),console.log("Object ACL updated!")},failure:function(t,i){e&&e.failure()&&e.failure(),n(),console.log("Error updating object ACL: "+i)}})})},i.prototype.disableWrite=function(e){var t=this;return new Promise(function(i,n){var a=t._generateACL(new KiiAnyAuthenticatedUser,KiiACLAction.KiiACLObjectActionWrite,!0);a.save({success:function(){e&&e.success&&e.success(),i(),console.log("Object ACL updated!")},failure:function(t,i){e&&e.failure()&&e.failure(),n(),console.log("Error updating object ACL: "+i)}})})},i.prototype._generateACL=function(e,t,i){var n=KiiACLEntry.entryWithSubject(e,t);i&&n.setGrant(!1);var a=this.objectACL();return a.putACLEntry(n),a},i.prototype.refresh=function(e){return this._refresh(e)},i.prototype._refresh=function(e){var t=this;return new Promise(function(i,a){var r;r={success:function(n){t._cast(n),e&&e.success&&e.success(t),i(t)},failure:function(t){e&&e.failure&&e.failure(t),a(t)}},n.prototype.refresh.call(t,r)})},i.refreshByID=function(e,t,i){return this.constructor._refreshByID(e,t,i)},i._refreshByID=function(e,t,i){var n=this;return new Promise(function(a,r){var o={success:function(e){var t=n.factory(app);t._cast(e),i&&i.success&&i.success(t),a(t)},failure:function(e){i&&i.failure&&i.failure(e),r(e)}};n.objectWithID(e,t).then(o.success,o.failure)})},i.prototype.save=function(e){return this._save(e)},i.prototype._save=function(e){var t=this;return new Promise(function(i,a){var r={success:function(n){t._cast(n),e&&e.success&&e.success(t),i(t)},failure:function(t){e&&e.failure&&e.failure(t),a(t)}};n.prototype.save.call(t,r)})},i.prototype.delete=function(e){return this._delete(e)},i.prototype._delete=function(e){var t=this;return new Promise(function(i,a){var r={success:function(){e&&e.success&&e.success(t),i(t)},failure:function(e){a(e)}};n.prototype.delete.call(t,r)})},i._bucketName=null,i._getBucketName=function(){return this._bucketName},i.prototype.clone=function(){var e=this,t=this.constructor.factory(this.getKiiApp());return o(this,function(i,n){r(i)||(t[n]=e[n])}),t},i.factory=function(e){return this._factory(e)},i._factory=function(e){var t,i,n,a,r;return r=this._getBucketName(),t=e.getAdminContext(),i=t.bucketWithName(r),a=new this,n=i.createObject(),a._renew(n),a._setObjectType(null),a.setKiiApp(e),a},i.objectWithID=function(e,t){var i=this;return new Promise(function(a,r){var o,s,c;o={success:function(e){s._renew(e),a(s)},failure:function(e){r(e)}},s=i.factory(e),c=n.objectWithURI(s._getUriByID(t)),c.refresh(o)})},i.executeQuery=function(e,t,i){var n=this;return new Promise(function(a,r){var s,c;c=e.getAdminContext().bucketWithName(n._getBucketName()),s={success:function(t,r,s){o(r,function(t,i){var a=n.factory(e);a._cast(t),r[i]=a}),i&&i.success.call(i,t,r,s),a(t,r,s)},failure:function(e){return null!=i&&i.failure?i.failure(t,e):void r(t,e)}},c.executeQuery(t,s)})},i}(KiiObject,KiiObjectAdmin),e.KiiPortalQuery=function(e){function t(){}var i=e;return d(t,i),t.prototype.constructor=t,t.prototype._dictValue=function(){var e,t;return t={},t.bestEffortLimit=this._limit,null!=this._paginationKey&&(t.paginationKey=this._paginationKey),e={descending:this._sortDescending},e.clause=null!=this._clause?this._clause._getDictValue():this.constructor._emptyDictValue(),null!=this._sortField&&(e.orderBy=this._sortField),t[this.constructor.queryName]=e,t},t.queryWithClause=function(e){var t;return t=new this,t._setClause(e),t},t.prototype.setDict=function(e){e&&(e.limit&&this.setLimit(e.limit),e.paginationKey&&this.setPaginationKey(e.paginationKey),e.orderBy&&(e.desc?this.sortByDesc(e.orderBy):this.sortByAsc(e.orderBy)))},t._getRequest=function(e,t){return t.headers=t.headers||{},new KiiObjectRequest(e,t)},t._generatePath=function(e){return e.getSiteURL()+"/apps/"+e.getAppID()},t._instantiate=function(){},t.executeQuery=function(t,i,n){var a=this;return new Promise(function(r,o){var s,c,l,u,p;l=a._generatePath(t)+"/query",s={},null!=i?s=i._dictValue():s[a.queryName]={clause:e._emptyDictValue()},u={data:s,url:l,method:"POST"},p=a._getRequest(t,u),c={success:function(e){var t,o,s,c,l;for(i.setPaginationKey(e.data.nextPaginationKey),o=[],l=e.data.results,s=0,c=l.length;c>s;s++)t=l[s],o.push(a._instantiate(t));null!=n&&n.success&&n.success(i,o),r({nextQuery:i,resultSet:o})},failure:function(e){null!=n&&n.failure&&n.failure(e),o({query:i,error:e})}},p.execute(c)})},t}(KiiQuery),e.KiiPortalRequest=function(){function e(e,t){return t&&(e.headers=e.headers||{},e.headers["x-app-id"]=t.getAppID(),e.headers["x-app-key"]=t.getAppKey(),e.headers.Authorization=t.getAdmin().getTokenType()+" "+t.getAdminContext()._token,e.headers["x-app-site"]=t.getSite()),m(e)}return e}(),e.KiiPortalUtilities=function(){function t(){}return t.MAX_DATE_IN_MILLIS=864e13,t.MIN_DATE_IN_MILLIS=-864e13,t._validateEmail=function(i){var n;return i=t._trim(i),n=/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,6}$/i,"string"!==(typeof i).toLowerCase()?(e.Kii.logger("Not string"),!1):i.match(n)?!0:!1},t._validatePhoneNumber=function(i){var n;return i=t._trim(i),n=/^[\\+]?[0-9]{10,}$/i,"string"!==(typeof i).toLowerCase()?(e.Kii.logger("Not string"),!1):i.match(n)?!0:!1},t._isGlobalPhoneNumber=function(i){var n;
return i=t._trim(i),n=/^[\\+]{1}[0-9]{2}/,"string"!==(typeof i).toLowerCase()?(e.Kii.logger("Not string"),!1):i.match(n)?!0:!1},t._validateLocalPhone=function(i){var n;return i=t._trim(i),n=/^\d+$/,"string"!==(typeof i).toLowerCase()?(e.Kii.logger("Not string"),!1):i.match(n)?!0:(e.Kii.logger("Invalid format"),!1)},t._assertLocalPhoneIsValid=function(i){if(!t._validateLocalPhone(i))throw new e.InvalidLocalPhoneNumberException},t._validateCountryCode=function(i){var n;return i=t._trim(i),n=/^[a-z]{2}$/i,"string"!==(typeof i).toLowerCase()?(e.Kii.logger("Not string"),!1):i.match(n)?(e.Kii.logger("Is true"),!0):!1},t._assertCountryCodeIsValid=function(i){if(!t._validateCountryCode(i))throw new e.InvalidCountryException},t._validatePassword=function(t){var i;return e.Kii.logger("Validating password: "+t),i=/^[\x20-\x7E]{4,50}$/,"string"!==(typeof t).toLowerCase()?(e.Kii.logger("not string"),!1):t.match(i)?(e.Kii.logger("matched"),!0):(e.Kii.logger("other exception"),!1)},t._assertPasswordIsValid=function(i){if(!t._validatePassword(i))throw new e.InvalidPasswordException},t._validateUsername=function(e){var t;return t=/^[a-zA-Z0-9-_\\.]{3,64}$/i,"string"!==(typeof e).toLowerCase()?!1:e.match(t)?!0:!1},t._validateGroupID=function(e){var t;return t=/^[a-z0-9-_.]{1,30}$/,"string"!==(typeof e).toLowerCase()?!1:e.match(t)?!0:!1},t._validateDisplayName=function(e){var i;return"string"===t._type(e)&&1<=(i=e.length)&&50>=i},t._trim=function(e){var t;return t=/^(\s|\u00A0)+|(\s|\u00A0)+$/g,(e||"").replace(t,"")},t._safeAddTicks=function(i,n){if(isNaN(parseInt(i,10))||isNaN(parseInt(n,10)))throw new e.InvalidArgumentException("Parameters should be a number");if(Math.abs(i+n)>t.MAX_DATE_IN_MILLIS)throw new e.ArithmeticException("Addition of "+i+" and "+n+" result in long overflow");return i+n},t._safeMultiplyTicks=function(i,n){if(isNaN(parseInt(i,10))||isNaN(parseInt(n,10)))throw new e.InvalidArgumentException("Parameters should be a number");if(Math.abs(i*n)>t.MAX_DATE_IN_MILLIS)throw new e.ArithmeticException("Multiplication of "+i+" and "+n+" result in long overflow");return i*n},t._safeCalculateExpiresAtAsNumber=function(i,n){var a,r,o;o=0;try{r=t._safeMultiplyTicks(i,1e3),o=t._safeAddTicks(n,r)}catch(s){if(a=s,!(a instanceof e.ArithmeticException))throw a;o=t.MAX_DATE_IN_MILLIS}return o},t._safeCalculateExpiresAtAsDate=function(i,n){var a,r,o;o=0;try{r=t._safeMultiplyTicks(i,1e3),o=t._safeAddTicks(n,r)}catch(s){if(a=s,!(a instanceof e.ArithmeticException))throw a;o=t.MAX_DATE_IN_MILLIS}return new Date(o)},t._isJSONType=function(e){var t;return t=/\+?json(;.*)?$/i,e.match(t)},t._type=function(e){var t;return void 0===e||null===e?String(e):(t={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"},t[Object.prototype.toString.call(e)])},t._disableCacheURL=function(e){return e+=-1!==e.indexOf("?")?"&disable_cache=":"?disable_cache=",e+=(new Date).getTime()},t._validateServerCodeEntryName=function(e){var i;return i=/^[a-zA-Z][_a-zA-Z0-9]*$/i,"string"===t._type(e)&&e.match(i)},t._validateServerCodeEntryArgument=function(e){return"null"===t._type(e)||"object"===t._type(e)&&Object.keys(e).length>0},t._validateServerCodeEnryVersion=function(e){return"string"===t._type(e)&&""!==e},t._isNonEmptyString=function(e){return"string"!=typeof e?!1:e.length>0},t._Error=function(e,t){var i;return i=Error(e),i.target=t,i},t.logger={},t.logger.debug=function(e){KiiPortalDevSettings.debug&&console.log(e)},t}(),e.KiiPortalAdmin=function(){function t(){var e=this;this._apps=[],this._adminContenxt=null,this._accessToken=null,this._tokenType=null,this.setApps=function(t){e._apps=t},this.getApps=function(){return e._apps},this.setAdminContext=function(t){e._adminContenxt=t,KiiportalAdmin.setCurrentAdminContext(t)},this.getAdminContext=function(){return e._adminContenxt},this.setAccessToken=function(t){e._accessToken=t},this.getAccessToken=function(){return e._accessToken},this.getTokenType=function(){return e._tokenType},this.setTokenType=function(t){e._tokenType=t}}return t.getCurrentApp=function(){return this._currentApp},t.setCurrentAdminContext=function(e){t._currentAdminContext=e},t.getCurrentAdminContext=function(){return t._currentAdminContext},t.prototype.getAppByID=function(e){var t=this.getApps(),i=null;return o(t,function(t){i=t.getAppID()==e?t:i}),i},t.prototype.refreshApps=function(){return this._refreshApps()},t.prototype._refreshApps=function(e){var t=this;return new Promise(function(i,n){var a={success:function(n){t.setApps(n),e&&e.success.call(e,n),i(n)},failure:function(t){e&&e.failure&&e.failure.call(e,t),n(t)}};KiiPortalApp._withAdmin(t,a).catch(function(e){console.log(e)})})},t.login=function(i,n,a){return new Promise(function(r,o){var s={success:function(e){var i=new t;i.setAccessToken(e.data.access_token),i.setTokenType(e.data.token_type),a&&a.success.call(a,i),r(i)},failure:function(){a&&a.failure.apply(a,arguments),o.apply(o,arguments)}},c={url:e._apis.AUTHENTIC,method:"POST",data:{username:i,password:n,grant_type:"password"}};KiiPortalRequest(c).then(s.success,s.failure)})},t.prototype._addApp=function(e){this._apps.push(e)},t.prototype.useApp=function(e,t){return this._useApp(e,t)},t.prototype._useApp=function(e,i){return new Promise(function(n,a){var r={success:function(e){var r={success:function(a){e.setAdminContext(a),t._currentApp=e,i&&i.success.call(i,e),n(e)},failure:function(){i&&i.failure.apply(i,arguments),a(arguments)}};return Kii.initializeWithSite(e.getAppID(),e.getAppKey(),e.getSiteURL()),Kii.authenticateAsAppAdmin(e.getClientID(),e.getClientSecret(),r)},failure:function(e){a(e)}};e._refresh(r)})},t.prototype.createApp=function(){return KiiPortalApp.factory(this)},t}(),e.KiiPortalApp=function(){function t(){var e=this;this._appName=null,this._adminContext=null,this._appID=null,this._appKey=null,this._clientID=null,this._clientSecret=null,this._site=null,this._platforms=null,this._country=null,this._created=null,this._id=null,this._inactive=!1,this._owner=!1,this._plan=null,this._appSites=null,this._admin=null,this._firmwares=[],this._models=[],this._tags=[],this._server=null,this.getModels=function(){return e._models},this.setModels=function(t){e._models=t},this.getFirmwareNamespaces=function(){return e._firmwareNamespaces},this.setFirmwareNamespaces=function(t){e._firmwareNamespaces=t},this.getSiteURL=function(){switch(e._site){case"cn":return KiiSite.CN;case"cn3":return KiiSite.CN3;case"us":return KiiSite.US;case"jp":return KiiSite.JP;case"devjp":return KiiSite.DEV;case"qa":return KiiSite.QA;default:return KiiSite.CN3}},this.setAdmin=function(t){e._admin=t},this.getAdmin=function(){return e._admin},this.setAppName=function(t){e._appName=t},this.getAppName=function(){return e._appName},this.setPlan=function(t){e._plan=t},this.getPlan=function(){return e._plan},this.setAppSites=function(t){e._appSites=t},this.getAppSites=function(){return e._appSites},this.setPlatforms=function(i){var n=[];o(i,function(e){t.Platform_Enum.indexOf(e)>-1&&n.push(e)}),e._platforms=n},this.setServer=function(t){e._server=t},this.getServer=function(){return e._server},this.getPlatforms=function(){return e._platforms},this.setCountry=function(t){e._country=t},this.getCountry=function(){return e._country},this.setCreated=function(t){e._created=t},this.getCreated=function(){return e._created},this.setID=function(t){e._id=t},this.getID=function(){return e._id},this.setInactive=function(t){e._inactive=t},this.getInactive=function(){return e._inactive},this.setOwner=function(t){e._owner=t},this.getOwner=function(){return e.owner},this.setAppID=function(t){e._appID=t},this.getAppID=function(){return e._appID},this.setAppKey=function(t){e._appKey=t},this.getAppKey=function(){return e._appKey},this.setClientID=function(t){e._clientID=t},this.getClientID=function(){return e._clientID},this.setClientSecret=function(t){e._clientSecret=t},this.getClientSecret=function(){return e._clientSecret},this.setSite=function(e){this._site=e},this.getSite=function(){return this._site},this.setAdminContext=function(t){e._adminContext=t},this.getAdminContext=function(){return e._adminContext}}return t.factory=function(e){var t=new this;return t.setAdmin(e),t},t.prototype.extRequest=function(t){var i=this,a={"x-kii-appid":i.getAppID(),"x-kii-appkey":i.getAppKey(),"x-app-site":i.getSite(),Authorization:i.getTokenType()+" "+i.getAccessToken()};n(a,t.headers);var r={headers:a,method:t.method,data:t.data,url:e._extensionUrl+t.path};return callbacks=callbacks||{},r.success=callbacks.success,r.failure=callbacks.failure,KiiPortalRequest(r)},t.prototype.save=function(i){var n=this;return new Promise(function(a,r){var o,s,c,l;s=n.getAdmin().getAccessToken(),c=n.getAdmin().getTokenType(),o={method:"POST",url:e._apis.APP,headers:{Authorization:c+" "+s},data:{name:n.getAppName(),server:n.getServer(),platforms:n.getPlatforms()}},l={success:function(e){var r=e.data;t.fromJson(n,r),i&&i.success&&i.success(n),a(n)},failure:function(e){i&&i.failure&&i.failure(e),r(e)}},KiiPortalRequest(o).then(l.success,l.failure)})},t.Platform_Enum=["ios","android","unity","html5"],t.prototype._refresh=function(i){var n=this;return new Promise(function(a,r){var o,s,c,l,u;o=n.getAppID(),s=n.getAdmin().getAccessToken(),c=n.getAdmin().getTokenType(),l={method:"GET",url:e._apis.APP+"/"+o,headers:{Authorization:c+" "+s}},u={success:function(e){var r=e.data.app;t.fromJson(n,r),n._putSecret(r),i&&i.success.call(i,n),a(n)},failure:function(e){i&&i.failure.apply(i,arguments),r(e)}},KiiPortalRequest(l).then(u.success,u.failure)})},t._withAdmin=function(i,n){return new Promise(function(a,r){var s,c,l,u;c=i.getTokenType(),s=i.getAccessToken(),l={url:e._apis.APP,method:"GET",headers:{Authorization:c+" "+s}},u={success:function(e){var r,s,c;c=[],r=e.data,s=r.apps,o(s,function(e){var n=new t;n=t.fromJson(n,e),n.setAdmin(i),c.push(n)}),n&&n.success.call(n,c),a(c)},failure:function(e){n.failure&&n.failure.call(n,e),r(e)}},KiiPortalRequest(l).then(u.success,u.failure)})},t.prototype._putSecret=function(e){this.setClientID(e.client_id),this.setClientSecret(e.client_secret)},t.fromJson=function(e,t){var i;return i=t,e.setAppID(i.app_id),e.setAppKey(i.app_key),e.setCountry(i.country),e.setCreated(i.created),e.setID(i.id),e.setInactive(i.inactive),e.setAppName(i.name),e.setOwner(i.owner),e.setPlatforms(i.platforms),e.setSite(i.site_name),e.setClientID(i.client_id),e.setClientSecret(i.client_secret),e.setPlan(i.plan),e.setAppSites(i.app_sites),e},t.prototype._addModel=function(e){this._models.push(e)},t.prototype._removeModel=function(e){s(this._models,e)},t.prototype.createModel=function(){return KiiPortalModel.factory(this)},t.prototype.refreshModels=function(e){return KiiPortalModel._getAll(this,e)},t.prototype.getModelByID=function(e,t){var i=KiiPortalModel.refreshByID(this,e,t);return i},t.prototype.getFirmwareNamespaceByID=function(e,t){return KiiPortalFirmwareNamespace.refreshByID(this,e,t)},t.prototype._addFirmwareNamespace=function(e){return this._firmwareNamespaces.push(e),this._firmwareNamespaces},t.prototype._removeFirmwareNamespace=function(e){return s(this._firmwareNamespaces,e),this._firmwareNamespaces},t.prototype.createFirmwareNamespace=function(){return KiiPortalFirmwareNamespace.factory(this)},t.prototype.refreshFirmwareNamespaces=function(e){return KiiPortalFirmwareNamespace._getAll(this,e)},t.prototype.refreshTags=function(e){return KiiPortalTag._getAll(this,e)},t.prototype._setTags=function(e){return this._tags=e},t.prototype._addTag=function(e){this._tags.push(e)},t.prototype.getTags=function(){return this._tags},t.prototype.getTagByID=function(e,t){return KiiPortalTag.refreshByID(this,e,t)},t.prototype.createTag=function(){return KiiPortalTag.factory(this)},t.prototype._removeTag=function(e){return s(this._tags,e),this._tags},t.prototype.getUserList=function(e,t,i){return KiiPortalUser.getUserList(e,t,i)},t.prototype.findUserByUserID=function(e,t,i){return KiiPortalUser.findUserByUserID(e,t,i)},t.prototype.queryThings=function(e,t,i){return KiiThingAdmin.query(this,e,t,i)},t.prototype.nextThings=function(e,t){return KiiThingAdmin.nextThings=KiiThingAdmin._nextWithApp(this,e,t)},t.prototype._setThings=function(e){this._things=e},t.prototype.getThings=function(){return this._things},t.prototype.addThing=function(e){return this._things.splice(0,0,e)},t.prototype.addThings=function(e){var t=this;this._things=this._things||[],o(e,function(e){var i=!0;o(t._things,function(t){t.getThingID()==e.getThingID()&&(i=!1)}),i&&t._things.push(e)})},t}(),e.KiiPortalFirmware=function(t){function i(){var e=this;y(e),this._name=null,this._models=[],this._state=null,this._downloadURL=null,this._description=null,this._namespace=null,this.namespace=null,this._initialSchema=null,this.setNamespace=function(t){this._namespace=t,e.set("namespace",t)},this.getNamespace=function(){return e.get("namespace")},this.setDownloadURL=function(t){e._downloadURL=t,e.set("downloadURL",t)},this.getDownloadURL=function(){return e.get("downloadURL")},this.getName=function(){return e.get("name")},this.setName=function(t){e._name=t,e.set("name",t)},this.setState=function(t){e._state=t,e.set("state",t)},this.getState=function(){return e.get("state")},this.setDescription=function(t){e.description=t,e.set("description",t)},this.getDescription=function(){return e.get("description")},this.setInitialSchema=function(){},this.getInitialSchema=function(){return e.get("initialSchema")}}var n;return n=t,i.prototype=new n,d(i,n),i.prototype.constructor=i,i._bucketName=e.KiiExtensionBuckets.FIRMWARE,i.prototype.addModel=function(e,t){var i=this;if(this._models.indexOf(e.getName())>-1)return null;this._models.push(e.getName());e.addFirmware(this);return new Promise(function(e,n){var a={success:function(i){t&&t.success&&t.success.apply(t.success,arguments),e(i)},failure:function(){t&&t.failure&&t.failure.apply(t.failure,arguments),n(n)}};i.set("models",i._models),i.save(a)})},i.prototype.getModels=function(){return this._models},i.prototype.setModels=function(e){this._models=e||[],this.set("models",this._models)},i.prototype.deleteModel=function(e,t){var i=this,n=e.getName(),a=this._models.indexOf(n);if(0>a)return null;this._models.splice(a,1);e.deleteFirmware(this);return new Promise(function(e,n){var a={success:function(i){t&&t.success&&t.success.apply(t.success,arguments),e(i)},failure:function(e){t&&t.failure&&t.failure.apply(t.failure,arguments),n(e)}};i.set("models",i._models),i.save(a)})},i.prototype._setUpdateInfoBucketName=function(t){this.set("updateInfoBucketName",e.ReservedBucketPrefix.MODEL_UPDATE_INFO+t)},i.StateEnum={CREATED:"CREATED",PUBLISHED:"PUBLISHED",PUSHED:"PUSHED",DISABLED:"DISABLED"},i.prototype.deleteFirmwareFile=function(e){var t=this;return new Promise(function(i,n){var a={success:function(){var a={success:function(){e&&e.success&&e.success(t),i(t)},failure:function(t){e&&e.failure&&e.failure(t),n(t)}};t.setDownloadURL(""),t.save(a)},failure:function(t){e&&e.failure&&e.failure.apply(e,t),n(t)}};t.deleteBody(a)})},i.prototype.uploadFirmwareFile=function(e,t){var i=this;return new Promise(function(a,r){var o=function(e){t&&t.failure&&t.failure.apply(t,e),r(e)},s=function(){i.publishBody({success:function(e,t){c(t)},failure:function(e){o(e)}})},c=function(e){var n={success:function(){t&&t.success&&t.success(i),a(i)},failure:function(e){t&&t.failure&&t.failure(e),r(e)}};i.setDownloadURL(e),i.save(n)};n.prototype.uploadBody.call(i,e).then(s,o)})},i.prototype.push=function(){var e,t,n;return t=this,e=this._models,arguments.length>0&&(arguments[0]instanceof KiiPortalModel?(e=[arguments[0]],n=arguments[1]):n=arguments[0]),new Promise(function(a,r){var s=0;0==e.length&&r("No model uses this firmware, push command is rejected!"),o(e,function(i){var o,c,l;l=t.clone(),o=ReservedBucketPrefix.MODEL+i,c=t.getKiiApp().getAdminContext().bucketWithName(o),l._setBucket(c),l._setUUID(null),l._setUpdateInfoBucketName(i),l.save({success:function(){s++,s==e.length&&t.save().then(function(){n&&n.success&&n.success(!0),a(!0)},function(e){r(e)})},failure:function(e){n&&n.failure&&n.failure(e),r(e)}})}),t.setState(i.StateEnum.PUSHED)})},i.prototype.disable=function(e){var t=this;return new Promise(function(n,a){t.setState(i.StateEnum.DISABLED),t.save({success:function(){e&&e.success&&e.success(),n()},failure:function(t){e&&e.failure&&e.failure(t),a(t)}})})},i.prototype.publish=function(e){var t=this;return new Promise(function(n,a){t.setState(i.StateEnum.PUBLISHED),t.save({success:function(){e&&e.success&&e.success(),n()},failure:function(t){e&&e.failure&&e.failure(t),a(t)}})})},i.prototype.delete=function(e){var t=this;return new Promise(function(i,a){var r={success:function(){t.namespace._removeFirmware(t),e&&e.success&&e.success(t),i(t)},failure:function(e){a(e)}};n.prototype.delete.call(t,r)})},i.prototype.save=function(e){var t=this,i=t.getUUID()?!1:!0;return new Promise(function(a,r){var o={success:function(){i&&t.namespace._addFirmware(t),e&&e.success&&e.success(t),a(t)},failure:function(t){e&&e.failure&&e.failure(t),r(t)}};n.prototype.save.call(t,o)})},i.factory=function(e,t){var a;return a=n.factory.call(this,e),a.setState(i.StateEnum.CREATED),t&&(a.setNamespace(t.getName()),a.namespace=t),a},i.prototype.init=function(){this.setName(this.get("name")),this.setNamespace(this.get("namespace")),this.setState(this.get("state")),this.setModels(this.get("models"))},i._withFirmwareNamespace=function(e,t){var i=this;return new Promise(function(n,a){var r,s,c,l;return l=e.getKiiApp(),c=KiiClause.equals("namespace",e.getName()),r=KiiQuery.queryWithClause(c),s={success:function(i,a,r){e.setFirmwares(a),o(a,function(t){t.namespace=e}),t&&t.success&&t.success(i,a,r),n(i,a,r)},failure:function(e,t){a(e,t)}},i.executeQuery(l,r,s)})},i._getAll=function(e,t){var i=this;return new Promise(function(n,a){var r,o;return r=KiiQuery.queryWithClause(),o={success:function(i,a,r){e.setFirmwares(a),t&&t.success&&t.success(i,a,r),n(i,a,r)},failure:function(e,t){a(e,t)}},i.executeQuery(e,r,o)})},i}(KiiPortalObject),e.KiiPortalFirmwareNamespace=function(t){function i(){var e=this;y(e),this._name="",this._versionName=null,this._firmwares=[],this.setName=function(t){e._name=t,e.set("name",t)},this.getName=function(){return e.get("name")},this.getFirmwares=function(){return e._firmwares},this.setFirmwares=function(t){e._firmwares=t},this._addFirmware=function(t){e._firmwares.push(t)},this._removeFirmware=function(t){e._firmwares.splice(e._firmwares.indexOf(t),1)},this.getVersionName=function(){return e.get("versionName")},this.setVersionName=function(t){e._versionName=t,e.set("versionName",t)}}var n;return n=t,i.prototype=new n,d(i,n),i.prototype.constructor=i,i._bucketName=e.KiiExtensionBuckets.FIRMWARE_NAMESPACE,i.prototype.refreshFirmwares=function(e,t,i){return KiiPortalFirmware._withFirmwareNamespace(this,e,t,i)},i.prototype.createFirmware=function(){return KiiPortalFirmware.factory(this.getKiiApp(),this)},i.prototype.delete=function(e){var t=this;return new Promise(function(i,a){var r={success:function(){t._kiiApp._removeFirmwareNamespace(t),e&&e.success&&e.success(t),i(t)},failure:function(e){a(e)}};n.prototype.delete.call(t,r)})},i.prototype.save=function(e){var t=this,i=t.getUUID()?!1:!0;return new Promise(function(a,r){var o={success:function(){i&&t._kiiApp._addFirmwareNamespace(t),e&&e.success&&e.success(t),a(t)},failure:function(t){e&&e.failure&&e.failure(t),r(t)}};n.prototype.save.call(t,o)})},i.factory=function(e){var t=n.factory.call(this,e);return t},i.prototype.init=function(){this.setName(this.get("name")),this.setVersionName(this.get("versionName"))},i._getAll=function(e,t){var i=this;return new Promise(function(n,a){var r,o;return r=KiiQuery.queryWithClause(),o={success:function(i,a,r){e.setFirmwareNamespaces(a),t&&t.success&&t.success(i,firmwares,r),n(i,a,r)},failure:function(e,t){a(e,t)}},i.executeQuery(e,r,o)})},i}(KiiPortalObject),e.KiiPortalModel=function(t){function i(){var e=this;y(e),this._name=null,this._things=null,this._imageUrl=null,this._firmwares=[],this._firmwareNamespace=null,this._portalSchemas=null,this.getImageUrl=function(){return e._imageUrl},this.setImageUrl=function(t){e._imageUrl=t,n.prototype.set.call(e,"imageUrl",t)},this.setName=function(t){e._name=t,e.set("name",t)},this.getName=function(){return e.get("name")},this.getFirmwares=function(){return e._firmwares},this.setFirmwares=function(t){e._firmwares=t||[],e.set("firmwares",e._firmwares)},this.setFirmwareNamespace=function(t){e._firmwareNamespace=t,e.set("firmwareNamespace",t)},this.getFirmwareNamespace=function(){return e.get("firmwareNamespace")},this.getPortalSchemas=function(){return e._portalSchemas},this.setPortalSchemas=function(t){e._portalSchemas=t}}var n;return n=t,i.prototype=new n,d(i,n),i.prototype.constructor=i,i._bucketName=e.KiiExtensionBuckets.MODEL,i.prototype.init=function(){this.setName(n.prototype.get.call(this,"name")),this.setImageUrl(n.prototype.get.call(this,"imageUrl")),this.setFirmwareNamespace(n.prototype.get.call(this,"firmwareNamespace")),this.setFirmwares(n.prototype.get.call(this,"firmwares"))},i.factory=function(e){var t=n.factory.call(this,e);return t},i.prototype.deleteFirmware=function(e,t){var i=this,n=e.getUUID(),a=this._firmwares.indexOf(n);if(0>a)return null;this._firmwares.splice(a,1);var r=e.deleteModel(this);return new Promise(function(e,n){var a={success:function(i){t&&t.success&&t.success.apply(t.success,arguments),e(i)},failure:function(e){t&&t.failure&&t.failure.apply(t.failure,arguments),n(e)}};r?r.then(function(){i.set("firmwares",i._firmwares),i.save(a)},function(e){a.failure(e),n(e)}):(i.set("firmwares",i._firmwares),i.save(a))})},i.prototype.addFirmware=function(e,t){var i=this;if(this._firmwares.indexOf(e.getUUID())>-1)return null;this._firmwares.push(e.getUUID());var n=e.addModel(this);return new Promise(function(e,a){var r={success:function(i){t&&t.success&&t.success.apply(t.success,arguments),e(i)},failure:function(e){t&&t.failure&&t.failure.apply(t.failure,arguments),a(e)}};n?n.then(function(){i.set("firmwares",i._firmwares),i.save(r)},function(e){r.failure(e),a(e)}):(i.set("firmwares",i._firmwares),i.save(r))})},i._getAll=function(e,t){return new Promise(function(n,a){var r,o;return r=KiiQuery.queryWithClause(),o={success:function(i,a,r){e.setModels(a),t&&t.success&&t.success(i,a,r),n(i,a,r)},failure:function(e,t){a(e,t)}},i.executeQuery(e,r,o)})},i.prototype.delete=function(e){var t=this;return new Promise(function(i,a){var r,o;r={success:function(){o=t.getKiiApp(),o._removeModel(t),e&&e.success&&e.success(t),i(t)},failure:function(t){e&&e.failure&&e.failure(t),a(t)}},n.prototype.delete.call(t,r)})},i.refreshByID=function(e,t,n){return new Promise(function(a,r){var o;o={success:function(e){n&&n.success&&n.success(e),a(e)},failure:function(e){n&&n.failure&&n.failure(e),r(e)}},i.objectWithID(e,t).then(o.success,o.failure)})},i.prototype.createSchema=function(){return KiiPortalSchema.create(this)},i.prototype.uploadImage=function(e,t){var i=this;return new Promise(function(a,r){var o=function(e){t&&t.failure&&t.failure.apply(t,e),r(e)},s=function(){i.publishBody({success:function(e,t){c(t)},failure:function(e){o(e)}})},c=function(e){var n={success:function(){t&&t.success&&t.success(i),a(i)},failure:function(e){t&&t.failure&&t.failure(e),r(e)}};i.setImageUrl(e),i.save(n)};n.prototype.uploadBody.call(i,e).then(s,o)})},i.prototype.save=function(e){var t=this,i=t.getUUID()?!1:!0;return new Promise(function(a,r){var o,s;o={success:function(){s=t.getKiiApp(),i&&s._addModel(t),e&&e.success&&e.success(t),a(t)},failure:function(t){e&&e.failure&&e.failure(t),r(t)}},n.prototype.save.call(t,o)})},i.prototype.refreshPortalSchemas=function(e){return KiiPortalSchema._withModel(this,e)},i.prototype.getModelBucket=function(){return this.getKiiApp().getAdminContext().bucketWithName(i._getBucketName()+this.getUUID())},i.prototype.saveSchema=function(e,t){var i=this;return new Promise(function(n,a){var r={success:function(e){var a=i.getPortalSchemas();a.indexOf(e)&&a.push(e),n(e),t&&t.success&&t.success(e)},failure:function(e){t&&t.failure&&t.failure(e),a(e)}};e.save(r)})},i}(e.KiiPortalObject),e.KiiPortalSchema=function(){function t(e,t){var i=this;this.id=null,this._modelId=t.getUUID(),this._version=null,this.properties=[],this._kiiApp=t.getKiiApp(),this._model=t,this.createdAt=null,this.updatedAt=null,this.getProperties=function(){return i.properties},this.getKiiApp=function(){return i._kiiApp},this.getModelId=function(){return i._modelId},this.setModelId=function(e){i._modelId=e},this.getVersion=function(){return i._version},this.setVersion=function(e){i._version=e},this.init(e)}return t.prototype.init=function(e,t){var i=this;e&&(i.id=e.id,i.setVersion(e.version),i.setModelId(e.modelId),i.createdAt=e.createdAt,i.updatedAt=e.updatedAt,o(e.properties,function(e){i.properties.push(new KiiPortalSchemaProperty(e))})),i._model=t||i._model},t.prototype.createProperty=function(){var e=new KiiPortalSchemaProperty;return this.addProperty(e),e},t.prototype.addProperty=function(e){this.properties.push(e)},t.prototype.removeProperty=function(e){this.properties.splice(this.properties.indexOf(e),1)},t._withModel=function(i,n){var a,r;return r=i.getKiiApp(),new Promise(function(s,c){a={method:"GET",url:e._apis.MODEL+"/"+i.getUUID()+"/schemas",success:function(e){var a=e.data.schemas,r=[];o(a,function(e){r.push(t.factory(e,i))}),i.setPortalSchemas(r),n&&n.success&&n.success(r),s(r)},failure:function(e){n&&n.failure&&n.failure(e),c(e)}},KiiPortalRequest(a,r)})},t.prototype.refresh=function(){var t={method:"GET",url:e._apis.MODEL+"/"+this.getModelId()+"/schemas/"+this.getVersion(),headers:{Authorization:tokenType+" "+accessToken},success:function(){},failure:function(){}};KiiPortalRequest(t,this.getKiiApp())},t.prototype.save=function(t){var i,n,a,r,s,c,l;return s=this.getKiiApp().getAdmin().getTokenType(),c=this.getKiiApp().getAdmin().getAccessToken(),l=[],o(this.getProperties(),function(e){l.push(e.purify())}),r=this,i=this.id,i||(n=!0),new Promise(function(i,o){a=n?{method:"POST",url:e._apis.MODEL+"/"+r.getModelId()+"/schemas",data:{modelId:r.getModelId(),properties:l,version:r.getVersion()},headers:{Authorization:s+" "+c},success:function(e){r.init(e.data,r._model),t&&t.success&&t.success(r),i(r)},failure:function(e){t&&t.failure&&(t.failure(e),o(e))}}:{method:"POST",data:{id:r.id,modelId:r.getModelId(),properties:l,version:r.getVersion()},url:e._apis.MODEL+"/"+r._model.getUUID()+"/schemas/"+r.getVersion(),headers:{Authorization:s+" "+c},success:function(e){r.init(e.data,this._model),t&&t.success&&t.success(r),i(r)},failure:function(e){t&&t.failure&&t.failure(e),o(e)}},KiiPortalRequest(a,r.getKiiApp()).catch(function(e){KiiLogger.debug(new KiiPortalException(e))})})},t.create=function(e){var i=t.factory(null,e);return i.setModelId(e.getUUID()),i},t.factory=function(e,i){return new t(e,i)},t}(),e.KiiPortalSchemaProperty=function(){function e(e){this.key=null,this.displayName=null,this.type=null,this.controllable=null,this.unit=null,this.min=null,this.max=null,e&&n(this,e)}return e.KeyEnum=["key","displayName","type","controllable","unit","min","max"],e.Schema_Type_Enum={BOOLEAN:"boolean",INT:"integer",FLOAT:"float",STRING:"string"},e.prototype.purify=function(){var t={},i=this;return o(e.KeyEnum,function(e){i[e]&&(t[e]=i[e])}),t},e}(),e.KiiPortalTag=function(t){function i(){var e=this;y(e),this._name=null,this._description=null,this._thingIDs=[],this.set("thingIDs",this._thingIDs),this._things=[],this._nextThingQuery=null,this._customData={},this.setCustomData=function(t){e._customData=t,e.set("customData",t)},this.getCustomData=function(){return e._customData},this.setNextThingQuery=function(t){return e._nextThingQuery=t},this.getNextThingQuery=function(){return e._nextThingQuery},this.getThings=function(){return e._things},this.setThings=function(t){e._things=t},this.setThingIDs=function(t){e._thingIDs=t,e.set("thingIDs",t)},this.getThingIDs=function(){return e.get("thingIDs")},this.setName=function(t){e._name=t,e.set("name",t)},this.getName=function(){return e._name},this.getDescription=function(){return e._discription},this.setDescript=function(t){e._description=t,e.set("description",t)}}var n;return n=t,i.prototype=new n,d(i,n),i.prototype.constructor=i,i._bucketName=e.KiiExtensionBuckets.TAG,i.prototype.save=function(e){var t=this,i=t.getUUID()?!1:!0;return new Promise(function(a,r){var o={success:function(){i&&t._kiiApp._addTag(t),e&&e.success&&e.success(t),a(t)},failure:function(t){e&&e.failure&&e.failure(t),r(t)}};n.prototype.save.call(t,o)})},i._getAll=function(e,t){return new Promise(function(n,a){var r,o;return r=KiiQuery.queryWithClause(),o={success:function(i,a,r){e._setTags(a),t&&t.success&&t.success(i,a,r),n(i,a,r)},failure:function(e,t){a(e,t)}},i.executeQuery(e,r,o)})},i.prototype.refresh=function(e){return this._refresh(e)},i.prototype.delete=function(e){var t=this;return new Promise(function(i,a){var r,o;r={success:function(){o=t.getKiiApp(),o._removeTag(t),e&&e.success&&e.success(t),i(t)},failure:function(t){e&&e.failure&&e.failure(t),a(t)}},n.prototype.delete.call(t,r)})},i.prototype.init=function(){this.setName(this.get("name")),this.setDescript(this.get("description")),this.setThingIDs(this.get("thingIDs")),this.setCustomData(this.get("customData"))},i.prototype.addThing=function(e){this._things||(this._things=[]),this._things.push(e),this.addThingID(e.getThingID())},i.prototype.addThingID=function(e){this._thingIDs||(this._thingIDs=[],this.setThingIDs(this._thingIDs)),this._thingIDs.push(e)},i.prototype.removeThing=function(e){this.removeThingID(e.getThingID()),s(this._things,e)},i.prototype.removeThingID=function(e){s(this._thingIDs,e)},i.prototype.refreshThings=function(e){var t,i,n;return n=this,t=this.getKiiApp(),i=KiiClause["in"]("_thingID",this.getThingIDs()),new Promise(function(a,r){var o={success:function(t){var i,r;i=t.things,r=t.query,n.setNextThingQuery(r),n.setThings(i),e&&e.failure&&e.success(i),a(i)},failure:function(t){e&&e.failure&&e.failure(t),r(t)}};KiiThingAdmin.query(t,null,i).then(o.success,o.failure)})},i.prototype.nextThings=function(e){var t=this;return new Promise(function(){var i,n;i=t.getKiiApp(),n={success:function(i){var n;n=i.things,nextQuery=i.query,t.setNextThingQuery(nextQuery),t.setThings(n),e&&e.failure&&e.success(n),resolve(n)},failure:function(t){e&&e.failure&&e.failure(t),reject(t)}},KiiThingAdmin.query(i,e,t.getNextThingQuery()).then(n.success,n.failure)})},i}(KiiPortalObject),e.KiiPortalUserQuery=function(e){function t(){}return d(t,e),t.prototype.constructor=t,t.queryName="userQuery",t._getRequest=function(e,t){return t.headers=t.headers||{},t.headers["Content-Type"]="application/vnd.kii.userqueryrequest+json",new KiiObjectRequest(e,t)},t._generatePath=function(t){return e._generatePath.call(this,t)+"/users"},t._instantiate=function(e){return null===e?null:new KiiPortalUser(e)},t}(KiiPortalQuery),e.KiiPortalUserRequest=function(e){function t(i){var a=KiiPortalAdmin.getCurrentApp();t.prototype=new e(a,i);var r={method:"GET",headers:{"Content-Type":"application/json"}};n(r,i),this._appID=a.getAppID(),this._appKey=a.getAppKey(),this._token=a.getAdminContext()._token,this._url=Kii.getBaseURL()+"/apps/"+a.getAppID()+i.extraUrl,this._data=r.data,this._method=r.method,this._headers={},this._extHeaders=r.headers}return d(t,e),t.prototype.constructor=t,t}(KiiObjectRequest),e.KiiPortalUser=function(e){function t(e){y(this),this._info=e}return d(t,e),t.prototype.constructor=t,t}(KiiUserAdmin),KiiPortalUser.getUserList=function(e,t,i){return new Promise(function(n,a){var r;r=KiiPortalUserQuery.queryWithClause(t),r.setDict(i);var o={success:function(t,i){e&&e.success&&e.success.apply(e.success,arguments),n({query:t,users:i})},failure:function(t,i){e&&e.failure&&e.failure.apply(e.failure,arguments),a({query:t,error:i})
}},s=KiiPortalAdmin.getCurrentApp();return KiiPortalUserQuery.executeQuery(s,r,o)})},KiiPortalUser.findUserByUserID=function(e){return new Promise(function(t,i){var n={extraUrl:"/users/"+e},a=new KiiPortalUserRequest(n);a.execute().then(function(e){t(new KiiPortalUser(e.data))},function(e){i(e)})})},KiiPortalUser.prototype.register=function(){var e=this;return new Promise(function(t,i){var n={loginName:e._info.loginName,password:e._info.password,displayName:e._info.displayName,emailAddress:e._info.emailAddress,phoneNumber:e._info.phoneNumber,country:e._info.country,phoneNumberVerified:null,emailAddressVerified:null,createdAt:null,modifiedAt:null};n.country||delete n.country;var a={data:n,method:"POST",headers:{"Content-Type":"application/vnd.kii.RegistrationRequest+json"},extraUrl:"/users"},r=new KiiPortalUserRequest(a);r.execute().then(function(e){t(e)},function(e){i(e)})})},KiiPortalUser.prototype.delete=function(){var e=this;return new Promise(function(t,i){var n={method:"DELETE",extraUrl:"/users/"+e.getID()},a=new KiiPortalUserRequest(n);a.execute().then(function(e){t(e)},function(e){i(e)})})},KiiPortalUser.prototype.getID=function(){return this._info.userID},KiiPortalUser.prototype.memberOfGroups=function(){var e=this;return new Promise(function(t,i){var n={headers:{"Content-Type":"application/vnd.kii.GroupsRetrievalResponse+json"},extraUrl:"/groups?is_member="+e.getID()},a=new KiiPortalUserRequest(n);a.execute().then(function(e){t(e)},function(e){i(e)})})},KiiPortalUser.prototype.ownerOfGroups=function(){var e=this;return new Promise(function(t,i){var n={headers:{"Content-Type":"application/vnd.kii.GroupsRetrievalResponse+json"},extraUrl:"/groups?owner="+e.getID()},a=new KiiPortalUserRequest(n);a.execute().then(function(e){t(e)},function(e){i(e)})})},KiiPortalUser.prototype.resetPassword=function(e){var t=this;return new Promise(function(i,n){var a={notificationMethod:e},r={data:a,method:"POST",headers:{"Content-Type":"application/vnd.kii.ResetPasswordRequest+json"},extraUrl:"/users/"+t.getID()+"/password/request-reset"},o=new KiiPortalUserRequest(r);o.execute().then(function(e){i(e)},function(e){n(e)})})},KiiPortalUser.prototype.toggleUserStatus=function(e){var t=this;return new Promise(function(i,n){var a={data:e,method:"PUT",headers:{"Content-Type":"application/vnd.kii.UserStatusUpdateRequest+json"},extraUrl:"/users/"+t.getID()+"/status"},r=new KiiPortalUserRequest(a);r.execute().then(function(e){i(e)},function(e){n(e)})})},KiiPortalUser.prototype.update=function(e){var t=this;return new Promise(function(i,n){var a={data:e,method:"POST",headers:{"Content-Type":"application/vnd.kii.UserUpdateRequest+json"},extraUrl:"/users/"+t.getID()},r=new KiiPortalUserRequest(a);r.execute().then(function(e){i(e)},function(e){n(e)})})},e.KiiThingAdminQuery=function(e){function t(){}return d(t,e),t.prototype.constructor=t,t.queryName="thingQuery",t._getRequest=function(e,t){return t.headers=t.headers||{},t.headers["Content-Type"]="application/vnd.kii.thingqueryrequest+json",new KiiObjectRequest(e,t)},t._generatePath=function(t){return e._generatePath.call(this,t)+"/things"},t._instantiate=function(e){return new KiiThingAdmin(e)},t}(KiiPortalQuery),KiiThingAdmin.query=function(e,t,i,n){return new Promise(function(a,r){var o;o=KiiThingAdminQuery.queryWithClause(i),o.setDict(n);var s={success:function(i,n){e._setThings(n),t&&t.success&&t.success.apply(t.success,arguments),a({query:i,things:n})},failure:function(e,i){t&&t.failure&&t.failure.apply(t.failure,arguments),r({query:e,error:i})}};return KiiThingAdminQuery.executeQuery(e,o,s)})},KiiThingAdmin._nextWithApp=function(e,t,i){return new Promise(function(t,n){var a={success:function(i,n){e.addThings(n),t({query:i,things:e.getThings()})},failure:function(e,t){n({query:e,error:t})}};KiiThingAdminQuery.executeQuery(e,i,a)})},KiiThingAdmin.prototype.save=function(){var e=this,t=!1;return new Promise(function(i,n){var a,r,s,c;if(c=KiiPortalAdmin.getCurrentApp(),s={_created:e.getCreated(),_disabled:e.getDisabled(),_layoutPosition:"STANDALONE",_thingID:e.getThingID(),_thingType:e.fields._thingType,_vendorThingID:e.getVendorThingID()},o(e.fields,function(e,t){s[t]=e}),e.getThingID()||(t=!0),t){a={data:s,method:"POST",headers:{"Content-Type":"application/vnd.kii.ThingRegistrationAndAuthorizationRequest+json"},url:Kii.getBaseURL()+"/apps/"+c.getAppID()+"/things"};var r=new KiiObjectRequest(c,a);r.execute().then(function(t){c.addThing(e),e._renewThingFields(t.data),i(e)},function(e){n(e)})}else{a={data:s,method:"PUT",headers:{"Content-Type":"application/vnd.kii.ThingUpdateRequest+json"},url:Kii.getBaseURL()+"/apps/"+c.getAppID()+"/things/"+e.getThingID()};var r=new KiiObjectRequest(c,a);r.execute().then(function(e){i(e)},function(e){n(e)})}})}}(),angular.module("StarterPack.Portal.AppManager").factory("AppManagerService",["$state",function(e){var t={};return t.portalNavs=[{name:"Observation",state:e.get("app.Portal.AppManager.ApplicationEditor.Observation"),icon:"fa-eye"},{name:"Dashboard",state:e.get("app.Portal.AppManager.ApplicationEditor.Dashboard"),icon:"fa-dashboard"},{name:"Users",state:e.get("app.Portal.AppManager.ApplicationEditor.UserManager"),icon:"fa-user"},{name:"Groups",state:e.get("app.Portal.AppManager.ApplicationEditor.UserGroupManager"),icon:"fa-group",hidden:!0},{name:"Model Management",state:e.get("app.Portal.AppManager.ApplicationEditor.ModelManager"),icon:"fa-cube",subViews:[{name:"Models",state:e.get("app.Portal.AppManager.ApplicationEditor.ModelManager.ModelList")}]},{name:"Firmware Management",state:e.get("app.Portal.AppManager.ApplicationEditor.FirmwareManager"),icon:"fa-user",subViews:[{name:"Firmwares",state:e.get("app.Portal.AppManager.ApplicationEditor.FirmwareManager.FirmwareNamespaceList")}]},{name:"Device Management",state:e.get("app.Portal.AppManager.ApplicationEditor.DeviceManager"),icon:"fa-desktop"},{name:"Device Simulation",state:e.get("app.Portal.AppManager.ApplicationEditor.VirtualDevice"),icon:"fa-gamepad"},{name:"Settings",state:e.get("app.Portal.AppManager.ApplicationEditor.Settings"),icon:"fa-cogs"}],t}]),angular.module("StarterPack.Portal.AppManager").controller("AppManagerController",["$scope","$rootScope","$state","AppUtils","AppManagerService","ApplicationService",function(e,t,i,n,a,r){t.portalNavs=[],e.appsReady=!1,e.myApps=[],e.init=function(){n.doLoading(),r.getApps().then(function(t){e.myApps=t,e.appsReady=!0,e.$apply(),n.whenLoaded()},function(){n.whenLoaded()}).catch(function(e){console.log(e)})}}]),angular.module("StarterPack.AppShared").filter("leftHalf",function(){return function(e){var t=[];return _.each(e,function(e,i){i%2!=0&&t.push(e)}),t}}).filter("rightHalf",function(){return function(e){var t=[];return _.each(e,function(e,i){i%2!=1&&t.push(e)}),t}}),angular.module("StarterPack.Secure",["StarterPack.AppShared"]),angular.module("StarterPack.Secure").factory("SessionService",["localStorageService","$rootScope","AppConfig",function(e,t,i){var n={};return n.setPortalAdmin=function(n){e.set(i.USER_SESSION,n),t.portalAdmin=n},n.getPortalAdmin=function(){return e.get(i.USER_SESSION)},n.expire=function(){t.portalAdmin=null,e.remove(i.USER_SESSION)},n.restore=function(){var n=e.get(i.USER_SESSION);n&&(t.portalAdmin=new KiiPortalAdmin,t.portalAdmin.setAccessToken(n._accessToken),t.portalAdmin.setTokenType(n._tokenType))},n.restore(),n}]),angular.module("StarterPack.Secure").factory("SecurityService",["localStorageService","AppUtils","SessionService",function(){var e={};return e.login=function(e){return KiiPortalAdmin.login(e.username,e.password)},e}]),angular.module("StarterPack.Secure").controller("SecureController",["$scope","$rootScope","$state","AppUtils","SecurityService","SessionService",function(e,t,i,n,a,r){e.login=function(e){n.showLoading(),a.login(e).then(function(e){r.setPortalAdmin(e),i.go("app.Portal.AppManager.ApplicationList"),n.hideLoading()},function(e){console.log(e),n.hideLoading()})}}]),angular.module("StarterPack.Portal",["StarterPack.Portal.AppManager","StarterPack.AppShared"]),angular.module("StarterPack.Portal").factory("PortalService",["AppUtils","$state",function(e,t){var i={};return i.getStateDisplayName=function(e){return t.get(e).getName()},i.getStateChan=function(e){var i=[];i.push(e);for(var n=e;n.previous;)n=t.get(n.previous),i.push(n);return i.reverse(),i},i.isActive=function(e){var n=i.getStateChan(t.current),a=t.get(e);return n.indexOf(a)>-1},i}]),angular.module("StarterPack.Portal").controller("PortalController",["$scope","$rootScope","$state","AppUtils","PortalService","SessionService",function(e,t,i,n,a,r){e.getStateChan=a.getStateChan,e.getStateDisplayName=a.getStateDisplayName,e.isActive=a.isActive,e.menuOff=!1,e.logout=function(){r.expire(),i.go("app.Secure")},e.turnOffMenu=function(){e.menuOff=!0},e.turnOnMenu=function(){e.menuOff=!1},e.toggleMenu=function(){e.menuOff=!e.menuOff},t.$watch("portalNavs",function(t){t&&0!=t.length?e.turnOffMenu():e.turnOnMenu()},!0)}]),angular.module("StarterPack.AppShared").factory("AppUtils",["$http","$location","$q","$state","$timeout","$uibModal","AppConfig",function(e,t,i,n,a,r,o){return window.app={},app.utils={requestInProcess:0,storagePrefix:o.StoragePrefix+".",initialize:function(){this._initialize()},_initialize:function(){this._IEPlaceholder(),String.prototype.lowerFirstLetter=function(){return this.charAt(0).toLowerCase()+this.slice(1)},Array.prototype.removeFirst=function(){return this.slice(1,this.length)},Array.prototype.remove=function(e){var t=this.indexOf(e);return t>-1?this.splice(t,1):this}},_IEPlaceholder:function(){var e=document,t=e.getElementsByTagName("input"),i="placeholder"in e.createElement("input"),n=function(e){var t=e.getAttribute("placeholder"),i=e.defaultValue;""==i&&(e.value=t),$(e).on("focus",function(){e.value===t&&(this.value="")}),$(e).on("blur",function(){""===e.value&&(this.value=t)})};if(!i)for(var a=0,r=t.length;r>a;a++){var o=t[a],s=o.getAttribute("placeholder");"text"!==o.type&&"password"!==o.type||!s||n(o)}},setLocalStorageItem:function(e,t){localStorage.setItem(this.storagePrefix+e,JSON.stringify(t))},getLocalStorageItem:function(e){return $.parseJSON(localStorage.getItem(this.storagePrefix+e))},getSessionItem:function(e){return $.parseJSON(sessionStorage.getItem(this.storagePrefix+e))},setSessionItem:function(e,t){sessionStorage.setItem(this.storagePrefix+e,JSON.stringify(t))},clearSession:function(){sessionStorage.clear()},removeSessionItem:function(e){sessionStorage.removeItem(this.storagePrefix+e)},doLoading:function(){this.requestInProcess++,this.showLoading()},whenLoaded:function(){this.requestInProcess--,0==this.requestInProcess&&this.hideLoading()},showLoading:function(){$("#spinner").show()},hideLoading:function(){$("#spinner").hide()},alert:function(e,t){t=t||"";var i="";i+='<div class="modal-content">',i+='  <div class="modal-header ng-scope">',i+='      <h3 class="modal-title">'+t+"</h3>",i+="  </div>",i+='  <div class="modal-body clearfix">',i+='    <div class="col-sm-12">',i+="      "+e,i+="    </div>",i+="  </div>",i+='  <div class="modal-footer ng-scope">',i+='      <button class="btn btn-primary" style="width:100%;" type="button" ng-click="ok()">Ok</button>',i+="  </div>",i+="</div>";var n=r.open({animation:!0,template:i,controller:function(e,t){e.ok=function(){t.dismiss("cancel")}},size:"sm"});return n.result},confirm:function(e,t,i){var n="";n+='<div class="modal-content">',n+='  <div class="modal-header ng-scope">',n+='      <h3 class="modal-title">'+e+"</h3>",n+="  </div>",n+='  <div class="modal-body clearfix">',n+='    <div class="col-sm-12">',n+="      "+t,n+="    </div>",n+="  </div>",n+='  <div class="modal-footer ng-scope">',n+='      <button class="btn btn-primary" type="button" ng-click="ok()">Confirm</button>',n+='      <button class="btn btn-warning" type="button" ng-click="cancel()">Cancel</button>',n+="  </div>",n+="</div>";var a=r.open({animation:!0,template:n,controller:function(e,t,i){e.ok=function(){t.close(i())},e.cancel=function(){t.dismiss("cancel")}},size:"sm",resolve:{func:function(){return i}}});return a.result}},app.utils}]);var MyApp=angular.module("StarterPack",["ui.router","rzModule","StarterPack.Secure","StarterPack.Portal","StarterPack.AppShared"]).config(["$httpProvider",function(e){delete e.defaults.headers.common["X-Requested-With"],e.defaults.headers.common["Content-Type"]="application/json",e.interceptors.push(["$q",function(e){return{request:function(e){return app.utils.doLoading(),e},response:function(e){return app.utils.whenLoaded(),e},responseError:function(t){return app.utils.whenLoaded(),401==t.status,e.reject(t)}}}])}]).run(["$rootScope","$state","$stateParams","AppUtils",function(e,t,i,n){e.$state=t,e.$stateParams=i,window.state=t,n.initialize(),window.AppUtils=n}]);angular.module("StarterPack").controller("AppController",["$scope","$rootScope","$state","AppUtils","SessionService",function(e,t,i,n,a){e.getTime=function(t){var i=new Date(t);return i.getFullYear()+"-"+e.paddingLeft(i.getMonth()+1,"0",2)+"-"+e.paddingLeft(i.getDate(),"0",2)},e.paddingLeft=function(e,t,i){e=e.toString();for(var n=i-e.length,a="";n>0;)a+=t,n--;return a+e},a.restore(),t.userSession&&i.go("app.Portal.AppManager.ApplicationList")}]),angular.module("StarterPack").config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("app",{url:"",templateUrl:"app/app.html",controller:"AppController","abstract":!0}).state("app.Secure",{url:"/Secure",templateUrl:"app/components/Secure/Secure.html",controller:"SecureController"}).state("app.Portal",{url:"/Portal",templateUrl:"app/components/Portal/Portal.html",controller:"PortalController"}),t.otherwise("Secure")}]),angular.module("StarterPack.Portal").config(["$stateProvider","$urlRouterProvider",function(e){e.state("app.Portal.AppManager",{url:"/AppManager",templateUrl:"app/components/Portal/AppManager/AppManager.html",controller:"AppManagerController",getName:function(){return"Application Management"}})}]),angular.module("StarterPack.Portal.AppManager").config(["$stateProvider","$urlRouterProvider",function(e){e.state("app.Portal.AppManager.ApplicationList",{url:"/apps",templateUrl:"app/components/Portal/AppManager/ApplicationList/ApplicationList.html",controller:"ApplicationListController",getName:function(){return"Applications"}}).state("app.Portal.AppManager.ApplicationEditor",{url:"/apps/:appId",templateUrl:"app/components/Portal/AppManager/ApplicationEditor/ApplicationEditor.html",controller:"ApplicationEditorController"})}]),angular.module("StarterPack.Portal.AppManager").config(["$stateProvider","$urlRouterProvider","AppConfig",function(e,t,i){e.state("app.Portal.AppManager.ApplicationEditor.ApplicationInfo",{url:"/Info",templateUrl:"app/components/Portal/AppManager/ApplicationEditor/ApplicationInfo/ApplicationInfo.html",controller:"ApplicationInfoController",getName:function(){var e=app.utils.getLocalStorageItem(i.NavNames.APP_NAME);return e},previous:"app.Portal.AppManager.ApplicationList"}).state("app.Portal.AppManager.ApplicationEditor.Dashboard",{url:"/Dashboard",templateUrl:"app/components/Portal/AppManager/ApplicationEditor/Dashboard/Dashboard.html",controller:"DashboardController",getName:function(){return"Dashboard"},previous:"app.Portal.AppManager.ApplicationEditor.ApplicationInfo"}).state("app.Portal.AppManager.ApplicationEditor.UserManager",{url:"/UserManager",templateUrl:"app/components/Portal/AppManager/ApplicationEditor/UserManager/UserManager.html",controller:"UserManagerController",getName:function(){return"User Management"},previous:"app.Portal.AppManager.ApplicationEditor.ApplicationInfo"}).state("app.Portal.AppManager.ApplicationEditor.UserGroupManager",{url:"/UserGroupManager",templateUrl:"app/components/Portal/AppManager/ApplicationEditor/UserGroupManager/UserGroupManager.html",controller:"UserGroupManagerController",getName:function(){return"Group Management"},previous:"app.Portal.AppManager.ApplicationEditor.ApplicationInfo"}).state("app.Portal.AppManager.ApplicationEditor.ModelManager",{url:"/ModelManager",templateUrl:"app/components/Portal/AppManager/ApplicationEditor/ModelManager/ModelManager.html",controller:"ModelManagerController","abstract":!0,redirectTo:"app.Portal.AppManager.ApplicationEditor.ModelManager.ModelList",getName:function(){return"Model Management"},previous:"app.Portal.AppManager.ApplicationEditor.ApplicationInfo"}).state("app.Portal.AppManager.ApplicationEditor.FirmwareManager",{url:"/FirmwareManager",templateUrl:"app/components/Portal/AppManager/ApplicationEditor/FirmwareManager/FirmwareManager.html",controller:"FirmwareManagerController","abstract":!0,getName:function(){return"Firmware Management"},previous:"app.Portal.AppManager.ApplicationEditor.ApplicationInfo",redirectTo:"app.Portal.AppManager.ApplicationEditor.FirmwareManager.FirmwareNamespaceList"}).state("app.Portal.AppManager.ApplicationEditor.DeviceManager",{url:"/DeviceManager",templateUrl:"app/components/Portal/AppManager/ApplicationEditor/DeviceManager/DeviceManager.html",controller:"DeviceManagerController",getName:function(){return"Device Management"},previous:"app.Portal.AppManager.ApplicationEditor.ApplicationInfo"}).state("app.Portal.AppManager.ApplicationEditor.VirtualDevice",{url:"/VirtualDevice",templateUrl:"app/components/Portal/AppManager/ApplicationEditor/VirtualDevice/VirtualDevice.html",controller:"VirtualDeviceController",getName:function(){return"Device Simulation"},previous:"app.Portal.AppManager.ApplicationEditor.ApplicationInfo"}).state("app.Portal.AppManager.ApplicationEditor.DataAnalysis",{url:"/DataAnalysis",templateUrl:"app/components/Portal/AppManager/ApplicationEditor/DataAnalysis/DataAnalysis.html",controller:"DataAnalysisController",getName:function(){return"Data Analysis"},previous:"app.Portal.AppManager.ApplicationEditor.ApplicationInfo"}).state("app.Portal.AppManager.ApplicationEditor.Settings",{url:"/Settings",templateUrl:"app/components/Portal/AppManager/ApplicationEditor/Settings/Settings.html",controller:"SettingsController",getName:function(){return"Settings"},previous:"app.Portal.AppManager.ApplicationEditor.ApplicationInfo"}).state("app.Portal.AppManager.ApplicationEditor.Observation",{url:"/Observation",templateUrl:"app/components/Portal/AppManager/ApplicationEditor/Observation/Observation.html",controller:"ObservationController",getName:function(){return"Observation"},previous:"app.Portal.AppManager.ApplicationEditor.ApplicationInfo"})}]),angular.module("StarterPack.Portal.AppManager.FirmwareManager").config(["$stateProvider","$urlRouterProvider","AppConfig",function(e,t,i){e.state("app.Portal.AppManager.ApplicationEditor.FirmwareManager.FirmwareNamespaceList",{url:"/FirmwareNamespaceList",templateUrl:"app/components/Portal/AppManager/ApplicationEditor/FirmwareManager/FirmwareNamespaceList/FirmwareNamespaceList.html",controller:"FirmwareNamespaceListController",getName:function(){return"FirmwareNamespaces"},previous:"app.Portal.AppManager.ApplicationEditor.FirmwareManager"}).state("app.Portal.AppManager.ApplicationEditor.FirmwareManager.FirmwareNamespaceInfo",{url:":firmwareNamespaceId/FirmwareNamespaceInfo",templateUrl:"app/components/Portal/AppManager/ApplicationEditor/FirmwareManager/FirmwareNamespaceInfo/FirmwareNamespaceInfo.html",controller:"FirmwareNamespaceInfoController",getName:function(){var e=app.utils.getLocalStorageItem(i.NavNames.FIRMWARE_NAMESPACE_NAME);return e},previous:"app.Portal.AppManager.ApplicationEditor.FirmwareManager.FirmwareNamespaceList"})}]),angular.module("StarterPack.Portal.AppManager.ModelManager").config(["$stateProvider","$urlRouterProvider","AppConfig",function(e,t,i){e.state("app.Portal.AppManager.ApplicationEditor.ModelManager.ModelList",{url:"/ModelList",templateUrl:"app/components/Portal/AppManager/ApplicationEditor/ModelManager/ModelList/ModelList.html",controller:"ModelListController",getName:function(){return"Models"},previous:"app.Portal.AppManager.ApplicationEditor.ModelManager"}).state("app.Portal.AppManager.ApplicationEditor.ModelManager.ModelInfo",{url:"/:modelId/ModelInfo",templateUrl:"app/components/Portal/AppManager/ApplicationEditor/ModelManager/ModelInfo/ModelInfo.html",controller:"ModelInfoController",getName:function(){var e=app.utils.getLocalStorageItem(i.NavNames.MODEL_NAME);return e},previous:"app.Portal.AppManager.ApplicationEditor.ModelManager.ModelList"})}]),angular.module("StarterPack").run(["$templateCache",function(e){e.put("app/app.html",'<div class="app"><div id="spinner" style="display:none;"><div class="loader">Loading...</div></div><div ui-view=""></div></div>'),e.put("app/components/Portal/Portal.html",'<div class="app-portal skin-black" id="wrapper" ng-init="portalInit()"><header class="header"><a href="index.html" class="logo">Starter Pack</a><nav class="navbar navbar-static-top" role="navigation"><div class="navbar-right"><ul class="nav navbar-nav"><li class="dropdown messages-menu"><a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-envelope"></i></a></li><li class="dropdown tasks-menu"><a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-tasks"></i></a></li><li class="dropdown user user-menu" uib-dropdown=""><a href="#" class="dropdown-toggle" uib-dropdown-toggle=""><i class="fa fa-user"></i> <span>{{credential.userName}} <i class="caret"></i></span></a><ul class="dropdown-menu dropdown-custom dropdown-menu-right"><li><a ng-click="logout()"><i class="fa fa-ban fa-fw pull-right"></i> Logout</a></li></ul></li></ul></div></nav></header><div class="wrapper row-offcanvas row-offcanvas-left"><aside class="left-side" style="height: 100%;"><section class="sidebar sidebar-left" ng-class="{\'shrink\': menuOff && portalNavs.length > 0}"><a uib-tooltip="Toggle Menu" tooltip-placement="right" ng-click="toggleMenu()" class="toggle-button" ng-class="{\'active\': !menuOff}"><span class="fa fa-bars"></span></a><ul class="sidebar-menu"><li><a ui-sref="app.Portal.AppManager.ApplicationList" class="active" uib-tooltip="Applications" tooltip-placement="right"><span class="fa fa-cloud"></span>Applications</a></li></ul></section><section class="sidebar sidebar-right"><ul class="sidebar-menu"><li ng-repeat="nav in portalNavs | orderBy: \'order\'" ng-class="{\'active\':isActive(nav.state.name)}" ng-if="!nav.hidden"><a ng-click="$state.go(!nav.state.abstract? nav.state.name: nav.state.redirectTo, $state.params)"><i class="fa fa-fw" ng-class="nav.icon"></i> {{nav.name}}</a><ul class="nav nav-second-level" uib-collapse="!isActive(nav.state.name)"><li ng-repeat="subNav in nav.subViews | orderBy: \'order\'" ng-if="!subNav.hidden" ng-class="{\'active\': isActive(subNav.state.name)}"><a ng-click="$state.go(!subNav.state.abstract? subNav.state.name: subNav.state.redirectTo, $state.params)">{{subNav.name}}</a><ul class="nav nav-third-level" uib-collapse="!subNav._active"><li ng-if="!thirdNav.hidden" ng-repeat="thirdNav in subNav.subViews | orderBy: \'-order\'" ng-class="{\'active\': isActive(thirdNav.state.name)}"><a ng-click="$$state.go(!thirdNav.state.abstract? thirdNav.state.name: thirdNav.state.redirectTo, $state.params)">{{thirdNav.name}}</a></li></ul></li></ul></li></ul></section></aside><aside class="right-side shrink"><section class="content"><ol class="breadcrumb"><li ng-repeat="nav in getStateChan($state.current)"><a ui-sref="{{!nav.abstract? nav.name: nav.redirectTo}}(state.params)">{{nav.getName()}}</a></li></ol><div class="row portal-row" ng-if="$state.current.description && $state.current.description!=\'\'" )=""><div class="module-description">{{$state.current.description}}</div></div><div><div ui-view="" class="portal-content-body"></div></div></section></aside></div></div>'),e.put("app/components/Secure/Secure.html",'<div class="app-secure"><div class="app-logo-bg"><span class="fa fa-paper-plane-o app-icon"></span> <span>Starter Pack Portal</span></div><div class="login-form-box"><form name="loginForm" class="form-signin" role="form" novalidate="" ng-submit="login(credentials)"><div class="form-item-header">User Login</div><fieldset><div class="input-group margin-bottom-sm" ng-class="nameInputFoucsClass"><span class="input-group-addon"><i class="fa fa-user fa-fw"></i></span> <input type="text" class="form-control" placeholder="Username" name="username" ng-model="credentials.username" required="" autofocus=""></div><div class="input-group margin-bottom-sm" ng-class="pwdInputFoucsClass"><span class="input-group-addon"><i class="fa fa-unlock fa-fw"></i></span> <input type="password" class="form-control" name="password" placeholder="Password" ng-model="credentials.password" required=""></div><div class="margin-bottom-sm"><input type="checkbox" id="rememberMe" name="rememberMe"> <label for="rememberMe">Remember Me<switchery type="checkbox" ng-model="credentials.rememberMe" yes-text="yes" no-text="no"></switchery></label></div><div class="item-submit"><button type="submit" class="btn btn-danger item-submit-button"><span>Login</span></button></div></fieldset></form></div><div class="tip-wrap"><a id="register" class="ui-commandlink ui-widget" ng-click="register()"><span>Registration</span></a></div><div class="powered-by">Powered by <span><img class="login-logo" src="images/kiicloud-logo.png" width="60px"></span>Kii China Team<div class="version-msg">Version 1.0b</div></div><div class="hidden"><div class="modal-content" id="registerModal"><div class="modal-header ng-scope"><h3 class="modal-title">User Registration</h3></div><div class="modal-body clearfix app-secure-userlogin"><div class="input-group margin-bottom-sm" ng-class="nameInputFoucsClass"><span class="input-group-addon"><i class="fa fa-user fa-fw"></i></span> <input type="text" class="form-control" placeholder="Username" name="username" ng-model="credentials.userID" required="" autofocus=""></div><div class="input-group margin-bottom-sm" ng-class="pwdInputFoucsClass"><span class="input-group-addon"><i class="fa fa-unlock fa-fw"></i></span> <input type="password" class="form-control" name="password" placeholder="Password" ng-model="credentials.password" required=""></div><div class="item-submit"><button type="submit" class="btn btn-danger item-submit-button" ng-click="register(credentials)"><span>Register</span></button></div><div class="item-submit"><button type="submit" class="btn btn-danger item-submit-button" ng-click="cancel()"><span>Cancel</span></button></div></div></div></div></div>'),e.put("app/components/Portal/AppManager/AppManager.html",'<div class="app-appmanager" ng-init="init()"><div ui-view=""></div></div>'),e.put("app/components/AppShared/directives/app-select/app-select.template.html",'<div class="app-select" ng-class="myClass" uib-dropdown=""><button id="search-filter" ng-disabled="disabled" type="button" class="btn btn-default" uib-dropdown-toggle="">{{selectedOption[setting.text]}}<span class="caret"></span></button><ul class="dropdown-menu" role="menu" aria-labelledby="search-filter"><li ng-repeat="option in options" role="menuitem" ng-click="selectOption(option)"><a>{{option[setting.text]}}</a></li></ul></div>'),e.put("app/components/AppShared/directives/switchery/switchery.template.html",'<div class="switchery pull-right" ng-class="{\'on\':reverse?!on: on}" ng-click="switch()"><div class="selector"><div class="option">{{yesText}}</div><div class="option">{{noText}}</div></div><div class="slider"><div class="dile"></div><div class="dile"></div><div class="dile"></div></div></div>'),e.put("app/components/AppShared/directives/text-limit/text-limit.template.html",'<div class="input-group"><input type="{{type || \'text\'}}" ng-model="ngModel" class="form-control"> <span class="input-group-addon">{{!ngModel? max: (max - ngModel.length)}}</span></div>'),e.put("app/components/Portal/AppManager/ApplicationEditor/ApplicationEditor.html",'<div class="app-appmanager-applicationeditor" ng-init="init()"><div ui-view=""></div></div>'),e.put("app/components/Portal/AppManager/ApplicationList/ApplicationList.html",'<div class="app-applicationlist" ng-init="init()"><div class="new-tile" ng-click="openCreateModal()"><span class="fa fa-plus"></span></div><div class="app-tile" ng-repeat="app in myApps"><div class="module-top"><div class="overlay" ng-click="viewApp(app)"><div class="viewReport">View</div></div><div class="outputs-content-img"><img ng-src="{{\'images/cloud.png\'}}"></div></div><div class="moduleDetails"><div class="per-info"><span class="info">{{app.getAppName()}}</span></div></div><div class="modulesActionsTop"><i class="fa fa-pencil-square-o" uib-tooltip="Edit" uib-tooltip-trigger="mouseenter" uib-tooltip-placement="top" ng-click="editTag(tag)"></i> <i class="fa fa-trash-o" uib-tooltip="Delete" uib-tooltip-trigger="mouseenter" uib-tooltip-placement="top" ng-click="deleteTag(tag)"></i></div></div></div><script type="text/ng-template" id="app.Portal.AppManager.ApplcationList.CreateModal"><div class="modal-content" ng-init="init()"> <div class="modal-header"> <h3 class="modal-title">Create Application</h3> </div> <div class="modal-body clearfix"> <div class="col-sm-12"> <div class="form-group clearfix"> <label>Application Name</label> <input ng-model="appBO.appName" type="text" class="form-control" placeholder="Application Name" /> </div> <div class="form-group clearfix"> <label>Server</label> <app-select options="serverOptions" selected-model="appBO.server" value-only="true"></app-select> </div> <div class="form-group clearfix"> <label>Application Plateform</label> <div><label ng-repeat="platform in platforms" style="margin-right: 10px;"><input type="checkbox" ng-model="platform._checked" /> {{platform.text}}</label></div> </div> </div> </div> <div class="modal-footer ng-scope"> <button class="btn btn-success" type="button" ng-click="ok()">Create</button> <button class="btn btn-danger" type="button" ng-click="cancel()">Cancel</button> </div> </div></script>'),e.put("app/components/Portal/AppManager/ApplicationEditor/ApplicationInfo/ApplicationInfo.html",'<div class="app-applicationinfo"><div class="row"><div class="col-lg-8"><div class="panel"><div class="panel-heading">Application Connection Information</div><div class="panel-body"><div class="form-group"><label>Application Name</label> <input class="form-control" ng-model="myApp._appName" ng-disabled="true"></div><div class="form-group"><label>Application ID</label> <input class="form-control" ng-model="myApp._appID" ng-disabled="true"></div><div class="form-group"><label>Application Key</label> <input class="form-control" ng-model="myApp._appKey" ng-disabled="true"></div><div class="form-group"><label>Client ID</label> <input class="form-control" ng-model="myApp._clientID" ng-disabled="true"></div><div class="form-group"><label>Client Secret</label> <input class="form-control" ng-model="myApp._clientSecret" ng-disabled="true"></div></div></div></div><div class="col-lg-4"><div class="panel"><div class="panel-heading">Application Basic Information</div><div class="panel-body"><div class="form-group"><label>Server</label> <input class="form-control" ng-model="myApp._site" ng-disabled="true"></div><div class="form-group"><label>Server</label> <input class="form-control" ng-model="myApp._platforms" ng-disabled="true"></div></div></div></div></div></div>'),e.put("app/components/Portal/AppManager/ApplicationEditor/Dashboard/Dashboard.html",'<div class="app-portal-dashboard"><div style="width:100px; height:100px; background:red;" context-menu="predicatorMenu"></div></div>'),e.put("app/components/Portal/AppManager/ApplicationEditor/DataAnalysis/DataAnalysis.html",'<div class="app-portal-dataanalysis"><div ui-view=""></div></div>'),e.put("app/components/Portal/AppManager/ApplicationEditor/DeviceManager/DeviceDetailContent.template.html",'<div class="detail-content" uib-collapse="isCollapse"><uib-tabset><uib-tab heading="General"><table class="sub-table"><tr><td>_thingType</td><td><text-limit max="100" ng-model="device.fields._thingType"></text-limit></td><td>_vendor</td><td><text-limit max="100" ng-model="device.fields._vendor"></text-limit></td></tr><tr><td>_lot</td><td><text-limit max="100" ng-model="device.fields._lot"></text-limit></td><td>_productName</td><td><text-limit max="100" ng-model="device.fields._productName"></text-limit></td></tr><tr><td>_firmwareVersion</td><td><text-limit max="100" ng-model="device.fields._firmwareVersion"></text-limit></td><td>_disabled</td><td><switchery ng-model="device._disabled" yes-text="Yes" no-text="No"></switchery></td></tr></table></uib-tab><uib-tab heading="Additional"><table class="sub-table"><tr><td>_stringField1</td><td><text-limit max="100" ng-model="device.fields._stringField1"></text-limit></td><td>_numberField1</td><td><text-limit type="number" max="100" ng-model="device.fields._numberField1"></text-limit></td></tr><tr><td>_stringField2</td><td><text-limit max="100" ng-model="device.fields._stringField2"></text-limit></td><td>_numberField2</td><td><text-limit type="number" max="100" ng-model="device.fields._numberField2"></text-limit></td></tr><tr><td>_stringField3</td><td><text-limit max="100" ng-model="device.fields._stringField3"></text-limit></td><td>_numberField3</td><td><text-limit type="number" max="100" ng-model="device.fields._numberField3"></text-limit></td></tr><tr><td>_stringField4</td><td><text-limit max="100" ng-model="device.fields._stringField4"></text-limit></td><td>_numberField4</td><td><text-limit type="number" max="100" ng-model="device.fields._numberField4"></text-limit></td></tr><tr><td>_stringField5</td><td><text-limit max="100" ng-model="device.fields._stringField5"></text-limit></td><td>_numberField5</td><td><text-limit type="number" max="100" ng-model="device.fields._numberField5"></text-limit></td></tr></table></uib-tab><uib-tab heading="Custom"><div class="json-editor" style="height:300px; width:100%;"></div></uib-tab></uib-tabset><div class="tab-pane-footer clearfix"><div class="clearfix pull-right"><button class="btn btn-danger" ng-click="deleteDevice(device)"><span class="fa fa-remove"></span>Delete</button> <button class="btn btn-success" ng-click="saveDevice(device)"><span class="fa fa-cloud-upload"></span>Update</button></div></div></div>'),e.put("app/components/Portal/AppManager/ApplicationEditor/DeviceManager/DeviceManager.html",'<div class="app-portal-devicemanager" ng-init="init()"><div class="panel"><div class="panel-heading"><div class="row"><div class="col-xs-8"><app-select options="searchOptions" selected-model="searchParam.field" value-only="true"></app-select><input type="text" class="form-control search-field" ng-model="searchParam.value"> <button class="btn btn-info" ng-click="searchDevices(searchParam)">Search</button></div><div class="col-xs-4"><button class="btn btn-success pull-right" ng-click="addDevice()"><span class="fa fa-plus"></span> Add Thing</button></div></div></div></div><table st-table="firmwares" class="table table-striped"><thead><tr><th><input type="checkbox"></th><th>_deviceID</th><th>_vendorThingID</th><th>Model</th><th>Firmware Version</th><th>_online</th><th>_disabled</th><th>_created</th></tr></thead><tbody><tr><td colspan="8" style="padding:0px;"><div ng-include="\'app/components/Portal/AppManager/ApplicationEditor/DeviceManager/NewDeviceContent.template.html\'"></div></td></tr><tr ng-repeat-start="device in myDevices" ng-click="deviceEdit[device.getThingID()] = !deviceEdit[device.getThingID()]"><td><input type="checkbox"></td><td>{{device.getThingID()}}</td><td>{{device.getVendorThingID()}}</td><td>{{device._productionName}}</td><td>{{device._firmwareVersion}}</td><td>{{device._online}}</td><td>{{device._disabled}}</td><td>{{getTime(device.getCreated())}}</td></tr><tr ng-repeat-end=""><td colspan="8" style="padding:0px;"><device-detail device="device" is-collapse="deviceEdit[device.getThingID()]"></device-detail></td></tr><tr><td colspan="8" class="load-more" ng-click="loadMore()">Load More</td></tr></tbody></table></div>'),e.put("app/components/Portal/AppManager/ApplicationEditor/DeviceManager/NewDeviceContent.template.html",'<div id="new-device" class="detail-content" uib-collapse="hideNewDevice"><uib-tabset><uib-tab heading="General"><table class="sub-table"><tr><td>_vendorThingID</td><td><text-limit max="200" ng-model="newDevice.fields._vendorThingID"></text-limit></td><td>_password</td><td><text-limit max="200" ng-model="newDevice.fields._password"></text-limit></td></tr><tr><td>_lot</td><td><text-limit max="100" ng-model="newDevice.fields._lot"></text-limit></td><td>_productName</td><td><text-limit max="100" ng-model="newDevice.fields._productName"></text-limit></td></tr><tr><td>_firmwareVersion</td><td><text-limit max="100" ng-model="newDevice.fields._firmwareVersion"></text-limit></td><td>_vendor</td><td><text-limit max="100" ng-model="newDevice.fields._vendor"></text-limit></td></tr></table></uib-tab><uib-tab heading="Additional"><table class="sub-table"><tr><td>_stringField1</td><td><text-limit max="100" ng-model="newDevice.fields._stringField1"></text-limit></td><td>_numberField1</td><td><text-limit type="number" max="100" ng-model="newDevice.fields._numberField1"></text-limit></td></tr><tr><td>_stringField2</td><td><text-limit max="100" ng-model="newDevice.fields._stringField2"></text-limit></td><td>_numberField2</td><td><text-limit type="number" max="100" ng-model="newDevice.fields._numberField2"></text-limit></td></tr><tr><td>_stringField3</td><td><text-limit max="100" ng-model="newDevice.fields._stringField3"></text-limit></td><td>_numberField3</td><td><text-limit type="number" max="100" ng-model="newDevice.fields._numberField3"></text-limit></td></tr><tr><td>_stringField4</td><td><text-limit max="100" ng-model="newDevice.fields._stringField4"></text-limit></td><td>_numberField4</td><td><text-limit type="number" max="100" ng-model="newDevice.fields._numberField4"></text-limit></td></tr><tr><td>_stringField5</td><td><text-limit max="100" ng-model="newDevice.fields._stringField5"></text-limit></td><td>_numberField5</td><td><text-limit type="number" max="100" ng-model="newDevice.fields._numberField5"></text-limit></td></tr></table></uib-tab><uib-tab heading="Custom"><div class="json-editor" style="height:300px; width:100%;"></div></uib-tab></uib-tabset><div class="tab-pane-footer clearfix"><div class="clearfix pull-right"><button class="btn btn-danger" ng-click="cancelNewDevice()"><span class="fa fa-remove"></span>Cancel</button> <button class="btn btn-success" ng-click="saveDevice(newDevice)"><span class="fa fa-cloud-upload"></span>Save</button></div></div></div>'),e.put("app/components/Portal/AppManager/ApplicationEditor/FirmwareManager/FirmwareManager.html",'<div class="app-portal-firmwaremanager" ng-init="init()"><div ui-view=""></div></div>'),e.put("app/components/Portal/AppManager/ApplicationEditor/ModelManager/ModelManager.html",'<div class="app-portal-modelmanager" init="init()"><div ui-view=""></div></div>'),e.put("app/components/Portal/AppManager/ApplicationEditor/Observation/Observation.html",'<div class="app-portal-observation" ng-init="init()"><div></div><div class="tag-container"><device-board tag="tag" ng-repeat="tag in displayedTags"></device-board></div></div>'),e.put("app/components/Portal/AppManager/ApplicationEditor/Settings/Settings.html",'<div class="app-portal-settings"><div ui-view=""></div></div>'),e.put("app/components/Portal/AppManager/ApplicationEditor/UserGroupManager/UserGroupManager.html",'<div class="app-portal-usergroupmanager"><div ui-view=""></div></div>'),e.put("app/components/Portal/AppManager/ApplicationEditor/UserManager/UserManager.html",'<div class="app-portal-usermanager" ng-init="init()"><div ng-switch="" on="message.status"><div class="alert alert-success h4" role="alert" ng-switch-when="1">Created user <strong>{{message.loginName}}</strong> successfully.</div><div class="alert alert-success h4" role="alert" ng-switch-when="2">User <strong>{{message.loginName}}</strong> updated successfully.</div><div class="alert alert-success h4" role="alert" ng-switch-when="3">User <strong>{{message.loginName}}</strong> suspended</div><div class="alert alert-success h4" role="alert" ng-switch-when="4">User <strong>{{message.loginName}}</strong> activated</div><div class="alert alert-success h4" role="alert" ng-switch-when="5">Password reset email sent for user <strong>{{message.loginName}}</strong> .</div><div class="alert alert-success h4" role="alert" ng-switch-when="6">Password reset SMS sent for user <strong>{{message.loginName}}</strong> .</div><div class="alert alert-success h4" role="alert" ng-switch-when="7">User <strong>{{message.loginName}}</strong> deleted.</div><div class="alert alert-warning h4" role="alert" ng-switch-when="8"><span>Are you sure you want to delete this user <strong>{{message.loginName}}</strong>?</span> <button class="btn btn-info" ng-click="cancelDelete()"><span class="fa fa-remove"></span> Cancel</button> <button class="btn btn-danger" ng-click="deleteUser()"><span class="fa fa-trash-o"></span> Delete</button></div><div class="alert alert-warning h4" role="alert" ng-switch-when="9">User <strong>{{message.loginName}}</strong> has been suspended.</div></div><div class="panel"><div class="panel-heading clearfix"><button type="button" class="btn btn-default col-sm-1" ng-click="init()"><span class="fa fa-refresh"></span></button> <button class="btn btn-primary col-sm-2" ng-click="expandAddUser()"><span class="fa fa-user-plus"></span> Add user</button></div><div class="panel-body" uib-collapse="!isExpanded"><form name="newUserForm" action="" class="form-inline clearfix" role="form"><div class="form-group col-md-2"><label class="sr-only" for="new_loginName">Login</label> <input type="text" class="form-control" id="new_loginName" placeholder="Login name" ng-model="newUser.loginName"></div><div class="form-group col-md-2"><label class="sr-only" for="new_password">Password</label> <input type="password" class="form-control" id="new_password" placeholder="Password" ng-model="newUser.password"></div><div class="form-group col-md-2"><label class="sr-only" for="new_displayName">Display name</label> <input type="text" class="form-control" id="new_displayName" placeholder="Display name" ng-model="newUser.displayName"></div><div class="form-group col-md-2"><label class="sr-only" for="new_emailAddress">Email</label> <input type="text" class="form-control" id="new_emailAddress" placeholder="Email" ng-model="newUser.emailAddress"></div><div class="form-group col-md-2"><label class="sr-only" for="new_phoneNumber">Phone</label> <input type="text" class="form-control" id="new_phoneNumber" placeholder="Phone" ng-model="newUser.phoneNumber"></div><div class="form-group col-md-2"><label class="sr-only" for="new_country">Country</label><select class="form-control sm" id="new_country" ng-model="newUser.country" ng-options="c.code as c.name for c in countryList"><option value="" disabled="">Select a country</option></select></div></form><div validate-message="" status="newUser._status" class="col-md-10"></div><div class="panel-bottom pull-left col-md-2"><button class="btn btn-danger" ng-click="cancelAddUser(newUser)"><span class="fa fa-remove"></span> Cancel</button> <button class="btn btn-success" ng-click="addUser(newUser)"><span class="fa fa-user-plus"></span> Save</button></div></div></div><table st-table="firmwares" class="table table-striped"><thead><tr><th></th><th>Login</th><th>Password</th><th>Display Name</th><th>Email</th><th>Phone</th><th>Country</th><th>Status</th><th>Created</th><th>Modified</th></tr></thead><tbody><tr ng-repeat-start="user in users track by user._info.userID" ng-click="toggleEdit(user)"><td><input type="checkbox" ng-model="user._onEdit" ng-click="toggleEdit(user)"></td><td>{{user._info.loginName}}</td><td>********</td><td>{{user._info.displayName}}</td><td>{{user._info.emailAddress}}</td><td>{{user._info.phoneNumber}}</td><td>{{user._info.country|country}}</td><td>{{user._info._disabled?\'Suspended\':\'Active\'}}</td><td>{{user._info.createdAt|dateOnly}}</td><td>{{user._info.modifiedAt|dateOnly}}</td></tr><tr ng-repeat-end=""><td colspan="10" style="padding:0px;"><div class="detail-content" uib-collapse="!user._onEdit"><uib-tabset><uib-tab heading="Account Details"><div class="row"><form action="" class="form-horizontal" role="form"><div class="form-group"><label class="col-sm-2 control-label">User ID</label><div class="col-sm-5"><input class="form-control" readonly="" value="{{::user._field.userID}}"></div></div><div class="form-group"><label class="col-sm-2 control-label">Status</label><div class="col-sm-5"><input class="form-control" readonly="" value="{{user._field._disabled?\'Suspended\':\'Active\'}}"></div></div><div class="form-group"><label class="col-sm-2 control-label">Login Name</label><div class="col-sm-5"><input class="form-control" ng-model="user._field.loginName"></div></div><div class="form-group"><label class="col-sm-2 control-label">Display Name</label><div class="col-sm-5"><input class="form-control" ng-model="user._field.displayName"></div></div><div class="form-group"><label class="col-sm-2 control-label">Email</label><div class="col-sm-5"><input class="form-control" ng-model="user._field.emailAddress"></div><div class="col-sm-2 hide"><label class="control-label success">Verified</label></div></div><div class="form-group"><label class="col-sm-2 control-label">Phone</label><div class="col-sm-5"><input class="form-control" ng-model="user._field.phoneNumber"></div><div class="col-sm-2 hide"><label class="control-label success">Verified</label></div></div><div class="form-group"><label class="col-sm-2 control-label">Country</label><div class="col-sm-5"><select class="form-control" ng-model="user._field.country" ng-options="c.code as c.name for c in countryList"><option value="" disabled="">Select a country</option></select></div></div></form></div><div class="row"><div class="panel-bottom pull-left col-md-1"></div><div validate-message="" status="user._status"></div></div></uib-tab><uib-tab heading="Attribute"><div ng-jsoneditor="" ng-model="user._field.customAttributes" options="{\'mode\':\'code\'}" style="height:300px; width:100%;"></div></uib-tab><uib-tab heading="Groups" select="getGroupData(user)"><div class="clearfix"><div class="col-sm-6"><h4>Owner</h4><span ng-if="user._field.group.owner.length<1">Not an owner of any groups.</span><ul class="list-group"><li class="list-group-item" ng-repeat="r in user._field.group.owner track by groupID">{{r.name}}</li></ul></div><div class="col-sm-6"><h4>Member</h4><span ng-if="user._field.group.member.length<1">Not a member of any groups.</span><ul class="list-group"><li class="list-group-item" ng-repeat="r in user._field.group.member track by groupID">{{r.name}}</li></ul></div></div></uib-tab></uib-tabset><div class="tab-pane-footer clearfix"><div class="clearfix pull-right"><button class="btn btn-info" ng-click="toggleEdit(user)"><span class="fa fa-remove"></span> Cancel</button> <button class="btn btn-primary" ng-click="resetUserPassword(user, \'EMAIL\')"><span class="fa fa-envelope"></span> Reset Password (Email)</button> <button class="btn btn-primary" ng-click="resetUserPassword(user, \'SMS\')"><span class="fa fa-mobile"></span> Reset Password (Sms)</button> <button class="btn btn-warning" ng-click="toggleUserStatus(user)"><span class="fa fa-ban"></span> {{user._field._disabled?\'Activate\':\'Suspend\'}}</button> <button class="btn btn-danger" ng-click="confirmDeleteUser(user, $index)"><span class="fa fa-trash-o"></span> Delete</button> <button class="btn btn-success" ng-click="updateUser(user, $index)"><span class="fa fa-cloud-upload"></span> Update</button></div></div></div></td></tr><tr ng-if="query._paginationKey"><td colspan="10" class="load-more" ng-click="loadMore(query)">Load more users</td></tr></tbody></table></div>'),e.put("app/components/Portal/AppManager/ApplicationEditor/UserManager/UserManager.template.html",'<div class="panel-bottom pull-left"><div class="text-danger" ng-if="status.isEmpty">A login name, email or phone must be provided</div><div class="text-danger" ng-if="status.passwordError">Password is too short (must be at least 4 characters).</div><div class="text-danger" ng-if="status.loginError">Login name must be between three and 64 characters</div><div class="text-danger" ng-if="status.phoneError">Phone numbers must begin with a \'+\' and be at least 10 digits long.</div><div class="text-danger" ng-if="status.emailError">Invalid email address.</div></div>'),e.put("app/components/Portal/AppManager/ApplicationEditor/VirtualDevice/VirtualDevice.html",'<div class="app-portal-virtualdevice"><div ui-view=""></div></div>'),e.put("app/components/Portal/AppManager/ApplicationEditor/FirmwareManager/FirmwareNamespaceList/FirmwareNamespaceList.html",'<div class="app-portal-firmwaremanager-firmwarenamespacelist"><div class="new-tile" ng-click="openCreateModal()"><span class="fa fa-plus"></span></div><div class="app-tile" ng-repeat="firmwareNamespace in myFirmwareNamespaces"><div class="module-top"><div class="overlay" ng-click="viewFirmwareNamespace(firmwareNamespace)"><div class="viewReport">View</div></div><div class="outputs-content-img"><img ng-src="{{\'images/bulb.jpeg\'}}"></div></div><div class="moduleDetails"><div class="per-info"><span class="info">{{firmwareNamespace.getName()}}</span></div></div><div class="modulesActionsTop"><i class="fa fa-pencil-square-o" uib-tooltip="Edit" uib-tooltip-trigger="mouseenter" uib-tooltip-placement="top" ng-click="editFirmwareNamespace(tag)"></i> <i class="fa fa-trash-o" uib-tooltip="Delete" uib-tooltip-trigger="mouseenter" uib-tooltip-placement="top" ng-click="deleteFirmwareNamespace(tag)"></i></div></div></div><script type="text/ng-template" id="app.Portal.AppManager.ApplicationEditor.FirmwareManager.CreateModal"><div class="modal-content" ng-init="init()"> <div class="modal-header"> <h3 class="modal-title">Create Firmware Namespace</h3> </div> <div class="modal-body clearfix"> <div class="col-sm-12"> <div class="form-group clearfix"> <label>Firmware Namespace Name</label> <input ng-model="firmwareNamespaceBO.firmwareNamespaceName" type="text" class="form-control" placeholder="Firmware Namespace Name" /> </div> </div> </div> <div class="modal-footer ng-scope"> <button class="btn btn-success" type="button" ng-click="ok()">Create</button> <button class="btn btn-danger" type="button" ng-click="cancel()">Cancel</button> </div> </div></script>'),e.put("app/components/Portal/AppManager/ApplicationEditor/FirmwareManager/FirmwareNamespaceInfo/FirmwareNamespaceInfo.html",'<div class="app-portal-firmwaremanager-firmwarenamespaceinfo" ng-init="init()"><uib-tabset><uib-tab heading="Unpublished"><div class="row"><div class="col-md-6"><div class="new-firmware" ng-click="openFirmwareCreationModal()"><button>Create Firmware</button></div><div class="firmware" ng-repeat="firmware in unpublishedFirmwares | leftHalf"><div class="header"><div class="name"><span>{{firmware.getName()}}</span><div class="sub-title">Modified: {{getTime(firmware._modified)}}</div></div><div class="operators"><span class="fa fa-feed" uib-tooltip="Publish" ng-if="firmware.getDownloadURL()" ng-click="publishFirmware(firmware)"></span> <span class="fa fa-plane" uib-tooltip="Push" ng-if="firmware.getDownloadURL()" ng-click="pushFirmware(firmware)"></span> <span class="fa fa-edit" uib-tooltip="Edit" ng-click="openFirmwareEditorModal(firmware)"></span> <span class="fa fa-trash" uib-tooltip="Delete" ng-click="removeFirmware(firmware)"></span></div></div><div class="body"><div ng-if="firmware.getModels().join(\',\') || \'None models..\'.length>0"><div class="header">Applicable Models</div><div class="info">{{firmware.getModels().join(\',\') || \'None models..\'}}</div></div><div class="header">Release Notes</div><div class="info">{{firmware.getDescription()}}</div></div></div></div><div class="col-md-6"><div class="firmware" ng-repeat="firmware in unpublishedFirmwares | rightHalf"><div class="header"><div class="name"><span>{{firmware.getName()}}</span><div class="sub-title">Modified: {{getTime(firmware._modified)}}</div></div><div class="operators"><span class="fa fa-feed" uib-tooltip="Publish" ng-if="firmware.getDownloadURL()" ng-click="publishFirmware(firmware)"></span> <span class="fa fa-plane" uib-tooltip="Push" ng-if="firmware.getDownloadURL()" ng-click="pushFirmware(firmware)"></span> <span class="fa fa-edit" uib-tooltip="Edit" ng-click="openFirmwareEditorModal(firmware)"></span> <span class="fa fa-trash" uib-tooltip="Delete" ng-click="removeFirmware(firmware)"></span></div></div><div class="body"><div class="header">Applicable Models</div><div class="info">{{firmware.getModels().join(\',\') || \'None models..\'}}</div><div class="header">Release Notes</div><div class="info">{{firmware.getDescription()}}</div></div></div></div></div></uib-tab><uib-tab heading="Published"><div class="row"><div class="col-md-6"><div class="firmware" ng-repeat="firmware in publishedFirmwares | rightHalf"><div class="header"><div class="name"><span>{{firmware.getName()}}</span><div class="sub-title">Modified: {{getTime(firmware._modified)}}</div></div><div class="operators"><span class="fa fa-lock" ng-if="firmware._state == \'DISABLED\'" uib-tooltip="Enable" ng-click="enableFirmware(firmware)"></span> <span class="fa fa-unlock" ng-if="firmware._state != \'DISABLED\'" uib-tooltip="Disable" ng-click="disableFirmware(firmware)"></span> <span class="fa fa-plane" uib-tooltip="Push" ng-if="firmware._state != \'DISABLED\'" ng-click="pushFirmware(firmware)"></span> <span class="fa fa-edit" uib-tooltip="Edit" ng-click="openFirmwareEditorModal(firmware)"></span></div></div><div class="body"><div class="header">Applicable Models</div><div class="info">{{firmware.getModels().join(\',\') || \'None models..\'}}</div><div class="header">Release Notes</div><div class="info">{{firmware.getDescription()}}</div></div></div></div><div class="col-md-6"><div class="firmware" ng-repeat="firmware in publishedFirmwares | leftHalf"><div class="header"><div class="name"><span>{{firmware.getName()}}</span><div class="sub-title">Modified: {{getTime(firmware._modified)}}</div></div><div class="operators"><span class="fa fa-lock" ng-if="firmware._state == \'DISABLED\'" uib-tooltip="Enable" ng-click="enableFirmware(firmware)"></span> <span class="fa fa-unlock" ng-if="firmware._state != \'DISABLED\'" uib-tooltip="Disable" ng-click="disableFirmware(firmware)"></span> <span class="fa fa-plane" uib-tooltip="Push" ng-if="firmware._state != \'DISABLED\'" ng-click="pushFirmware(firmware)"></span> <span class="fa fa-edit" uib-tooltip="Edit" ng-click="openFirmwareEditorModal(firmware)"></span></div></div><div class="body"><div class="header">Applicable Models</div><div class="info">{{firmware.getModels().join(\',\') || \'None models..\'}}</div><div class="header">Release Notes</div><div class="info">{{firmware.getDescription()}}</div></div></div></div></div></uib-tab><uib-tab heading="Pushed"><div class="row"><div class="col-md-6"><div class="firmware" ng-repeat="firmware in pushedFirmwares | rightHalf"><div class="header"><div class="name"><span>{{firmware.getName()}}</span><div class="sub-title">Modified: {{getTime(firmware._modified)}}</div></div></div><div class="body"><div class="header">Applicable Models</div><div class="info">{{firmware.getModels().join(\',\') || \'None models..\'}}</div><div class="header">Release Notes</div><div class="info">{{firmware.getDescription()}}</div></div></div></div><div class="col-md-6"><div class="firmware" ng-repeat="firmware in pushedFirmwares | leftHalf"><div class="header"><div class="name"><span>{{firmware.getName()}}</span><div class="sub-title">Modified: {{getTime(firmware._modified)}}</div></div></div><div class="body"><div class="header">Applicable Models</div><div class="info">{{firmware.getModels().join(\',\') || \'None models..\'}}</div><div class="header">Release Notes</div><div class="info">{{firmware.getDescription()}}</div></div></div></div></div></uib-tab></uib-tabset></div><script type="text/ng-template" id="app.Portal.AppManager.ApplicationEditor.FirmwareManager.FirmwareEditorModal"><div class="modal-content" ng-init="init()"> <div class="modal-header"> <h3 class="modal-title">Edit Firmware</h3> </div> <div class="modal-body clearfix"> <div class="col-sm-12"> <div class="form-group"> <label>Firmware Name</label> <input ng-model="firmwareBO.firmwareName" type="text" class="form-control" placeholder="Firmware Name" /> </div> <div class="form-group clearfix"> <label>Firmware Description</label> <textarea ng-model="firmwareBO.description" type="text" class="form-control" placeholder="Firmware Description"></textarea> </div> <div class="form-group"> <label>Upload Firmware File</label> <input type="file" id="firmwareFile" /> </div> <div class="form-group"> <button class="btn btn-success" ng-click="uploadFirmwareFile()">Upload</button> </div> <div class="form-group" ng-if="firmware.getDownloadURL()"> <a href="{{firmware.getDownloadURL()}}" target="_blank">Click to Download</a> </div> </div> </div> <div class="modal-footer ng-scope"> <button class="btn btn-success" type="button" ng-click="ok()">Update</button> <button class="btn btn-danger" type="button" ng-click="cancel()">Cancel</button> </div> </div></script><script type="text/ng-template" id="app.Portal.AppManager.ApplicationEditor.FirmwareManager.FirmwareCreateModal"><div class="modal-content" ng-init="init()"> <div class="modal-header"> <h3 class="modal-title">Create Firmware</h3> </div> <div class="modal-body clearfix"> <div class="col-sm-12"> <div class="form-group clearfix"> <label>Firmware Name</label> <input ng-model="firmwareBO.firmwareName" type="text" class="form-control" placeholder="Firmware Name" /> </div> <div class="form-group clearfix"> <label>Firmware Description</label> <textarea ng-model="firmwareBO.description" type="text" class="form-control" placeholder="Firmware Description"></textarea> </div> </div> </div> <div class="modal-footer ng-scope"> <button class="btn btn-success" type="button" ng-click="ok()">Create</button> <button class="btn btn-danger" type="button" ng-click="cancel()">Cancel</button> </div> </div></script>'),e.put("app/components/Portal/AppManager/ApplicationEditor/ModelManager/ModelInfo/ModelInfo.html",'<div class="app-portal-modelmanager-modelinfo" ng-init="init()"><uib-tabset><uib-tab heading="Model Info"><div class="form-group"><label>Model Name</label> <input class="form-control" type="text" ng-model="modelInfo.modelName"></div><div class="form-group"><label>Firmware Namespace</label><app-select options="firmwareNamespaces" text="_name" selected-model="modelInfo.selectedNamespace"></app-select></div><div class="form-group"><button class="btn btn-success" ng-click="updateModel(modelInfo)">Update</button></div><div class="form-group"><label>Model Image</label> <input type="file" id="modelImage"></div><div class="form-group"><img ng-src="{{modelInfo.imageUrl || \'images/bulb.jpeg\' }}" width="200px"></div></uib-tab><uib-tab heading="Devices"></uib-tab><uib-tab heading="Firmwares"><table st-table="firmwares" class="table table-striped"><thead><tr><th>Firmware Name</th><th>Created Date</th><th>Modified Date</th><th width="120px" align="center">Operation</th></tr></thead><tbody><tr ng-repeat="firmware in firmwares"><td>{{firmware.getName()}}</td><td>{{getTime(firmware._created)}}</td><td>{{getTime(firmware._modified)}}</td><td><span class="fa fa-plus-circle" ng-if="!firmware._selected" ng-click="addFirmware(firmware)"></span> <span class="fa fa-trash" ng-if="firmware._selected" ng-click="removeFirmware(firmware)"></span></td></tr></tbody></table></uib-tab><uib-tab heading="Industrial Schema"><div class="form-group"><button class="btn btn-success" ng-click="createSchema()"><span class="fa fa-plus"></span> Add Schema</button></div><table st-table="mySchemas" class="table table-striped schemas"><thead><th>Schema ID</th></thead><td>Created Time</td><td>Updated Time</td><tbody><tr ng-repeat-start="schema in mySchemas" ng-click="schemaOnEdit[$index]._onEdit = !schemaOnEdit[$index]._onEdit"><td>{{schema._version || schema.id || \'[New Schema]\'}}</td><td>{{schema.updatedAt}}</td><td>{{schema.createdAt}}</td></tr><tr ng-repeat-end=""><td colspan="3" style="padding: 0px"><div class="detail-content" uib-collapse="!schemaOnEdit[$index]._onEdit"><table st-table="schemaProperties" class="table table-striped sub-table"><thead><th>Display Name</th><th>Key</th><th>Type</th><th>Unit</th><th>Controllable</th></thead><tbody><tr ng-repeat="property in schema.getProperties()"><td>{{property.displayName}}</td><td>{{property.key}}</td><td>{{property.type}}</td><td>{{property.unit}}</td><td><span class="fa fa-check" ng-if="property.controllable"></span><span class="fa fa-close" ng-if="!property.controllable"></span></td></tr></tbody></table><div class="tab-pane-footer clearfix"><div class="clearfix pull-right"><button class="btn btn-success" ng-if="!schema.id" ng-click="openCreatePropertyModal(schema)"><span class="fa fa-plus"></span> Add Property</button> <button class="btn btn-success" ng-if="!schema.id" ng-click="saveSchema(schema)"><span class="fa fa-file-o"></span>Save Schema</button></div></div></div></td></tr></tbody></table></uib-tab></uib-tabset></div><script type="text/ng-template" id="app.Portal.AppManager.ApplicationEditor.ModelManager.CreatSchemaProperty"><div class="modal-content" ng-init="init()"> <div class="modal-header"> <h3 class="modal-title">Create Schema</h3> </div> <div class="modal-body clearfix"> <div class="col-sm-12"> <div class="form-group clearfix"> <label>Property Key</label> <input ng-model="propertyBO.key" type="text" class="form-control" placeholder="Property Key" /> </div> <div class="form-group clearfix"> <label>Property Display Name</label> <input ng-model="propertyBO.displayName" type="text" class="form-control" placeholder="Property Display Name" /> </div> <div class="form-group clearfix"> <label>Property Type</label> <app-select selected-model="propertyBO.type" value-only="true" type="text" options="schemaTypes" /> </div> <div class="form-group clearfix" ng-if="propertyBO.type==schemaTypeEnum.INT || propertyBO.type==schemaTypeEnum.FLOAT"> <label>Unit</label> <input ng-model="propertyBO.unit" type="text" class="form-control" placeholder="Property Type" /> </div> <div class="form-group clearfix" ng-if="propertyBO.type==schemaTypeEnum.INT || propertyBO.type==schemaTypeEnum.FLOAT"> <label>Minimun</label> <input ng-model="propertyBO.min" type="text" class="form-control" placeholder="Property Type" /> </div> <div class="form-group clearfix" ng-if="propertyBO.type==schemaTypeEnum.INT || propertyBO.type==schemaTypeEnum.FLOAT"> <label>Maximun</label> <input ng-model="propertyBO.max" type="text" class="form-control" placeholder="Property Type" /> </div> <div class="form-group clearfix"> <label> <input ng-model="propertyBO.controllable" type="checkbox"/> Controllable </label> </div> </div> </div> <div class="modal-footer ng-scope"> <button class="btn btn-success" type="button" ng-click="ok()">Create</button> <button class="btn btn-danger" type="button" ng-click="cancel()">Cancel</button> </div> </div></script>'),e.put("app/components/Portal/AppManager/ApplicationEditor/ModelManager/ModelList/ModelList.html",'<div class="app-portal-modelmanager-modellist"><div class="new-tile" ng-click="openCreateModal()"><span class="fa fa-plus"></span></div><div class="app-tile" ng-repeat="model in myModels"><div class="module-top"><div class="overlay" ng-click="viewModel(model)"><div class="viewReport">View</div></div><div class="outputs-content-img"><img ng-src="{{model.getImageUrl() || \'images/bulb.jpeg\'}}"></div></div><div class="moduleDetails"><div class="per-info"><span class="info">{{model.getName()}}</span></div></div><div class="modulesActionsTop"><i class="fa fa-pencil-square-o" uib-tooltip="Edit" uib-tooltip-trigger="mouseenter" uib-tooltip-placement="top" ng-click="editModel(tag)"></i> <i class="fa fa-trash-o" uib-tooltip="Delete" uib-tooltip-trigger="mouseenter" uib-tooltip-placement="top" ng-click="deleteModel(tag)"></i></div></div></div><script type="text/ng-template" id="app.Portal.AppManager.ApplicationEditor.ModelManager.CreateModal"><div class="modal-content" ng-init="init()"> <div class="modal-header"> <h3 class="modal-title">Create Model</h3> </div> <div class="modal-body clearfix"> <div class="col-sm-12"> <div class="form-group clearfix"> <label>Model Name</label> <input ng-model="modelBO.modelName" type="text" class="form-control" placeholder="Model Name" /> </div> </div> </div> <div class="modal-footer ng-scope"> <button class="btn btn-success" type="button" ng-click="ok()">Create</button> <button class="btn btn-danger" type="button" ng-click="cancel()">Cancel</button> </div> </div></script>'),e.put("app/components/Portal/AppManager/ApplicationEditor/Observation/directives/device-board/device-board.template.html",'<div class="device-board panel"><div class="panel-heading">{{tag.getName()}}</div><div class="panel-body"><div class="tagDashboard"><table><thead><th>_vendorThingID</th><th ng-repeat="field in fields">{{field.displayName}}</th></thead><tbody><tr><td>{{device.getVendorThingID()}}</td><td ng-repeat="field in fields">{{device[field.fieldName]}}</td></tr></tbody></table></div><div class="tagEditBoard"><table><thead><tr><th>fieldName</th><th>fieldDisplayName</th><th>Operation</th></tr></thead><tbody><tr ng-repeat="field in editingFields"><td><input class="form-control" type="text" ng-model="field.fieldName"></td><td><input class="form-control" type="text" ng-model="field.displayName"></td></tr><tr><td colspan="2"><div class="newField"><span class="fa fa-plus"></span>Add New Field</div></td></tr></tbody></table></div></div></div>')
}]);